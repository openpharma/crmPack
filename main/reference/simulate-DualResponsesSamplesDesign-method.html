<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en-US"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Simulate dose escalation procedure using DLE and efficacy responses with samples — simulate,DualResponsesSamplesDesign-method • crmPack</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Simulate dose escalation procedure using DLE and efficacy responses with samples — simulate,DualResponsesSamplesDesign-method"><meta name="description" content="
This is a method to simulate dose escalation procedure using both DLE and efficacy responses.
This is a method based on the DualResponsesSamplesDesign where DLE model used are of
ModelTox class object and efficacy model used are of ModelEff
class object (special case is EffFlexi class model object).
In addition, DLE and efficacy samples are involved or generated in the simulation
process."><meta property="og:description" content="
This is a method to simulate dose escalation procedure using both DLE and efficacy responses.
This is a method based on the DualResponsesSamplesDesign where DLE model used are of
ModelTox class object and efficacy model used are of ModelEff
class object (special case is EffFlexi class model object).
In addition, DLE and efficacy samples are involved or generated in the simulation
process."><meta property="og:image" content="https://openpharma.github.io/crmPack/logo.png"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="default" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">crmPack</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">2.0.0.9002</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/trial_definition.html">Trial Definition</a></li>
    <li><a class="dropdown-item" href="../articles/trial_analysis.html">Trial Analysis</a></li>
    <li><a class="dropdown-item" href="../articles/trial_sanity_checks.html">Trial Design: basic sanity checks</a></li>
    <li><a class="dropdown-item" href="../articles/trial_simulation.html">Trial Simulation</a></li>
    <li><a class="dropdown-item" href="../articles/ordinal-crm.html">Ordinal CRM</a></li>
    <li><a class="dropdown-item" href="../articles/rolling-crm.html">Rolling CRM Example</a></li>
    <li><a class="dropdown-item" href="../articles/simulations.html">Simulation study example</a></li>
    <li><a class="dropdown-item" href="../articles/knit_print.html">Describing `crmPack` Objects</a></li>
    <li><a class="dropdown-item" href="../articles/tidy_method.html">Using tidy</a></li>
    <li><a class="dropdown-item" href="../articles/migration_from_the_old_crmPack.html">Migrating from crmPack version 1.0.3</a></li>
    <li><a class="dropdown-item" href="../articles/parallel_computing_with_extensions.html">Parallel computing with extensions</a></li>
    <li><a class="dropdown-item" href="../articles/crmPack-jss-paper.html">Model-based Dose Escalation Designs in R with crmPack (JSS manuscript)</a></li>
    <li><a class="dropdown-item" href="../articles/example.html">crmPack: Object-oriented implementation of CRM designs</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-reports" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Reports</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-reports"><li><a class="dropdown-item" href="../coverage-report/">Coverage report</a></li>
    <li><a class="dropdown-item" href="../unit-test-report/">Unit test report</a></li>
  </ul></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/openpharma/crmPack" aria-label="View on GitHub"><span class="fa fa-github"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Simulate dose escalation procedure using DLE and efficacy responses with samples</h1>
      <small class="dont-index">Source: <a href="https://github.com/openpharma/crmPack/blob/main/R/Design-methods.R" class="external-link"><code>R/Design-methods.R</code></a></small>
      <div class="d-none name"><code>simulate-DualResponsesSamplesDesign-method.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p><a href="https://lifecycle.r-lib.org/articles/stages.html#stable" class="external-link"><img src="figures/lifecycle-stable.svg" alt="[Stable]"></a></p>
<p>This is a method to simulate dose escalation procedure using both DLE and efficacy responses.
This is a method based on the <code><a href="DualResponsesSamplesDesign-class.html">DualResponsesSamplesDesign</a></code> where DLE model used are of
<code><a href="ModelTox-class.html">ModelTox</a></code> class object and efficacy model used are of <code><a href="ModelEff-class.html">ModelEff</a></code>
class object (special case is <code><a href="EffFlexi-class.html">EffFlexi</a></code> class model object).
In addition, DLE and efficacy samples are involved or generated in the simulation
process.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="co"># S4 method for class 'DualResponsesSamplesDesign'</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/simulate.html" class="external-link">simulate</a></span><span class="op">(</span></span>
<span>  <span class="va">object</span>,</span>
<span>  nsim <span class="op">=</span> <span class="fl">1L</span>,</span>
<span>  seed <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  <span class="va">trueDLE</span>,</span>
<span>  <span class="va">trueEff</span>,</span>
<span>  trueNu <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  trueSigma2 <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  trueSigma2betaW <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  args <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  firstSeparate <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  mcmcOptions <span class="op">=</span> <span class="fu"><a href="McmcOptions-class.html">McmcOptions</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  parallel <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  nCores <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="fu">parallel</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/parallel/detectCores.html" class="external-link">detectCores</a></span><span class="op">(</span><span class="op">)</span>, <span class="fl">5L</span><span class="op">)</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-object">object<a class="anchor" aria-label="anchor" href="#arg-object"></a></dt>
<dd><p>the <code><a href="DualResponsesSamplesDesign-class.html">DualResponsesSamplesDesign</a></code> object we want to
simulate the data from</p></dd>


<dt id="arg-nsim">nsim<a class="anchor" aria-label="anchor" href="#arg-nsim"></a></dt>
<dd><p>(<code>count</code>)<br> the number of simulations (default: 1)</p></dd>


<dt id="arg-seed">seed<a class="anchor" aria-label="anchor" href="#arg-seed"></a></dt>
<dd><p>see <code><a href="set_seed.html">set_seed()</a></code></p></dd>


<dt id="arg-truedle">trueDLE<a class="anchor" aria-label="anchor" href="#arg-truedle"></a></dt>
<dd><p>(<code>function</code>)<br> a function which takes as input a dose (vector) and returns the true probability
(vector) of the occurrence of a DLE. Additional arguments can be supplied in <code>args</code>.</p></dd>


<dt id="arg-trueeff">trueEff<a class="anchor" aria-label="anchor" href="#arg-trueeff"></a></dt>
<dd><p>(<code>function</code>)<br> a function which takes as input a dose (vector) and returns the expected
efficacy responses (vector). Additional arguments can be supplied in <code>args</code>.</p></dd>


<dt id="arg-truenu">trueNu<a class="anchor" aria-label="anchor" href="#arg-truenu"></a></dt>
<dd><p>(<code>number</code>)<br> (not with <code><a href="EffFlexi-class.html">EffFlexi</a></code>) the precision, the inverse of the
variance of the efficacy responses</p></dd>


<dt id="arg-truesigma-">trueSigma2<a class="anchor" aria-label="anchor" href="#arg-truesigma-"></a></dt>
<dd><p>(<code>number</code>)<br> (only with <code><a href="EffFlexi-class.html">EffFlexi</a></code>) the true variance of the efficacy
responses which must be a single positive scalar.</p></dd>


<dt id="arg-truesigma-betaw">trueSigma2betaW<a class="anchor" aria-label="anchor" href="#arg-truesigma-betaw"></a></dt>
<dd><p>(<code>number</code>)<br> (only with <code><a href="EffFlexi-class.html">EffFlexi</a></code>) the true variance for the
random walk model used for smoothing. This must be a single positive scalar.</p></dd>


<dt id="arg-args">args<a class="anchor" aria-label="anchor" href="#arg-args"></a></dt>
<dd><p>(<code>data.frame</code>)<br> data frame with arguments for the <code>trueDLE</code> and
<code>trueEff</code> function. The column names correspond to the argument
names, the rows to the values of the arguments. The rows are appropriately
recycled in the <code>nsim</code> simulations.</p></dd>


<dt id="arg-firstseparate">firstSeparate<a class="anchor" aria-label="anchor" href="#arg-firstseparate"></a></dt>
<dd><p>(<code>flag</code>)<br> enroll the first patient separately from the rest of
the cohort? (not default) If yes, the cohort will be closed if a DLT occurs
in this patient.</p></dd>


<dt id="arg-mcmcoptions">mcmcOptions<a class="anchor" aria-label="anchor" href="#arg-mcmcoptions"></a></dt>
<dd><p>(<a href="McmcOptions-class.html">McmcOptions</a>)<br> object of class <code><a href="McmcOptions-class.html">McmcOptions</a></code>,
giving the MCMC options for each evaluation in the trial. By default,
the standard options are used</p></dd>


<dt id="arg-parallel">parallel<a class="anchor" aria-label="anchor" href="#arg-parallel"></a></dt>
<dd><p>(<code>flag</code>)<br> should the simulation runs be parallelized across the
clusters of the computer? (not default)</p></dd>


<dt id="arg-ncores">nCores<a class="anchor" aria-label="anchor" href="#arg-ncores"></a></dt>
<dd><p>(<code>count</code>)<br> how many cores should be used for parallel computing?
Defaults to the number of cores on the machine, maximum 5.</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>not used</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>an object of class <code><a href="PseudoDualSimulations-class.html">PseudoDualSimulations</a></code> or
<code><a href="PseudoDualFlexiSimulations-class.html">PseudoDualFlexiSimulations</a></code></p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># nolint start</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Simulate dose-escalation procedure based on DLE and efficacy responses where DLE</span></span></span>
<span class="r-in"><span><span class="co">## and efficacy samples are used</span></span></span>
<span class="r-in"><span><span class="va">data</span> <span class="op">&lt;-</span> <span class="fu"><a href="DataDual-class.html">DataDual</a></span><span class="op">(</span>doseGrid <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">25</span>, <span class="fl">300</span>, <span class="fl">25</span><span class="op">)</span>, placebo <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co">## First for the DLE model</span></span></span>
<span class="r-in"><span><span class="co">## The DLE model must be of 'ModelTox' (e.g 'LogisticIndepBeta') class</span></span></span>
<span class="r-in"><span><span class="va">DLEmodel</span> <span class="op">&lt;-</span> <span class="fu"><a href="LogisticIndepBeta-class.html">LogisticIndepBeta</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  binDLE <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1.05</span>, <span class="fl">1.8</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  DLEweights <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fl">3</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  DLEdose <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">25</span>, <span class="fl">300</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  data <span class="op">=</span> <span class="va">data</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## The efficacy model of 'ModelEff' (e.g 'Effloglog') class</span></span></span>
<span class="r-in"><span><span class="va">Effmodel</span> <span class="op">&lt;-</span> <span class="fu"><a href="Effloglog-class.html">Effloglog</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  eff <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1.223</span>, <span class="fl">2.513</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  eff_dose <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">25</span>, <span class="fl">300</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  nu <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>a <span class="op">=</span> <span class="fl">1</span>, b <span class="op">=</span> <span class="fl">0.025</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  data <span class="op">=</span> <span class="va">data</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## The escalation rule using the 'NextBestMaxGainSamples' class</span></span></span>
<span class="r-in"><span><span class="va">mynextbest</span> <span class="op">&lt;-</span> <span class="fu"><a href="NextBestMaxGainSamples-class.html">NextBestMaxGainSamples</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  prob_target_drt <span class="op">=</span> <span class="fl">0.35</span>,</span></span>
<span class="r-in"><span>  prob_target_eot <span class="op">=</span> <span class="fl">0.3</span>,</span></span>
<span class="r-in"><span>  derive <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">samples</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>    <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/quantile.html" class="external-link">quantile</a></span><span class="op">(</span><span class="va">samples</span>, prob <span class="op">=</span> <span class="fl">0.3</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="op">}</span>,</span></span>
<span class="r-in"><span>  mg_derive <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">mg_samples</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>    <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/quantile.html" class="external-link">quantile</a></span><span class="op">(</span><span class="va">mg_samples</span>, prob <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="op">}</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## The increments (see Increments class examples)</span></span></span>
<span class="r-in"><span><span class="co">## 200% allowable increase for dose below 300 and 200% increase for dose above 300</span></span></span>
<span class="r-in"><span><span class="va">myIncrements</span> <span class="op">&lt;-</span> <span class="fu"><a href="IncrementsRelative-class.html">IncrementsRelative</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  intervals <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">25</span>, <span class="fl">300</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  increments <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co">## cohort size of 3</span></span></span>
<span class="r-in"><span><span class="va">mySize</span> <span class="op">&lt;-</span> <span class="fu"><a href="CohortSizeConst-class.html">CohortSizeConst</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co">## Stop only when 10 subjects are treated (only for illustration such a low</span></span></span>
<span class="r-in"><span><span class="co">## sample size)</span></span></span>
<span class="r-in"><span><span class="va">myStopping</span> <span class="op">&lt;-</span> <span class="fu"><a href="StoppingMinPatients-class.html">StoppingMinPatients</a></span><span class="op">(</span>nPatients <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co">## Now specified the design with all the above information and starting with</span></span></span>
<span class="r-in"><span><span class="co">## a dose of 25</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Specified the design</span></span></span>
<span class="r-in"><span><span class="va">design</span> <span class="op">&lt;-</span> <span class="fu"><a href="DualResponsesSamplesDesign-class.html">DualResponsesSamplesDesign</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  nextBest <span class="op">=</span> <span class="va">mynextbest</span>,</span></span>
<span class="r-in"><span>  cohort_size <span class="op">=</span> <span class="va">mySize</span>,</span></span>
<span class="r-in"><span>  startingDose <span class="op">=</span> <span class="fl">25</span>,</span></span>
<span class="r-in"><span>  model <span class="op">=</span> <span class="va">DLEmodel</span>,</span></span>
<span class="r-in"><span>  eff_model <span class="op">=</span> <span class="va">Effmodel</span>,</span></span>
<span class="r-in"><span>  data <span class="op">=</span> <span class="va">data</span>,</span></span>
<span class="r-in"><span>  stopping <span class="op">=</span> <span class="va">myStopping</span>,</span></span>
<span class="r-in"><span>  increments <span class="op">=</span> <span class="va">myIncrements</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co">## specified the true DLE and efficacy curve</span></span></span>
<span class="r-in"><span><span class="va">myTruthDLE</span> <span class="op">&lt;-</span> <span class="fu"><a href="probFunction.html">probFunction</a></span><span class="op">(</span><span class="va">DLEmodel</span>, phi1 <span class="op">=</span> <span class="op">-</span><span class="fl">53.66584</span>, phi2 <span class="op">=</span> <span class="fl">10.50499</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">myTruthEff</span> <span class="op">&lt;-</span> <span class="fu"><a href="efficacyFunction.html">efficacyFunction</a></span><span class="op">(</span><span class="va">Effmodel</span>, theta1 <span class="op">=</span> <span class="op">-</span><span class="fl">4.818429</span>, theta2 <span class="op">=</span> <span class="fl">3.653058</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## The true gain curve can also be seen</span></span></span>
<span class="r-in"><span><span class="va">myTruthGain</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">dose</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="op">(</span><span class="fu">myTruthEff</span><span class="op">(</span><span class="va">dose</span><span class="op">)</span><span class="op">)</span> <span class="op">/</span> <span class="op">(</span><span class="fl">1</span> <span class="op">+</span> <span class="op">(</span><span class="fu">myTruthDLE</span><span class="op">(</span><span class="va">dose</span><span class="op">)</span> <span class="op">/</span> <span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="fu">myTruthDLE</span><span class="op">(</span><span class="va">dose</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## simulate the trial for 10 times involving samples</span></span></span>
<span class="r-in"><span><span class="co">## for illustration purpose we use 10 burn-ins to generate 50 samples</span></span></span>
<span class="r-in"><span><span class="va">options</span> <span class="op">&lt;-</span> <span class="fu"><a href="McmcOptions-class.html">McmcOptions</a></span><span class="op">(</span>burnin <span class="op">=</span> <span class="fl">10</span>, step <span class="op">=</span> <span class="fl">1</span>, samples <span class="op">=</span> <span class="fl">50</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co">## For illustration purpose only 1 simulations are produced (nsim=1).</span></span></span>
<span class="r-in"><span><span class="va">mySim</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/simulate.html" class="external-link">simulate</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="va">design</span>,</span></span>
<span class="r-in"><span>  args <span class="op">=</span> <span class="cn">NULL</span>,</span></span>
<span class="r-in"><span>  trueDLE <span class="op">=</span> <span class="va">myTruthDLE</span>,</span></span>
<span class="r-in"><span>  trueEff <span class="op">=</span> <span class="va">myTruthEff</span>,</span></span>
<span class="r-in"><span>  trueNu <span class="op">=</span> <span class="fl">1</span> <span class="op">/</span> <span class="fl">0.025</span>,</span></span>
<span class="r-in"><span>  nsim <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>  mcmcOptions <span class="op">=</span> <span class="va">options</span>,</span></span>
<span class="r-in"><span>  seed <span class="op">=</span> <span class="fl">819</span>,</span></span>
<span class="r-in"><span>  parallel <span class="op">=</span> <span class="cn">FALSE</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Simulate dose-escalation procedure based on DLE and efficacy responses where DLE</span></span></span>
<span class="r-in"><span><span class="co">## and efficacy samples are used</span></span></span>
<span class="r-in"><span><span class="co">## when the efficacy model is of 'EffFlexi' class</span></span></span>
<span class="r-in"><span><span class="va">Effmodel</span> <span class="op">&lt;-</span> <span class="fu"><a href="EffFlexi-class.html">EffFlexi</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  eff <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1.223</span>, <span class="fl">2.513</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  eff_dose <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">25</span>, <span class="fl">300</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  sigma2W <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>a <span class="op">=</span> <span class="fl">0.1</span>, b <span class="op">=</span> <span class="fl">0.1</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  sigma2betaW <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>a <span class="op">=</span> <span class="fl">20</span>, b <span class="op">=</span> <span class="fl">50</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  rw1 <span class="op">=</span> <span class="cn">FALSE</span>,</span></span>
<span class="r-in"><span>  data <span class="op">=</span> <span class="va">data</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Specified the design</span></span></span>
<span class="r-in"><span><span class="va">design</span> <span class="op">&lt;-</span> <span class="fu"><a href="DualResponsesSamplesDesign-class.html">DualResponsesSamplesDesign</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  nextBest <span class="op">=</span> <span class="va">mynextbest</span>,</span></span>
<span class="r-in"><span>  cohort_size <span class="op">=</span> <span class="va">mySize</span>,</span></span>
<span class="r-in"><span>  startingDose <span class="op">=</span> <span class="fl">25</span>,</span></span>
<span class="r-in"><span>  model <span class="op">=</span> <span class="va">DLEmodel</span>,</span></span>
<span class="r-in"><span>  eff_model <span class="op">=</span> <span class="va">Effmodel</span>,</span></span>
<span class="r-in"><span>  data <span class="op">=</span> <span class="va">data</span>,</span></span>
<span class="r-in"><span>  stopping <span class="op">=</span> <span class="va">myStopping</span>,</span></span>
<span class="r-in"><span>  increments <span class="op">=</span> <span class="va">myIncrements</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co">## specified the true DLE curve and the true expected efficacy values at all dose levels</span></span></span>
<span class="r-in"><span><span class="va">myTruthDLE</span> <span class="op">&lt;-</span> <span class="fu"><a href="probFunction.html">probFunction</a></span><span class="op">(</span><span class="va">DLEmodel</span>, phi1 <span class="op">=</span> <span class="op">-</span><span class="fl">53.66584</span>, phi2 <span class="op">=</span> <span class="fl">10.50499</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">myTruthEff</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="op">-</span><span class="fl">0.5478867</span>,</span></span>
<span class="r-in"><span>  <span class="fl">0.1645417</span>,</span></span>
<span class="r-in"><span>  <span class="fl">0.5248031</span>,</span></span>
<span class="r-in"><span>  <span class="fl">0.7604467</span>,</span></span>
<span class="r-in"><span>  <span class="fl">0.9333009</span>,</span></span>
<span class="r-in"><span>  <span class="fl">1.0687031</span>,</span></span>
<span class="r-in"><span>  <span class="fl">1.1793942</span>,</span></span>
<span class="r-in"><span>  <span class="fl">1.2726408</span>,</span></span>
<span class="r-in"><span>  <span class="fl">1.3529598</span>,</span></span>
<span class="r-in"><span>  <span class="fl">1.4233411</span>,</span></span>
<span class="r-in"><span>  <span class="fl">1.4858613</span>,</span></span>
<span class="r-in"><span>  <span class="fl">1.5420182</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co">## The true gain curve can also be seen</span></span></span>
<span class="r-in"><span><span class="va">d1</span> <span class="op">&lt;-</span> <span class="va">data</span><span class="op">@</span><span class="va">doseGrid</span></span></span>
<span class="r-in"><span><span class="va">myTruthGain</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="va">myTruthEff</span><span class="op">)</span> <span class="op">/</span> <span class="op">(</span><span class="fl">1</span> <span class="op">+</span> <span class="op">(</span><span class="fu">myTruthDLE</span><span class="op">(</span><span class="va">d1</span><span class="op">)</span> <span class="op">/</span> <span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="fu">myTruthDLE</span><span class="op">(</span><span class="va">d1</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">mySim</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/simulate.html" class="external-link">simulate</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  object <span class="op">=</span> <span class="va">design</span>,</span></span>
<span class="r-in"><span>  args <span class="op">=</span> <span class="cn">NULL</span>,</span></span>
<span class="r-in"><span>  trueDLE <span class="op">=</span> <span class="va">myTruthDLE</span>,</span></span>
<span class="r-in"><span>  trueEff <span class="op">=</span> <span class="va">myTruthEff</span>,</span></span>
<span class="r-in"><span>  trueSigma2 <span class="op">=</span> <span class="fl">0.025</span>,</span></span>
<span class="r-in"><span>  trueSigma2betaW <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>  mcmcOptions <span class="op">=</span> <span class="va">options</span>,</span></span>
<span class="r-in"><span>  nsim <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>  seed <span class="op">=</span> <span class="fl">819</span>,</span></span>
<span class="r-in"><span>  parallel <span class="op">=</span> <span class="cn">FALSE</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># nolint end</span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Daniel Sabanes Bove, Wai Yin Yeung, Burak Kuersad Guenhan, Giuseppe Palermo, Thomas Jaki, Jiawen Zhu, Ziwei Liao, Dimitris Kontos, Marlene Schulte-Goebel, Doug Kelkhoff, Oliver Boix, Robert Adams, Clara Beck, John Kirkpatrick, F. Hoffmann-La Roche AG, Merck Healthcare KGaA, Bayer AG.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

