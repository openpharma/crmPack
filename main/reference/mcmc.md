# Obtaining Posterior Samples for all Model Parameters

**\[stable\]**

This is the function that actually runs the `JAGS` MCMC machinery to
produce posterior samples from all model parameters and required derived
values. It is a generic function, so that customized versions may be
conveniently defined for specific subclasses of
[`GeneralData`](https://openpharma.github.io/crmPack/reference/GeneralData-class.md),
[`GeneralModel`](https://openpharma.github.io/crmPack/reference/GeneralModel-class.md),
and
[`McmcOptions`](https://openpharma.github.io/crmPack/reference/McmcOptions-class.md)
input.

## Usage

``` r
mcmc(data, model, options, ...)

# S4 method for class 'GeneralData,GeneralModel,McmcOptions'
mcmc(data, model, options, from_prior = data@nObs == 0L, ...)

# S4 method for class 'GeneralData,DualEndpointRW,McmcOptions'
mcmc(data, model, options, from_prior = data@nObs == 0L, ...)

# S4 method for class 'GeneralData,DualEndpointBeta,McmcOptions'
mcmc(data, model, options, from_prior = data@nObs == 0L, ...)

# S4 method for class 'GeneralData,DualEndpointEmax,McmcOptions'
mcmc(data, model, options, from_prior = data@nObs == 0L, ...)

# S4 method for class 'GeneralData,OneParLogNormalPrior,McmcOptions'
mcmc(data, model, options, from_prior = data@nObs == 0L, ...)

# S4 method for class 'GeneralData,OneParExpPrior,McmcOptions'
mcmc(data, model, options, from_prior = data@nObs == 0L, ...)

# S4 method for class 'DataMixture,GeneralModel,McmcOptions'
mcmc(
  data,
  model,
  options,
  from_prior = data@nObs == 0L & data@nObsshare == 0L,
  ...
)

# S4 method for class 'Data,LogisticIndepBeta,McmcOptions'
mcmc(data, model, options, ...)

# S4 method for class 'DataDual,Effloglog,McmcOptions'
mcmc(data, model, options, ...)

# S4 method for class 'DataDual,EffFlexi,McmcOptions'
mcmc(data, model, options, ...)

# S4 method for class 'DataOrdinal,LogisticLogNormalOrdinal,McmcOptions'
mcmc(data, model, options, ...)
```

## Arguments

- data:

  (`GeneralData`)  
  an input data.

- model:

  (`GeneralModel`)  
  an input model.

- options:

  (`McmcOptions`)  
  MCMC options.

- ...:

  not used.

- from_prior:

  (`flag`)  
  sample from the prior only? Default to `TRUE` when number of
  observations in `data` is `0`. For some models it might be necessary
  to specify it manually here though.

## Value

The posterior samples, an object of class
[`Samples`](https://openpharma.github.io/crmPack/reference/Samples-class.md).

## Functions

- `mcmc(data = GeneralData, model = GeneralModel, options = McmcOptions)`:
  Standard method which uses JAGS.

- `mcmc(data = GeneralData, model = DualEndpointRW, options = McmcOptions)`:
  Standard method which uses JAGS. For the
  [`DualEndpointRW`](https://openpharma.github.io/crmPack/reference/DualEndpointRW-class.md)
  model, it is required that there are at least two (in case of random
  walk prior of the first order on the biomarker level) or three doses
  in the grid.

- `mcmc(data = GeneralData, model = DualEndpointBeta, options = McmcOptions)`:
  Standard method which uses JAGS. For the
  [`DualEndpointBeta`](https://openpharma.github.io/crmPack/reference/DualEndpointBeta-class.md)
  model, it is required that the value of `ref_dose_beta` slot is
  greater than the maximum dose in a grid. This requirement comes from
  definition of the beta function that is used to model dose-biomarker
  relationship in
  [`DualEndpointBeta`](https://openpharma.github.io/crmPack/reference/DualEndpointBeta-class.md)
  model. The other requirement is that there must be at least one dose
  in the grid.

- `mcmc(data = GeneralData, model = DualEndpointEmax, options = McmcOptions)`:
  Standard method which uses JAGS. For the
  [`DualEndpointEmax`](https://openpharma.github.io/crmPack/reference/DualEndpointEmax-class.md)
  model, it is required that there is at least one dose in the grid.

- `mcmc(data = GeneralData, model = OneParLogNormalPrior, options = McmcOptions)`:
  Standard method which uses JAGS. For the
  [`OneParLogNormalPrior`](https://openpharma.github.io/crmPack/reference/OneParLogNormalPrior-class.md)
  model, it is required that the length of skeleton prior probabilities
  vector should be equal to the length of the number of doses.

- `mcmc(data = GeneralData, model = OneParExpPrior, options = McmcOptions)`:
  Standard method which uses JAGS. For the
  [`OneParExpPrior`](https://openpharma.github.io/crmPack/reference/OneParExpPrior-class.md)
  model, it is required that the length of skeleton prior probabilities
  vector should be equal to the length of the number of doses.

- `mcmc(data = DataMixture, model = GeneralModel, options = McmcOptions)`:
  Method for
  [`DataMixture`](https://openpharma.github.io/crmPack/reference/DataMixture-class.md)
  with different `from_prior` default. Samples from the prior only when
  both the number of observations and the number of shared observations
  are zero.

- `mcmc(data = Data, model = LogisticIndepBeta, options = McmcOptions)`:
  Obtain posterior samples for the model parameters based on the pseudo
  [`LogisticIndepBeta`](https://openpharma.github.io/crmPack/reference/LogisticIndepBeta-class.md)
  DLE model. The joint prior and posterior probability density function
  of the intercept \\\phi_1\\ (`phi1`) and the slope \\\phi_2\\ (`phi2`)
  are given in Whitehead and Williamson (1998) . However, since
  asymptotically, the joint posterior probability density will be
  bivariate normal, we use the bivariate normal distribution to generate
  posterior samples of the intercept and the slope parameters. For the
  prior samples of the intercept and the slope, a bivariate normal
  distribution with mean and the covariance matrix given in Whitehead
  and Williamson (1998) is used.

- `mcmc(data = DataDual, model = Effloglog, options = McmcOptions)`:
  Obtain the posterior samples for the model parameters in the
  [`Effloglog`](https://openpharma.github.io/crmPack/reference/Effloglog-class.md)
  model. Given the value of \\\nu\\, the precision of the efficacy
  responses, the joint prior or the posterior probability of the
  intercept \\\theta_1\\ (`theta1`) and the slope \\\theta_2\\
  (`theta2`) is a bivariate normal distribution. The \\\nu\\ (`nu`), the
  precision of the efficacy responses is either a fixed value or has a
  gamma distribution. If a gamma distribution is used, the samples of
  `nu` will be first generated. Then the mean of the `nu` samples will
  be used to generate samples of the intercept and slope parameters of
  the model.

- `mcmc(data = DataDual, model = EffFlexi, options = McmcOptions)`:
  Obtain the posterior samples for the estimates in the
  [`EffFlexi`](https://openpharma.github.io/crmPack/reference/EffFlexi-class.md)
  model. This is the MCMC procedure based on what is described in Lang
  and Brezger (2004) such that samples of the mean efficacy responses at
  all dose levels, samples of `sigma2` \\\sigma^2\\, the variance of the
  efficacy response and samples of `sigma2betaW`
  \\\sigma^2\_{\beta_W}\\, the variance of the random walk model will be
  generated. Please refer to Lang and Brezger (2004) for the procedures
  and the form of the joint prior and posterior probability density for
  the mean efficacy responses. In addition, both `sigma2` and
  `sigma2betaW` can be fixed or have an inverse-gamma prior and
  posterior distribution. Therefore, if the inverse gamma
  distribution(s) are used, the parameters in the distribution will be
  first updated and then samples of `sigma2` and `sigma2betaW` will be
  generated using the updated parameters.

- `mcmc( data = DataOrdinal, model = LogisticLogNormalOrdinal, options = McmcOptions )`:
  Obtain the posterior samples for the model parameters in the
  [`LogisticLogNormalOrdinal`](https://openpharma.github.io/crmPack/reference/LogisticLogNormalOrdinal-class.md)
  model.

  The generic `mcmc` method returns a
  [`Samples`](https://openpharma.github.io/crmPack/reference/Samples-class.md)
  object with elements of the `data` slot named `alpha[1]`, `alpha[2]`,
  ..., `alpha[k]` and `beta` when passed a
  [`LogisticLogNormalOrdinal`](https://openpharma.github.io/crmPack/reference/LogisticLogNormalOrdinal-class.md)
  object. This makes the "alpha elements" awkward to access and is
  inconsistent with other model objects. So rename the alpha elements to
  `alpha1`, `alpha2`, ..., `alpha<k>` for ease and consistency.

## Note

The type of Random Number Generator (RNG) and its initial seed used by
`JAGS` are taken from the `options` argument. If no initial values are
supplied (i.e RNG kind or seed slot in `options` has `NA`), then they
will be generated automatically by `JAGS`.

## References

Lang S, Brezger A (2004). “Bayesian P-Splines.” *Journal of
Computational and Graphical Statistics*, **13**(1), 183–212. ISSN
10618600,
[doi:10.1198/1061860043010](https://doi.org/10.1198/1061860043010) ,
<http://www.jstor.org/stable/1391151>.  
  
Whitehead J, Williamson D (1998). “Bayesian decision procedures based on
logistic regression models for dose-finding studies.” *Journal of
Biopharmaceutical Statistics*, **8**(3), 445–467.

## Examples

``` r
# Create some data from the class `Data`.
my_data <- Data(
  x = c(0.1, 0.5, 1.5, 3, 6, 10, 10, 10),
  y = c(0, 0, 0, 0, 0, 0, 1, 0),
  doseGrid = c(0.1, 0.5, 1.5, 3, 6, seq(from = 10, to = 80, by = 2))
)
#> Used default patient IDs!
#> Used best guess cohort indices!

# Initialize the CRM model.
my_model <- LogisticLogNormal(
  mean = c(-0.85, 1),
  cov = matrix(c(1, -0.5, -0.5, 1), nrow = 2),
  ref_dose = 56
)

# Sample from the posterior distribution.
my_options <- McmcOptions(
  burnin = 100,
  step = 2,
  samples = 1000
)

samples <- mcmc(data = my_data, model = my_model, options = my_options)
samples
#> An object of class "Samples"
#> Slot "data":
#> $alpha0
#>    [1]  0.117223725 -0.848214437 -0.848214437 -0.848214437 -0.463772807
#>    [6]  1.072344058  1.072344058  1.072344058  1.072344058  0.924117495
#>   [11]  0.924117495  0.208855424  0.297315781 -0.040723866 -0.040723866
#>   [16] -1.546900615 -1.546900615 -1.546900615 -0.131766898 -0.131766898
#>   [21] -0.296796711 -0.278620418 -0.383811479 -0.383811479 -0.383811479
#>   [26]  0.164703719  0.327422506 -0.687923744 -0.687923744 -0.687923744
#>   [31] -1.713650690 -1.625535516 -2.433774679 -2.433774679 -2.579166433
#>   [36] -0.935423012 -0.066696058 -0.066696058 -0.066696058 -0.066696058
#>   [41] -0.066696058 -0.066696058 -0.066696058 -0.066696058 -0.066696058
#>   [46] -0.066696058 -0.066696058 -0.066696058 -0.066696058  0.263820963
#>   [51] -0.060938780 -0.060938780 -0.060938780 -0.060938780  0.254965777
#>   [56] -0.614554169 -0.614554169 -0.821490785 -0.821490785 -0.821490785
#>   [61] -0.044965707 -0.044965707 -0.044965707 -0.044965707 -0.044965707
#>   [66] -1.092685028 -1.092685028 -0.917550661 -0.917550661 -0.917550661
#>   [71] -0.917550661 -0.917550661  0.045203604  0.011549063  0.011549063
#>   [76]  0.125043456  0.125043456  0.125043456  0.125043456  0.482130818
#>   [81]  0.482130818  0.482130818 -0.031678819  1.054792958  0.192624053
#>   [86]  0.192624053  0.192624053  0.192624053  0.192624053  0.192624053
#>   [91]  0.192624053  0.192624053  0.192624053  0.192624053  0.192624053
#>   [96]  0.192624053  0.192624053  0.192624053  0.192624053  0.192624053
#>  [101]  0.596732631  0.596732631 -0.701114932 -0.466175485 -0.163960902
#>  [106]  0.795401274  0.795401274 -0.892472011 -0.892472011 -0.892472011
#>  [111] -0.892472011 -1.300164528 -0.844343728  0.247824923  0.247824923
#>  [116]  0.247824923 -0.389118264 -1.352616363 -0.964665038 -0.964665038
#>  [121]  0.492240080  0.492240080  0.349953897  0.349953897 -0.205459409
#>  [126]  1.281986759  1.281986759 -0.065621596 -0.065621596 -0.618648556
#>  [131] -0.985910110 -0.090946865 -0.090946865 -0.090946865 -0.023357050
#>  [136] -0.023357050 -0.023357050  0.330381033  0.330381033 -0.660687173
#>  [141] -0.469696229 -0.619653858 -0.619653858 -0.619653858 -0.619653858
#>  [146]  0.629198838  0.629198838 -0.158448658 -0.158448658 -0.158448658
#>  [151] -0.158448658  0.140507813  0.140507813  0.140507813  0.118682269
#>  [156]  0.118682269  1.231341308  0.591001503 -0.844612560 -0.844612560
#>  [161] -0.844612560 -0.844612560 -0.122758249 -0.025206942  0.601074136
#>  [166]  0.601074136  0.601074136  0.359112691  0.359112691 -0.441239094
#>  [171] -0.441239094  0.330026114  0.850070289  0.946358396 -0.851892982
#>  [176] -0.851892982 -0.297540047 -0.297540047  0.470137216  0.470137216
#>  [181]  0.071324703  0.071324703  0.835194886  0.835194886  0.741418619
#>  [186]  0.741418619  0.741418619  0.741418619 -1.051682655 -0.650680603
#>  [191]  0.043020954  0.043020954  0.043020954 -0.406145118  0.139264820
#>  [196]  0.793287421  0.793287421 -0.972709715 -0.972709715 -0.972709715
#>  [201] -0.448664971  0.335825651  0.032479204  1.289398305 -0.971801624
#>  [206] -0.971801624 -0.971801624 -0.971801624 -0.971801624 -0.971801624
#>  [211] -1.244759780 -1.244759780 -1.244759780 -1.244759780 -1.244759780
#>  [216]  0.971995612 -0.090736409  1.118336901  0.731507378 -0.016635161
#>  [221]  0.640515087  0.068893361  0.068893361  0.361821983 -0.361244728
#>  [226] -1.742439419 -2.741469214 -2.741469214 -0.408728538 -0.408728538
#>  [231] -0.408728538 -0.112432999 -0.112432999 -0.654987656 -0.654987656
#>  [236] -0.471152287 -0.824485543 -0.579902089 -0.579902089 -1.557585071
#>  [241] -1.645812385 -1.645812385  0.359581538  0.713951195  0.713951195
#>  [246]  0.713951195  0.713951195  0.713951195  0.713951195  0.713951195
#>  [251]  1.185342225  0.833957560  0.833957560  0.347877484  0.104088789
#>  [256]  0.104088789  0.104088789  0.853034288  0.853034288  0.853034288
#>  [261]  0.853034288  0.853034288  0.853034288  0.853034288  0.346436896
#>  [266]  0.346436896  1.236777414  1.236777414  1.236777414 -1.223052809
#>  [271] -0.182846756 -0.182846756 -0.182846756  0.523534867  0.367048806
#>  [276] -0.186691349 -0.186691349 -0.186691349 -0.186691349 -0.186691349
#>  [281] -0.186691349 -0.186691349 -0.186691349 -0.186691349 -0.470732236
#>  [286] -0.470732236  0.297849686  0.297849686  0.441443888 -0.379186423
#>  [291] -0.379186423 -0.379186423  0.983065780  0.983065780 -0.224951612
#>  [296] -0.224951612 -0.224951612 -0.832925841 -0.871531754 -0.871531754
#>  [301] -1.437960312 -1.437960312 -1.437960312 -1.437960312 -1.437960312
#>  [306] -0.331345813 -0.331345813 -0.452797595 -1.553738126 -1.718318907
#>  [311] -0.235336534  0.200084981  0.200084981  0.200084981 -0.266719672
#>  [316] -0.266719672 -0.561645608  0.007116995  0.007116995  0.007116995
#>  [321] -0.713913207  0.549187457  0.549187457  0.549187457  0.549187457
#>  [326]  0.549187457  0.319142124  0.319142124  0.587435158  0.587435158
#>  [331]  0.587435158  0.587435158 -0.191179984 -0.191179984 -0.191179984
#>  [336]  0.424374170 -0.312982474  0.591252976  0.591252976 -1.058193276
#>  [341] -1.058193276 -2.910456341 -2.910456341 -2.910456341 -2.910456341
#>  [346] -1.530657534  0.996001693  1.304227227  1.304227227  0.083778796
#>  [351] -0.292374488 -0.292374488 -0.292374488 -0.292374488 -0.292374488
#>  [356]  0.319354120  0.319354120  0.319354120  0.319354120  0.319354120
#>  [361] -0.142928016  0.219387598  0.219387598 -0.466513817 -0.466513817
#>  [366] -0.466513817  1.009889365 -0.070244922 -0.337119809 -0.966512858
#>  [371] -0.966512858 -0.021042656 -0.021042656 -0.793327175 -0.793327175
#>  [376]  0.087044563  0.087044563  0.104647807 -1.168973751 -1.184802828
#>  [381] -1.211521030 -1.175106234 -1.175106234 -1.175106234 -1.175106234
#>  [386]  0.653095935  0.304632524  0.693748242  0.693748242  0.693748242
#>  [391]  0.693748242  0.693748242  0.693748242 -0.213419422 -0.213419422
#>  [396] -0.854737257 -0.854737257 -0.854737257 -0.854737257 -0.854737257
#>  [401] -0.013166291 -0.013166291 -1.537951222 -1.537951222 -1.059170480
#>  [406] -1.059170480  0.622082276  0.622082276  0.622082276  0.622082276
#>  [411]  0.622082276  1.415288007  0.392383217  0.392383217  0.392383217
#>  [416]  0.392383217  0.784658136  0.464385213  0.588867115  0.588867115
#>  [421] -0.739681807 -0.201464984 -0.383048874 -0.589546447 -0.606641141
#>  [426]  0.038211237  0.499185822 -0.218879828 -0.218879828  0.027849709
#>  [431]  0.027849709  0.027849709  0.027849709  0.027849709  0.203947052
#>  [436]  0.203947052  0.203947052  0.203947052  0.203947052  0.203947052
#>  [441]  0.203947052  0.439993810  0.439993810  0.439993810  1.293963558
#>  [446]  1.293963558 -0.380546168  0.148176165  0.148176165 -0.031198066
#>  [451] -0.531538511 -0.531538511 -0.531538511  0.249902404  0.249902404
#>  [456]  0.070123614 -1.703179693 -1.703179693  0.210285057  0.210285057
#>  [461]  0.538739289  0.776638970  1.393655107  1.393655107  1.227096942
#>  [466]  1.227096942  1.227096942  1.227096942  1.369170436  0.351515477
#>  [471]  0.351515477 -1.076650746 -0.701726654  0.870468161  1.516335253
#>  [476]  1.516335253  0.202784335  0.202784335 -0.401779921 -0.401779921
#>  [481] -0.401779921  0.412464768 -0.785757943 -0.805631042 -1.807384814
#>  [486] -0.685042276 -0.672618121 -0.365539260 -0.365539260 -0.365539260
#>  [491] -0.365539260 -0.365539260  0.641889463  0.641889463 -0.528176844
#>  [496] -0.528176844 -0.528176844 -0.528176844  0.092270902  0.092270902
#>  [501] -0.453333303  0.865639016  0.865639016  0.865639016 -0.771193897
#>  [506] -0.771193897 -0.490945984 -1.054301881 -1.054301881 -0.761256689
#>  [511] -0.761256689 -0.761256689  0.410639935  0.038454602  0.188370459
#>  [516]  0.841154398 -0.322318144 -0.322318144 -0.322318144 -0.322318144
#>  [521] -0.321225271 -0.321225271  0.531798856  0.311756676  1.227061495
#>  [526]  1.227061495  1.227061495  1.001536312  1.093832322  0.778539004
#>  [531]  0.778539004  0.778539004  0.778539004  0.778539004  0.778539004
#>  [536] -1.076226259 -1.076226259 -1.076226259  0.678364984  0.678364984
#>  [541]  0.721219907  0.721219907 -0.457321339 -1.095882294 -1.095882294
#>  [546] -1.095882294 -1.560902002 -0.391964652 -0.139355155 -0.139355155
#>  [551] -0.139355155 -0.139355155 -0.178715687 -0.025305112 -0.025305112
#>  [556] -0.110956171 -0.110956171  0.710090015  0.710090015  0.710090015
#>  [561] -1.543197332 -1.543197332 -1.543197332 -1.307828697 -1.307828697
#>  [566] -0.986406561 -0.032917567 -0.032917567 -0.031027833 -0.985426636
#>  [571]  0.732470112  0.242351270 -0.021785665 -0.021785665 -0.021785665
#>  [576] -0.021785665 -0.021785665 -0.021785665 -0.021785665 -0.021785665
#>  [581] -0.021785665 -0.302956444 -1.858431595 -1.503364758 -1.348873619
#>  [586]  0.335220462  0.335220462 -0.978829722 -0.978829722 -0.978829722
#>  [591] -1.121145438 -1.121145438 -0.576642184  0.588532534  0.903267138
#>  [596]  0.903267138  0.671463480  0.534455647 -0.149121514  0.639322840
#>  [601]  0.397189726  0.397189726  0.397189726 -0.494449487 -0.494449487
#>  [606] -0.494449487 -0.494449487 -1.303416426 -1.303416426 -1.303416426
#>  [611] -0.886621163  0.590588781  0.817276012  0.817276012  0.013317155
#>  [616]  0.247164292  0.611851727 -0.398898368 -0.398898368 -0.628312999
#>  [621]  0.583908168  0.583908168  0.583908168  0.583908168  1.048849551
#>  [626]  1.048849551  1.048849551  1.048849551  1.638595886  1.638595886
#>  [631]  0.708998949 -0.562986535 -0.562986535 -0.562986535 -1.904330085
#>  [636]  0.485704816  0.485704816  0.485704816 -0.813231215 -1.548538146
#>  [641] -1.548538146  0.916163604  0.593319724  0.593319724  0.108231572
#>  [646]  0.108231572  0.108231572 -0.472108578 -0.472108578 -0.472108578
#>  [651] -0.472108578 -0.472108578  0.365145764  0.365145764  0.365145764
#>  [656] -0.639797789 -0.639797789 -0.563577780  0.791785789 -0.461460063
#>  [661] -0.250787424 -0.511701452 -0.166053532 -0.166053532 -0.008796790
#>  [666] -0.252001687 -0.252001687 -0.252001687 -0.252001687 -0.252001687
#>  [671] -0.252001687 -0.252001687 -0.252001687  0.075520256  1.208877057
#>  [676]  0.579548663  0.736334682 -1.245691228 -0.995623763 -0.995623763
#>  [681] -0.995623763  0.276683526 -0.422345026 -0.422345026 -0.422345026
#>  [686] -0.422345026 -0.579802106  0.628459316  0.628459316  0.628459316
#>  [691]  0.628459316  0.628459316 -0.115044560  0.108994379  0.108994379
#>  [696]  0.108994379  0.108994379  0.108994379 -2.192974894 -2.192974894
#>  [701] -2.192974894 -2.192974894 -2.192974894 -1.198829160 -1.488126861
#>  [706] -1.488126861 -1.488126861 -1.488126861 -1.046375494 -1.046375494
#>  [711] -1.046375494 -1.046375494 -1.046375494  0.840718458  0.361069981
#>  [716]  0.361069981  0.361069981  0.361069981  1.120206998  1.832763636
#>  [721]  1.832763636  1.915654927  2.103751940  2.103751940  1.876064057
#>  [726]  1.876064057  1.562827087  1.562827087  1.562827087  1.562827087
#>  [731]  1.562827087  0.235388590  0.235388590 -0.438729410  0.580976634
#>  [736]  0.580976634  0.580976634  0.923686450  0.923686450  0.923686450
#>  [741]  1.334305290  1.334305290  1.334305290  1.334305290 -1.355190327
#>  [746]  0.994350506  0.994350506  0.994350506 -0.395076633 -0.448817137
#>  [751] -0.448817137 -0.448817137 -0.448817137 -0.448817137 -0.448817137
#>  [756] -0.448817137 -0.448817137 -0.448817137 -0.279761451 -0.279761451
#>  [761] -0.394926226 -0.394926226 -0.406515533 -0.406515533 -0.406515533
#>  [766] -0.406515533  0.109884264  0.109884264 -0.475367620 -0.475367620
#>  [771]  0.060231161  0.060231161  0.064829903  0.064829903 -0.239278149
#>  [776]  0.020642772  0.020642772  0.085481925 -0.383868386 -0.383868386
#>  [781] -0.383868386 -0.786828437  1.228835368 -0.017744954 -0.512700735
#>  [786] -0.512700735 -0.512700735 -1.505094155 -1.286781915 -1.286781915
#>  [791] -0.161810403  0.397540633 -0.161308270 -0.478900063 -0.478900063
#>  [796] -0.478900063 -0.478900063  0.037277618  0.253560021  0.486221681
#>  [801]  0.004243646 -1.213065380 -1.213065380  0.028151007  0.028151007
#>  [806]  0.028151007 -0.066326937 -0.066326937 -0.066326937 -0.572942074
#>  [811] -0.572942074 -0.572942074 -0.572942074 -0.876528632 -1.263657922
#>  [816] -1.148344547  0.713157088  0.713157088 -0.351178091 -0.351178091
#>  [821] -1.040892028 -1.040892028 -1.040892028 -1.693852592 -1.693852592
#>  [826] -1.693852592 -1.693852592 -1.693852592 -1.693852592 -1.693852592
#>  [831] -0.940442819 -0.339370753  1.406695478 -1.345906181 -1.200989898
#>  [836] -1.200989898  1.358494124  1.358494124  1.513052058  1.513052058
#>  [841]  1.513052058  1.130035237  1.130035237  1.130035237  1.237948907
#>  [846]  0.876370856  0.876370856  0.047509258 -0.095690135 -0.095690135
#>  [851] -0.022562263 -0.022562263 -0.022562263  0.361834190  0.361834190
#>  [856]  0.126341421  0.990426167  0.990426167  0.530381626  0.530381626
#>  [861] -0.239017675 -0.239017675 -0.239017675 -0.806213475 -0.806213475
#>  [866]  0.935689599  0.935689599 -1.127697482 -1.478943665 -1.478943665
#>  [871] -1.478943665  1.154318401  0.086543334  0.086543334 -0.932563052
#>  [876] -0.932563052 -0.932563052  0.310826325  0.310826325  0.310826325
#>  [881] -0.028673249  0.966596944  0.966596944  0.966596944  0.578393586
#>  [886]  0.578393586  0.578393586 -0.041347337 -0.229073241 -0.550586898
#>  [891] -0.550586898 -0.550586898 -0.550586898 -0.296090120 -0.296090120
#>  [896] -0.546498496 -0.546498496 -0.546498496 -0.546498496 -0.546498496
#>  [901] -0.546498496 -0.546498496 -0.546498496 -0.546498496 -1.069700373
#>  [906] -1.069700373 -1.750210106 -1.504188802 -2.268090479 -2.268090479
#>  [911] -2.268090479 -2.268090479 -1.779120999 -1.054121828 -1.526432665
#>  [916] -0.821487525 -0.821487525 -0.821487525 -0.821487525 -0.031624646
#>  [921] -0.345260782  0.142788993  0.020057081  0.020057081 -0.021284872
#>  [926] -0.226926442 -0.226926442 -0.226926442 -0.226926442 -0.226926442
#>  [931]  0.235794503 -0.174909872 -0.174909872 -1.270295106 -1.107780624
#>  [936] -0.392491859 -0.672615649 -0.672615649 -0.672615649 -0.672615649
#>  [941] -0.672615649  1.039003182  1.039003182  0.171554444  0.171554444
#>  [946] -0.394500335 -0.394500335 -0.394500335 -0.394500335 -0.394500335
#>  [951]  0.670870193  0.670870193  1.234767987  0.604982908 -0.128194616
#>  [956] -0.128194616 -0.730682290 -0.730682290  0.273909061  0.646574174
#>  [961]  0.688493787  0.688493787  0.605702324 -2.157895826 -2.157895826
#>  [966] -2.157895826 -0.626517034 -0.626517034 -0.331131092 -0.331131092
#>  [971]  0.212018173  0.303592086  0.253346185 -0.169435956 -0.169435956
#>  [976] -0.169435956 -0.169435956 -0.169435956 -0.169435956 -0.169435956
#>  [981] -0.169435956 -0.169435956 -0.169435956 -0.169435956 -0.169435956
#>  [986] -0.169435956  0.237358372  0.237358372  0.237358372 -0.170088983
#>  [991] -0.696284271 -0.937950982 -0.937950982 -0.937950982 -0.937950982
#>  [996] -0.514777548 -1.120329834 -1.120329834 -0.533158283 -0.533158283
#> 
#> $alpha1
#>    [1] 1.8119866 3.4137863 3.4137863 3.4137863 2.6487544 0.6533436 0.6533436
#>    [8] 0.6533436 0.6533436 0.8982099 0.8982099 0.5634905 0.3951202 0.3232727
#>   [15] 0.3232727 0.6161084 0.6161084 0.6161084 0.3942308 0.3942308 0.4089150
#>   [22] 1.9051970 2.0522274 2.0522274 2.0522274 2.4885513 1.0094393 1.0617158
#>   [29] 1.0617158 1.0617158 0.4291779 0.9986235 0.5481700 0.5481700 1.8676681
#>   [36] 0.5303424 0.9166689 0.9166689 0.9166689 0.9166689 0.9166689 0.9166689
#>   [43] 0.9166689 0.9166689 0.9166689 0.9166689 0.9166689 0.9166689 0.9166689
#>   [50] 2.5778539 2.6192410 2.6192410 2.6192410 2.6192410 0.6868693 1.3900863
#>   [57] 1.3900863 1.2404870 1.2404870 1.2404870 1.1507020 1.1507020 1.1507020
#>   [64] 1.1507020 1.1507020 0.8725105 0.8725105 1.3817317 1.3817317 1.3817317
#>   [71] 1.3817317 1.3817317 0.5732634 1.0670544 1.0670544 0.3655680 0.3655680
#>   [78] 0.3655680 0.3655680 0.8518997 0.8518997 0.8518997 1.3423264 1.1706981
#>   [85] 1.3172351 1.3172351 1.3172351 1.3172351 1.3172351 1.3172351 1.3172351
#>   [92] 1.3172351 1.3172351 1.3172351 1.3172351 1.3172351 1.3172351 1.3172351
#>   [99] 1.3172351 1.3172351 0.6641119 0.6641119 0.6904405 0.4775308 1.2036967
#>  [106] 0.8895955 0.8895955 0.4632030 0.4632030 0.4632030 0.4632030 0.9681436
#>  [113] 0.5724756 2.7250181 2.7250181 2.7250181 1.5304507 0.8090755 0.9268164
#>  [120] 0.9268164 1.8053009 1.8053009 0.8475563 0.8475563 1.4871467 0.7660881
#>  [127] 0.7660881 0.4873124 0.4873124 0.6418440 0.6085466 1.4788746 1.4788746
#>  [134] 1.4788746 0.8154317 0.8154317 0.8154317 0.9990509 0.9990509 1.0017899
#>  [141] 0.3984275 3.1031147 3.1031147 3.1031147 3.1031147 2.8505125 2.8505125
#>  [148] 0.9167466 0.9167466 0.9167466 0.9167466 1.4952504 1.4952504 1.4952504
#>  [155] 1.1831781 1.1831781 2.4754355 1.2759311 1.2989477 1.2989477 1.2989477
#>  [162] 1.2989477 0.8137804 0.7151799 2.0695870 2.0695870 2.0695870 0.7582969
#>  [169] 0.7582969 0.6149791 0.6149791 1.5900020 1.2749830 1.4613258 1.3616905
#>  [176] 1.3616905 0.6031612 0.6031612 0.7861523 0.7861523 1.5341060 1.5341060
#>  [183] 1.1454484 1.1454484 0.7264559 0.7264559 0.7264559 0.7264559 1.5305805
#>  [190] 1.8928234 1.9999930 1.9999930 1.9999930 2.8289081 0.4231433 1.2168645
#>  [197] 1.2168645 0.6077881 0.6077881 0.6077881 1.0845606 0.9188434 1.3505018
#>  [204] 1.0057428 0.4816394 0.4816394 0.4816394 0.4816394 0.4816394 0.4816394
#>  [211] 1.1393029 1.1393029 1.1393029 1.1393029 1.1393029 0.7740897 0.8214376
#>  [218] 0.7492860 0.5835905 0.6378842 0.8895883 0.6584603 0.6584603 0.7595053
#>  [225] 0.2574197 0.6502260 1.4893101 1.4893101 0.3551846 0.3551846 0.3551846
#>  [232] 0.3219892 0.3219892 0.9119470 0.9119470 0.2685273 0.3546559 0.5169123
#>  [239] 0.5169123 1.5835092 1.2969931 1.2969931 0.2534297 0.2879581 0.2879581
#>  [246] 0.2879581 0.2879581 0.2879581 0.2879581 0.2879581 0.3872078 0.4314534
#>  [253] 0.4314534 0.2579825 0.9882069 0.9882069 0.9882069 0.7096045 0.7096045
#>  [260] 0.7096045 0.7096045 0.7096045 0.7096045 0.7096045 1.6648454 1.6648454
#>  [267] 1.0690969 1.0690969 1.0690969 0.6292081 1.3726775 1.3726775 1.3726775
#>  [274] 1.3678693 0.6381597 0.9064162 0.9064162 0.9064162 0.9064162 0.9064162
#>  [281] 0.9064162 0.9064162 0.9064162 0.9064162 0.9847690 0.9847690 1.6614749
#>  [288] 1.6614749 1.2479484 0.7372865 0.7372865 0.7372865 0.5969766 0.5969766
#>  [295] 0.8646656 0.8646656 0.8646656 0.4403921 2.0838539 2.0838539 1.1134760
#>  [302] 1.1134760 1.1134760 1.1134760 1.1134760 0.9438000 0.9438000 0.6107514
#>  [309] 0.3647954 0.8234958 0.3923830 1.5639496 1.5639496 1.5639496 1.3217887
#>  [316] 1.3217887 1.3196060 1.5194553 1.5194553 1.5194553 1.0678999 0.6998730
#>  [323] 0.6998730 0.6998730 0.6998730 0.6998730 1.6879933 1.6879933 0.8900873
#>  [330] 0.8900873 0.8900873 0.8900873 2.4478259 2.4478259 2.4478259 1.7874262
#>  [337] 1.1874988 2.2225992 2.2225992 0.7452228 0.7452228 2.0860523 2.0860523
#>  [344] 2.0860523 2.0860523 0.8486948 0.7498568 1.7653879 1.7653879 0.4912176
#>  [351] 1.9080808 1.9080808 1.9080808 1.9080808 1.9080808 0.6186249 0.6186249
#>  [358] 0.6186249 0.6186249 0.6186249 0.8690793 0.9161162 0.9161162 0.8677619
#>  [365] 0.8677619 0.8677619 0.9060457 0.4118635 0.6710762 0.2930928 0.2930928
#>  [372] 2.0631558 2.0631558 2.0108397 2.0108397 0.5824264 0.5824264 0.7854832
#>  [379] 1.3087209 1.4495226 0.3815984 1.4378686 1.4378686 1.4378686 1.4378686
#>  [386] 2.4895036 2.5693620 0.7033788 0.7033788 0.7033788 0.7033788 0.7033788
#>  [393] 0.7033788 1.6357348 1.6357348 0.5369579 0.5369579 0.5369579 0.5369579
#>  [400] 0.5369579 0.8112998 0.8112998 0.8209715 0.8209715 2.4365410 2.4365410
#>  [407] 1.0226562 1.0226562 1.0226562 1.0226562 1.0226562 1.6450543 0.7297317
#>  [414] 0.7297317 0.7297317 0.7297317 1.2089443 1.0178847 1.0329069 1.0329069
#>  [421] 0.2895676 0.6390751 2.7988425 2.8937154 1.5052577 1.6598878 1.6099473
#>  [428] 1.6092420 1.6092420 1.3289819 1.3289819 1.3289819 1.3289819 1.3289819
#>  [435] 1.4036848 1.4036848 1.4036848 1.4036848 1.4036848 1.4036848 1.4036848
#>  [442] 1.3970928 1.3970928 1.3970928 0.9404286 0.9404286 1.1924409 1.0042627
#>  [449] 1.0042627 0.3787404 1.4539984 1.4539984 1.4539984 1.6978138 1.6978138
#>  [456] 1.2891908 0.5826277 0.5826277 1.4492833 1.4492833 1.1142161 2.3041124
#>  [463] 1.9359976 1.9359976 1.3397068 1.3397068 1.3397068 1.3397068 2.1320820
#>  [470] 0.3407446 0.3407446 1.2052537 0.5804095 0.6926767 0.7086161 0.7086161
#>  [477] 0.5378633 0.5378633 0.7509053 0.7509053 0.7509053 0.9845203 0.4761450
#>  [484] 0.8799501 0.3542992 0.6454851 0.5721316 0.4744080 0.4744080 0.4744080
#>  [491] 0.4744080 0.4744080 1.3650528 1.3650528 0.8469147 0.8469147 0.8469147
#>  [498] 0.8469147 1.2656077 1.2656077 1.0920052 0.8219202 0.8219202 0.8219202
#>  [505] 0.3976696 0.3976696 0.5626737 0.5627803 0.5627803 1.0158802 1.0158802
#>  [512] 1.0158802 1.1512535 3.6720555 1.0156869 0.9336087 0.8167273 0.8167273
#>  [519] 0.8167273 0.8167273 0.8190770 0.8190770 1.3484202 0.5074648 1.5555055
#>  [526] 1.5555055 1.5555055 2.4113775 2.1035893 1.6722931 1.6722931 1.6722931
#>  [533] 1.6722931 1.6722931 1.6722931 1.2185898 1.2185898 1.2185898 0.9755006
#>  [540] 0.9755006 1.2052736 1.2052736 1.3083446 1.2423708 1.2423708 1.2423708
#>  [547] 1.5814805 1.4094826 1.3009728 1.3009728 1.3009728 1.3009728 1.1076609
#>  [554] 1.4807144 1.4807144 1.3706828 1.3706828 0.3697734 0.3697734 0.3697734
#>  [561] 4.3057378 4.3057378 4.3057378 2.5264353 2.5264353 1.5589519 0.5850267
#>  [568] 0.5850267 0.4429501 0.7243611 0.8727772 0.9220821 1.6488434 1.6488434
#>  [575] 1.6488434 1.6488434 1.6488434 1.6488434 1.6488434 1.6488434 1.6488434
#>  [582] 0.3953043 0.5456304 1.0600793 1.7490909 1.1728218 1.1728218 1.2762663
#>  [589] 1.2762663 1.2762663 1.0921223 1.0921223 2.0191730 1.9737232 1.4874715
#>  [596] 1.4874715 0.2614825 0.3938562 0.5542710 0.7424962 2.8165347 2.8165347
#>  [603] 2.8165347 1.7546538 1.7546538 1.7546538 1.7546538 1.1277208 1.1277208
#>  [610] 1.1277208 1.1713168 0.6872997 1.0911200 1.0911200 0.7050880 0.7951023
#>  [617] 1.1005374 0.3942750 0.3942750 0.2431468 1.1426569 1.1426569 1.1426569
#>  [624] 1.1426569 1.2657682 1.2657682 1.2657682 1.2657682 1.4591403 1.4591403
#>  [631] 2.4332470 0.3741132 0.3741132 0.3741132 0.7628586 0.4677561 0.4677561
#>  [638] 0.4677561 2.1835602 0.8419523 0.8419523 0.5798889 0.2276306 0.2276306
#>  [645] 0.2933766 0.2933766 0.2933766 0.7650550 0.7650550 0.7650550 0.7650550
#>  [652] 0.7650550 1.5045271 1.5045271 1.5045271 1.2848749 1.2848749 1.0734963
#>  [659] 0.5209087 2.3322232 0.6629609 1.0434065 1.2210480 1.2210480 0.8473744
#>  [666] 1.0716739 1.0716739 1.0716739 1.0716739 1.0716739 1.0716739 1.0716739
#>  [673] 1.0716739 2.0897309 1.1845653 1.3841147 0.7092916 1.5375957 0.6031973
#>  [680] 0.6031973 0.6031973 2.6215697 1.1151973 1.1151973 1.1151973 1.1151973
#>  [687] 1.2937489 1.0545106 1.0545106 1.0545106 1.0545106 1.0545106 0.5466692
#>  [694] 1.6936628 1.6936628 1.6936628 1.6936628 1.6936628 0.5734584 0.5734584
#>  [701] 0.5734584 0.5734584 0.5734584 0.6032722 1.0774242 1.0774242 1.0774242
#>  [708] 1.0774242 1.3307153 1.3307153 1.3307153 1.3307153 1.3307153 1.0116035
#>  [715] 1.1399323 1.1399323 1.1399323 1.1399323 1.1104475 1.5529977 1.5529977
#>  [722] 0.9083418 1.1346983 1.1346983 1.5093358 1.5093358 1.4445940 1.4445940
#>  [729] 1.4445940 1.4445940 1.4445940 2.1738909 2.1738909 0.6442261 1.2727818
#>  [736] 1.2727818 1.2727818 1.3432695 1.3432695 1.3432695 0.8773844 0.8773844
#>  [743] 0.8773844 0.8773844 0.8477874 0.8320822 0.8320822 0.8320822 2.8175426
#>  [750] 1.3678705 1.3678705 1.3678705 1.3678705 1.3678705 1.3678705 1.3678705
#>  [757] 1.3678705 1.3678705 1.3195445 1.3195445 1.3639653 1.3639653 1.0981440
#>  [764] 1.0981440 1.0981440 1.0981440 0.6956670 0.6956670 0.6597714 0.6597714
#>  [771] 1.2512406 1.2512406 0.7846213 0.7846213 0.5743394 0.9028987 0.9028987
#>  [778] 1.3991958 1.1853457 1.1853457 1.1853457 2.4101979 1.4880002 0.8762133
#>  [785] 0.5358418 0.5358418 0.5358418 1.0472447 1.3557556 1.3557556 1.4977793
#>  [792] 1.3256202 1.5090251 0.8019633 0.8019633 0.8019633 0.8019633 3.6103632
#>  [799] 2.9239970 1.7716779 2.3591008 1.2814300 1.2814300 1.8963090 1.8963090
#>  [806] 1.8963090 1.1159228 1.1159228 1.1159228 0.8038987 0.8038987 0.8038987
#>  [813] 0.8038987 0.5719719 1.3227244 0.6588372 1.0914996 1.0914996 1.1188504
#>  [820] 1.1188504 1.0067252 1.0067252 1.0067252 1.9577085 1.9577085 1.9577085
#>  [827] 1.9577085 1.9577085 1.9577085 1.9577085 0.8814721 2.7221087 2.3633930
#>  [834] 4.5185489 0.1573478 0.1573478 0.2941113 0.2941113 0.3270363 0.3270363
#>  [841] 0.3270363 0.6324060 0.6324060 0.6324060 0.6655532 1.4913886 1.4913886
#>  [848] 2.8498221 0.7398078 0.7398078 1.2956217 1.2956217 1.2956217 2.1693055
#>  [855] 2.1693055 0.7148161 1.6019751 1.6019751 2.7640280 2.7640280 0.4541538
#>  [862] 0.4541538 0.4541538 0.6561343 0.6561343 2.3780874 2.3780874 2.1621299
#>  [869] 1.4808677 1.4808677 1.4808677 0.7847489 0.5216872 0.5216872 1.0874034
#>  [876] 1.0874034 1.0874034 1.3432306 1.3432306 1.3432306 1.7423504 1.2816326
#>  [883] 1.2816326 1.2816326 1.1428404 1.1428404 1.1428404 0.4224971 0.9401110
#>  [890] 0.8257292 0.8257292 0.8257292 0.8257292 0.7706266 0.7706266 0.8818426
#>  [897] 0.8818426 0.8818426 0.8818426 0.8818426 0.8818426 0.8818426 0.8818426
#>  [904] 0.8818426 1.7691097 1.7691097 1.2402561 0.5095553 0.5895282 0.5895282
#>  [911] 0.5895282 0.5895282 2.2853529 0.9402509 1.2240122 0.4426434 0.4426434
#>  [918] 0.4426434 0.4426434 0.7965462 3.9315051 1.4786081 0.9873511 0.9873511
#>  [925] 0.8819741 0.5575483 0.5575483 0.5575483 0.5575483 0.5575483 1.0107915
#>  [932] 0.6319096 0.6319096 1.0116362 1.0334719 1.3364698 1.0447171 1.0447171
#>  [939] 1.0447171 1.0447171 1.0447171 1.2349164 1.2349164 0.8067877 0.8067877
#>  [946] 1.1530077 1.1530077 1.1530077 1.1530077 1.1530077 0.5864910 0.5864910
#>  [953] 0.8844442 2.3550904 1.8404410 1.8404410 0.8118961 0.8118961 1.7674813
#>  [960] 1.6296108 1.5504750 1.5504750 1.0860952 1.3740547 1.3740547 1.3740547
#>  [967] 1.5947011 1.5947011 0.4130341 0.4130341 0.8883238 1.2118599 0.8546112
#>  [974] 1.2140671 1.2140671 1.2140671 1.2140671 1.2140671 1.2140671 1.2140671
#>  [981] 1.2140671 1.2140671 1.2140671 1.2140671 1.2140671 1.2140671 1.2635805
#>  [988] 1.2635805 1.2635805 0.8386937 1.8228218 1.4399821 1.4399821 1.4399821
#>  [995] 1.4399821 1.9898943 0.7625527 0.7625527 0.8942863 0.8942863
#> 
#> 
#> Slot "options":
#> An object of class "McmcOptions"
#> Slot "iterations":
#> [1] 2100
#> 
#> Slot "burnin":
#> [1] 100
#> 
#> Slot "step":
#> [1] 2
#> 
#> Slot "rng_kind":
#> [1] NA
#> 
#> Slot "rng_seed":
#> [1] NA
#> 
#> 
# Create some data from the class `DataDual`.
plcb <- 0.001
my_data <- DataDual(
  w = c(13, 77, 86, 26, 27, 36, 37, 97, 21, 49, 87, 48),
  x = c(plcb, 25, 25, 25, plcb, 50, 50, 50, plcb, 100, 100, 100),
  y = c(0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 1L, 0L),
  doseGrid = c(plcb, seq(25, 300, 25)),
  placebo = TRUE,
  ID = 1:12,
  cohort = c(1L, 1L, 1L, 1L, 2L, 2L, 2L, 2L, 3L, 3L, 3L, 3L)
)

# Initialize the CRM model.
my_model <- DualEndpointRW(
  mean = c(0, 1),
  cov = matrix(c(1, 0, 0, 1), nrow = 2),
  sigma2W = c(a = 0.1, b = 0.1),
  rho = c(a = 1, b = 1),
  sigma2betaW = 0.01,
  rw1 = TRUE
)

# Sample from the posterior distribution.
my_options <- McmcOptions(
  burnin = 50,
  step = 2,
  samples = 4,
  rng_kind = "Mersenne-Twister",
  rng_seed = 1
)

samples <- mcmc(data = my_data, model = my_model, options = my_options)
samples
#> An object of class "Samples"
#> Slot "data":
#> $betaW
#>          [,1]     [,2]     [,3]     [,4]     [,5]     [,6]     [,7]     [,8]
#> [1,] 43.97979 44.41466 44.43972 44.11392 44.62213 45.16043 45.16812 45.21349
#> [2,] 43.15657 42.91989 43.51310 44.68803 44.56862 44.87953 44.94821 45.51928
#> [3,] 63.68104 63.29789 63.85898 64.05148 63.52357 64.10696 64.75609 65.32082
#> [4,] 50.45590 49.98192 49.94248 50.23495 50.54648 50.68016 51.02047 50.21193
#>          [,9]    [,10]    [,11]    [,12]    [,13]
#> [1,] 45.17819 44.50411 44.97736 44.98087 45.22721
#> [2,] 45.87216 45.26223 45.42696 45.75288 45.95267
#> [3,] 65.62907 65.52253 66.59065 66.42558 66.77227
#> [4,] 50.02701 49.17010 49.01135 49.45278 49.73688
#> 
#> $betaZ
#>           [,1]       [,2]
#> [1,] -2.507907 0.03496807
#> [2,] -2.507907 0.03496807
#> [3,] -2.507907 0.03496807
#> [4,] -2.507907 0.03496807
#> 
#> $delta
#>            [,1]        [,2]       [,3]       [,4]      [,5]        [,6]
#> [1,]  0.4348687  0.02505645 -0.3258029  0.5082169 0.5382963 0.007687938
#> [2,] -0.2366798  0.59321185  1.1749236 -0.1194105 0.3109172 0.068670722
#> [3,] -0.3831418  0.56109098  0.1924961 -0.5279107 0.5833939 0.649129673
#> [4,] -0.4739807 -0.03943816  0.2924624  0.3115307 0.1336790 0.340314130
#>             [,7]        [,8]       [,9]      [,10]        [,11]     [,12]
#> [1,]  0.04537578 -0.03529845 -0.6740836  0.4732525  0.003504127 0.2463430
#> [2,]  0.57107036  0.35288467 -0.6099253  0.1647277  0.325915901 0.1997869
#> [3,]  0.56472919  0.30824406 -0.1065357  1.0681196 -0.165072414 0.3466892
#> [4,] -0.80854374 -0.18491804 -0.8569132 -0.1587477  0.441429357 0.2841035
#> 
#> $precW
#> [1] 0.0007380298 0.0009402290 0.0006374998 0.0006963610
#> 
#> $rho
#> [1] 0.1193680 0.1129187 0.2440825 0.1499421
#> 
#> 
#> Slot "options":
#> An object of class "McmcOptions"
#> Slot "iterations":
#> [1] 58
#> 
#> Slot "burnin":
#> [1] 50
#> 
#> Slot "step":
#> [1] 2
#> 
#> Slot "rng_kind":
#> [1] "base::Mersenne-Twister"
#> 
#> Slot "rng_seed":
#> [1] 1
#> 
#> 
# Create some data from the class `DataDual`.
plcb <- 0.001
my_data <- DataDual(
  w = c(13, 77, 86, 26, 27, 36, 37, 97, 21, 49, 87, 48),
  x = c(plcb, 25, 25, 25, plcb, 50, 50, 50, plcb, 100, 100, 100),
  y = c(0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 1L, 0L),
  doseGrid = c(plcb, seq(25, 300, 25)),
  placebo = TRUE,
  ID = 1:12,
  cohort = c(1L, 1L, 1L, 1L, 2L, 2L, 2L, 2L, 3L, 3L, 3L, 3L)
)

# Initialize the CRM model.
my_model <- DualEndpointBeta(
  mean = c(0, 1),
  cov = diag(2),
  ref_dose = 2,
  use_log_dose = FALSE,
  sigma2W = c(a = 1, b = 2),
  rho = c(a = 1.5, b = 2.5),
  E0 = 2,
  Emax = 50,
  delta1 = 6,
  mode = 9,
  ref_dose_beta = my_data@doseGrid[my_data@nGrid] + 10
)

# Sample from the posterior distribution.
my_options <- McmcOptions(
  burnin = 50,
  step = 2,
  samples = 4,
  rng_kind = "Mersenne-Twister",
  rng_seed = 1
)

samples <- mcmc(data = my_data, model = my_model, options = my_options)
samples
#> An object of class "Samples"
#> Slot "data":
#> $betaW
#>      [,1]     [,2] [,3] [,4] [,5] [,6] [,7] [,8] [,9] [,10] [,11] [,12] [,13]
#> [1,]    2 2.383076    2    2    2    2    2    2    2     2     2     2     2
#> [2,]    2 2.383076    2    2    2    2    2    2    2     2     2     2     2
#> [3,]    2 2.383076    2    2    2    2    2    2    2     2     2     2     2
#> [4,]    2 2.383076    2    2    2    2    2    2    2     2     2     2     2
#> 
#> $betaZ
#>           [,1]       [,2]
#> [1,] -4.354759 0.09035452
#> [2,] -4.354759 0.09035452
#> [3,] -4.354759 0.09035452
#> [4,] -3.273111 0.08172139
#> 
#> $precW
#> [1] 0.0004229406 0.0004149886 0.0004264222 0.0003413195
#> 
#> $rho
#> [1] -0.5116824 -0.5902350 -0.5709147 -0.5230612
#> 
#> 
#> Slot "options":
#> An object of class "McmcOptions"
#> Slot "iterations":
#> [1] 58
#> 
#> Slot "burnin":
#> [1] 50
#> 
#> Slot "step":
#> [1] 2
#> 
#> Slot "rng_kind":
#> [1] "base::Mersenne-Twister"
#> 
#> Slot "rng_seed":
#> [1] 1
#> 
#> 
##obtain mcmc DLE samples given the data, LogisticIndepBeta (DLE model) and mcmc simulations options
## data must be of 'Data' class
data <- Data(
  x = c(25, 50, 50, 75, 100, 100, 225, 300),
  y = c(0, 0, 0, 0, 1, 1, 1, 1),
  doseGrid = seq(25, 300, 25)
)
#> Used default patient IDs!
#> Used best guess cohort indices!
## model must be of 'LogisticIndepBeta' class
model <- LogisticIndepBeta(
  binDLE = c(1.05, 1.8),
  DLEweights = c(3, 3),
  DLEdose = c(25, 300),
  data = data
)
## options must be ''McmcOptions' class
options <- McmcOptions(burnin = 100, step = 2, samples = 200)
set.seed(94)
samples <- mcmc(data = data, model = model, options = options)
# nolint start
##obtain mcmc efficacy samples given the data, 'Effloglog' model (efficacy model) and
## mcmc simulations options data must be of 'DataDual' class
data <- DataDual(
  x = c(25, 50, 25, 50, 75, 300, 250, 150),
  y = c(0, 0, 0, 0, 0, 1, 1, 0),
  w = c(0.31, 0.42, 0.59, 0.45, 0.6, 0.7, 0.6, 0.52),
  doseGrid = seq(25, 300, 25),
  placebo = FALSE
)
#> Used default patient IDs!
#> Used best guess cohort indices!
## model must be of 'Effloglog' class
Effmodel <- Effloglog(
  eff = c(1.223, 2.513),
  eff_dose = c(25, 300),
  nu = c(a = 1, b = 0.025),
  data = data
)

## options must be ''McmcOptions' class
options <- McmcOptions(burnin = 100, step = 2, samples = 200)
set.seed(94)
samples <- mcmc(data = data, model = Effmodel, options = options)
# nolint end
## obtain mcmc efficacy samples given the data, 'EffFlexi' model (efficacy model) and
## mcmc simulations options
## data must be of 'DataDual' class
data <- DataDual(
  x = c(25, 50, 25, 50, 75, 300, 250, 150),
  y = c(0, 0, 0, 0, 0, 1, 1, 0),
  w = c(0.31, 0.42, 0.59, 0.45, 0.6, 0.7, 0.6, 0.52),
  doseGrid = seq(25, 300, 25)
)
#> Used default patient IDs!
#> Used best guess cohort indices!
## model must be of 'EffFlexi' class

effmodel <- EffFlexi(
  eff = c(1.223, 2.513),
  eff_dose = c(25, 300),
  sigma2W = c(a = 0.1, b = 0.1),
  sigma2betaW = c(a = 20, b = 50),
  rw1 = FALSE,
  data = data
)

## options must be ''McmcOptions' class
options <- McmcOptions(burnin = 100, step = 2, samples = 200)
set.seed(94)
samples <- mcmc(data = data, model = effmodel, options = options)
ordinal_data <- .DefaultDataOrdinal()
ordinal_model <- .DefaultLogisticLogNormalOrdinal()
mcmc_options <- .DefaultMcmcOptions()

samples <- mcmc(ordinal_data, ordinal_model, mcmc_options)
```
