# Get the Biomarker Levels for a Given Dual-Endpoint Model, Given Dose Levels and Samples

**\[experimental\]**

## Usage

``` r
biomarker(xLevel, model, samples, ...)

# S4 method for class 'integer,DualEndpoint,Samples'
biomarker(xLevel, model, samples, ...)
```

## Arguments

- xLevel:

  (`integer`)  
  the levels for the doses the patients have been given w.r.t dose grid.
  See
  [`Data`](https://openpharma.github.io/crmPack/reference/Data-class.md)
  for more details.

- model:

  (`DualEndpoint`)  
  the model.

- samples:

  (`Samples`)  
  the samples of model's parameters that store the value of biomarker
  levels for all doses on the dose grid.

- ...:

  not used.

## Value

The biomarker levels.

## Details

This function simply returns a specific columns (with the indices equal
to `xLevel`) of the biomarker samples matrix, which is included in the
the `samples` object.

## Functions

- `biomarker(xLevel = integer, model = DualEndpoint, samples = Samples)`:

## Examples

``` r
# Create the data.
my_data <- DataDual(
  x = c(0.1, 0.5, 1.5, 3, 6, 10, 10, 10, 20, 20, 20, 40, 40, 40, 50, 50, 50),
  y = c(0, 0, 0, 0, 0, 0, 1, 0, 0, 1, 1, 0, 0, 1, 0, 1, 1),
  ID = 1:17,
  cohort = c(
    1L,
    2L,
    3L,
    4L,
    5L,
    6L,
    6L,
    6L,
    7L,
    7L,
    7L,
    8L,
    8L,
    8L,
    9L,
    9L,
    9L
  ),
  w = c(
    0.31,
    0.42,
    0.59,
    0.45,
    0.6,
    0.7,
    0.55,
    0.6,
    0.52,
    0.54,
    0.56,
    0.43,
    0.41,
    0.39,
    0.34,
    0.38,
    0.21
  ),
  doseGrid = c(0.1, 0.5, 1.5, 3, 6, seq(from = 10, to = 80, by = 2))
)

# Initialize the Dual-Endpoint model (in this case RW1).
my_model <- DualEndpointRW(
  mean = c(0, 1),
  cov = matrix(c(1, 0, 0, 1), nrow = 2),
  sigma2betaW = 0.01,
  sigma2W = c(a = 0.1, b = 0.1),
  rho = c(a = 1, b = 1),
  rw1 = TRUE
)

# Set-up some MCMC parameters and generate samples from the posterior.
my_options <- McmcOptions(
  burnin = 100,
  step = 2,
  samples = 500
)
my_samples <- mcmc(my_data, my_model, my_options)

# Obtain the biomarker levels (samples) for the second dose from the dose grid,
# which is 0.5.
biomarker(
  xLevel = 2L,
  model = my_model,
  samples = my_samples
)
#>   [1] 0.4219139 0.4949522 0.4380181 0.4044383 0.4501302 0.4561474 0.4108801
#>   [8] 0.4380011 0.4979044 0.5174023 0.5311919 0.5031583 0.4670496 0.4300584
#>  [15] 0.3595799 0.3587344 0.4167095 0.4109574 0.3955468 0.4224563 0.3595187
#>  [22] 0.3469946 0.3150757 0.3242484 0.4563644 0.4756665 0.4280248 0.5266946
#>  [29] 0.5842834 0.5290511 0.4503140 0.5868981 0.6018456 0.5744696 0.5769725
#>  [36] 0.5349597 0.5046027 0.4465494 0.6447288 0.4876093 0.5017006 0.3680265
#>  [43] 0.3900059 0.4555272 0.4986333 0.4731623 0.5197242 0.5126867 0.5649137
#>  [50] 0.4710429 0.4586579 0.4619431 0.4775054 0.4785544 0.4664286 0.4592547
#>  [57] 0.3394250 0.3208904 0.3314765 0.2196809 0.2793423 0.3158682 0.3249540
#>  [64] 0.3398159 0.3941802 0.4416329 0.6371846 0.4925218 0.4617426 0.3923842
#>  [71] 0.3418647 0.1212829 0.2577053 0.4379711 0.5418288 0.5480865 0.4256079
#>  [78] 0.4845194 0.5303361 0.5055385 0.5773504 0.4651913 0.4502754 0.6070363
#>  [85] 0.5919987 0.5078756 0.4485103 0.5439571 0.5171157 0.4749718 0.3957146
#>  [92] 0.4167333 0.4401412 0.4021864 0.2951560 0.3131127 0.3633929 0.3917548
#>  [99] 0.3878517 0.4163192 0.2638187 0.2616321 0.3928579 0.4234984 0.3846975
#> [106] 0.4045277 0.3965604 0.4662539 0.2992308 0.3910474 0.3052481 0.2983157
#> [113] 0.3676599 0.2580517 0.2677846 0.2891157 0.3464786 0.3549511 0.4414093
#> [120] 0.4619310 0.4712857 0.4326642 0.3966765 0.3967521 0.5195869 0.6526880
#> [127] 0.5315316 0.5981024 0.5290130 0.5836093 0.5828262 0.5540930 0.4769573
#> [134] 0.5047397 0.6381858 0.7081020 0.4967977 0.4086203 0.3365124 0.4551701
#> [141] 0.3948317 0.4248468 0.4695115 0.4789997 0.4327600 0.5020155 0.4834783
#> [148] 0.4802004 0.5371075 0.5475037 0.4668191 0.5274380 0.5913956 0.5427213
#> [155] 0.5275412 0.4878229 0.4028147 0.3567234 0.3291219 0.4224834 0.4975581
#> [162] 0.6177310 0.5268969 0.6076538 0.5274842 0.5518298 0.3668236 0.2963426
#> [169] 0.2642391 0.2110099 0.3739209 0.4592884 0.4605342 0.5328925 0.4623828
#> [176] 0.4558618 0.4415108 0.5377889 0.6451438 0.5376323 0.4232911 0.3219536
#> [183] 0.3415807 0.3915640 0.2671641 0.3829147 0.3772956 0.4104683 0.5302538
#> [190] 0.4846922 0.4365094 0.5124601 0.4413376 0.4883470 0.5440808 0.4345228
#> [197] 0.4316227 0.5366453 0.4897942 0.5458101 0.4588724 0.4749605 0.4008664
#> [204] 0.3575702 0.2677106 0.3309984 0.3157216 0.3731896 0.3928820 0.3712742
#> [211] 0.3873235 0.3648924 0.4843811 0.4114004 0.3633758 0.4006059 0.3487833
#> [218] 0.3760413 0.2928359 0.3716771 0.4630078 0.4214018 0.4266047 0.4147136
#> [225] 0.3746180 0.2431501 0.2841201 0.3423834 0.3451228 0.4315589 0.3885127
#> [232] 0.3618852 0.3546061 0.4221309 0.3264077 0.2943982 0.4148108 0.3862999
#> [239] 0.3982880 0.4640765 0.4523080 0.4071650 0.3910200 0.4733733 0.5463916
#> [246] 0.5503992 0.5564756 0.5742734 0.5305259 0.5405325 0.5188226 0.5322013
#> [253] 0.4937106 0.4421388 0.3864525 0.3320549 0.3504060 0.3273447 0.3302859
#> [260] 0.2651212 0.3307200 0.3328407 0.3845986 0.4151305 0.4220084 0.4452814
#> [267] 0.3164220 0.3456347 0.4161702 0.4001892 0.3459656 0.3386644 0.2652313
#> [274] 0.2846349 0.2353534 0.4984287 0.5942813 0.5253221 0.3891166 0.3925967
#> [281] 0.4207837 0.4081473 0.4457940 0.4221339 0.4019913 0.3196791 0.2740075
#> [288] 0.4281586 0.4687458 0.4122861 0.5103540 0.4683453 0.5011949 0.4572832
#> [295] 0.3923505 0.3327766 0.2171671 0.3119507 0.4221123 0.4749451 0.4212147
#> [302] 0.3847037 0.3855377 0.4418944 0.5214864 0.4435615 0.4309138 0.3546397
#> [309] 0.4920651 0.4566559 0.5263616 0.5452550 0.5792461 0.5828522 0.5828135
#> [316] 0.6053021 0.6094663 0.5247556 0.4668267 0.5065413 0.4806461 0.4405970
#> [323] 0.5304298 0.5564646 0.3971170 0.4673770 0.4329618 0.3674690 0.5378595
#> [330] 0.4999351 0.4773914 0.4781691 0.4666629 0.4698456 0.4223973 0.3987476
#> [337] 0.3267840 0.3914916 0.5086022 0.4958503 0.4755220 0.4991524 0.5410984
#> [344] 0.5431222 0.5081546 0.4850377 0.6051178 0.6155733 0.5954009 0.5048484
#> [351] 0.4512823 0.5256059 0.4220164 0.3286352 0.3630744 0.5531252 0.7404788
#> [358] 0.4592561 0.3438681 0.3745900 0.3299922 0.3718755 0.3894657 0.3885659
#> [365] 0.4552658 0.4577910 0.4884579 0.5326816 0.4849527 0.6306122 0.5402631
#> [372] 0.3778191 0.4175825 0.3943327 0.3612467 0.2747570 0.3342350 0.3567985
#> [379] 0.4912910 0.5284547 0.4940200 0.4747023 0.5060006 0.4825186 0.4954365
#> [386] 0.4909379 0.5340232 0.6212980 0.6262067 0.5945018 0.5389556 0.4277553
#> [393] 0.4260608 0.4029522 0.2852827 0.3759044 0.3611107 0.3916661 0.3664035
#> [400] 0.4189000 0.4233784 0.4407917 0.6626859 0.6925916 0.6454464 0.4504019
#> [407] 0.4943746 0.4853862 0.3611322 0.3172495 0.1532026 0.2379867 0.2749864
#> [414] 0.3150780 0.2559719 0.2603032 0.3248417 0.3891937 0.4098191 0.5217223
#> [421] 0.5102316 0.4736682 0.5817313 0.6088436 0.6283868 0.6626636 0.5371534
#> [428] 0.5748788 0.4010393 0.2890996 0.2953171 0.2921757 0.4437436 0.3831552
#> [435] 0.4245737 0.4553280 0.4730925 0.4848938 0.4256146 0.5299992 0.4994694
#> [442] 0.5145189 0.4499279 0.3753792 0.3258311 0.3013915 0.2822341 0.2130254
#> [449] 0.3166822 0.3498422 0.3248399 0.3122434 0.2876928 0.4560827 0.5050089
#> [456] 0.5271576 0.4278622 0.3936265 0.3804313 0.3305388 0.3754298 0.4320559
#> [463] 0.4500982 0.4847667 0.3460814 0.3891904 0.4167545 0.4025096 0.3475120
#> [470] 0.3785275 0.3908316 0.3818962 0.4167575 0.3631682 0.4253566 0.3634626
#> [477] 0.2369423 0.2764483 0.2800414 0.3739394 0.5009972 0.5444871 0.5189803
#> [484] 0.4366326 0.4318175 0.5229116 0.4786473 0.5228891 0.4350939 0.4206664
#> [491] 0.3622658 0.3513675 0.4557862 0.5042861 0.4162729 0.3854180 0.3311038
#> [498] 0.3687117 0.2955401 0.4589873
```
