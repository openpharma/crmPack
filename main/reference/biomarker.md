# Get the Biomarker Levels for a Given Dual-Endpoint Model, Given Dose Levels and Samples

**\[experimental\]**

## Usage

``` r
biomarker(xLevel, model, samples, ...)

# S4 method for class 'integer,DualEndpoint,Samples'
biomarker(xLevel, model, samples, ...)
```

## Arguments

- xLevel:

  (`integer`)  
  the levels for the doses the patients have been given w.r.t dose grid.
  See
  [`Data`](https://openpharma.github.io/crmPack/reference/Data-class.md)
  for more details.

- model:

  (`DualEndpoint`)  
  the model.

- samples:

  (`Samples`)  
  the samples of model's parameters that store the value of biomarker
  levels for all doses on the dose grid.

- ...:

  not used.

## Value

The biomarker levels.

## Details

This function simply returns a specific columns (with the indices equal
to `xLevel`) of the biomarker samples matrix, which is included in the
the `samples` object.

## Functions

- `biomarker(xLevel = integer, model = DualEndpoint, samples = Samples)`:

## Examples

``` r
# Create the data.
my_data <- DataDual(
  x = c(0.1, 0.5, 1.5, 3, 6, 10, 10, 10, 20, 20, 20, 40, 40, 40, 50, 50, 50),
  y = c(0, 0, 0, 0, 0, 0, 1, 0, 0, 1, 1, 0, 0, 1, 0, 1, 1),
  ID = 1:17,
  cohort = c(
    1L,
    2L,
    3L,
    4L,
    5L,
    6L,
    6L,
    6L,
    7L,
    7L,
    7L,
    8L,
    8L,
    8L,
    9L,
    9L,
    9L
  ),
  w = c(
    0.31,
    0.42,
    0.59,
    0.45,
    0.6,
    0.7,
    0.55,
    0.6,
    0.52,
    0.54,
    0.56,
    0.43,
    0.41,
    0.39,
    0.34,
    0.38,
    0.21
  ),
  doseGrid = c(0.1, 0.5, 1.5, 3, 6, seq(from = 10, to = 80, by = 2))
)

# Initialize the Dual-Endpoint model (in this case RW1).
my_model <- DualEndpointRW(
  mean = c(0, 1),
  cov = matrix(c(1, 0, 0, 1), nrow = 2),
  sigma2betaW = 0.01,
  sigma2W = c(a = 0.1, b = 0.1),
  rho = c(a = 1, b = 1),
  rw1 = TRUE
)

# Set-up some MCMC parameters and generate samples from the posterior.
my_options <- McmcOptions(
  burnin = 100,
  step = 2,
  samples = 500
)
my_samples <- mcmc(my_data, my_model, my_options)

# Obtain the biomarker levels (samples) for the second dose from the dose grid,
# which is 0.5.
biomarker(
  xLevel = 2L,
  model = my_model,
  samples = my_samples
)
#>   [1] 0.2572613 0.2956577 0.3452974 0.3602565 0.3799379 0.4113775 0.3710390
#>   [8] 0.3744555 0.3714247 0.3271981 0.3637314 0.3588115 0.5931417 0.5811308
#>  [15] 0.5483419 0.5346781 0.5603537 0.5163695 0.3894618 0.3329894 0.3746253
#>  [22] 0.4809316 0.3833782 0.4503527 0.4112151 0.5683872 0.5422363 0.5925662
#>  [29] 0.5198079 0.3509387 0.3881898 0.4327576 0.3414130 0.3669588 0.3578049
#>  [36] 0.3218520 0.3437813 0.4089032 0.3634002 0.3810094 0.4320031 0.4650874
#>  [43] 0.4583054 0.4402378 0.4359906 0.5650615 0.5992523 0.5356410 0.4341402
#>  [50] 0.3784947 0.4046553 0.3870425 0.4186845 0.4830476 0.3220064 0.2973520
#>  [57] 0.3942332 0.3024429 0.4092997 0.4303012 0.4076201 0.5335729 0.5025434
#>  [64] 0.4401466 0.3882180 0.3409922 0.4604526 0.4872353 0.5164374 0.4955868
#>  [71] 0.4271975 0.4957399 0.4657573 0.4934381 0.5097432 0.5279739 0.4231021
#>  [78] 0.3183155 0.2181219 0.2873614 0.3695916 0.2724081 0.2672236 0.2806320
#>  [85] 0.2555057 0.3459658 0.3701174 0.3683704 0.5051656 0.5988688 0.5478391
#>  [92] 0.5309433 0.6118053 0.6011439 0.4204477 0.3941231 0.3482687 0.2686301
#>  [99] 0.3321346 0.3204480 0.2724076 0.3649255 0.3247172 0.3897752 0.4788230
#> [106] 0.3788066 0.6444818 0.4544269 0.4118738 0.4422352 0.4189207 0.5276314
#> [113] 0.4920474 0.6095173 0.5611581 0.4855727 0.5401671 0.5607962 0.5988252
#> [120] 0.6522806 0.5738426 0.5564442 0.5318435 0.3367230 0.3957935 0.3553134
#> [127] 0.3311607 0.3924793 0.4162157 0.4414105 0.4813747 0.5606225 0.5945501
#> [134] 0.6139542 0.6273841 0.5495913 0.3707054 0.3701182 0.4501385 0.3772788
#> [141] 0.3369613 0.3940644 0.4408390 0.4578086 0.4832235 0.3867979 0.4348213
#> [148] 0.3433107 0.3430747 0.2936871 0.4750382 0.4481504 0.4562607 0.4206981
#> [155] 0.4144697 0.4074154 0.3770490 0.3761120 0.3537517 0.3186554 0.3300418
#> [162] 0.4271665 0.4502299 0.5168619 0.5121751 0.4862023 0.4751632 0.4961709
#> [169] 0.4433062 0.4122675 0.4377158 0.4195038 0.4194347 0.4344506 0.5190895
#> [176] 0.5604572 0.4886282 0.4555803 0.3704793 0.2993328 0.2119960 0.2388888
#> [183] 0.2579320 0.1882381 0.1860416 0.3026858 0.3218768 0.4984565 0.6322695
#> [190] 0.6616825 0.4802983 0.4004999 0.3020402 0.2775237 0.4279684 0.4414987
#> [197] 0.4825465 0.4347539 0.4535193 0.4129360 0.4100771 0.4597228 0.5455416
#> [204] 0.5675595 0.5622158 0.4436973 0.3441932 0.3443108 0.3769738 0.3132834
#> [211] 0.2608357 0.2938162 0.4168641 0.3929012 0.2894450 0.3246503 0.3598962
#> [218] 0.4177014 0.4104729 0.3814490 0.2859526 0.4287793 0.4811855 0.5041493
#> [225] 0.3882870 0.3424226 0.2680374 0.3296554 0.3370217 0.3684266 0.3969475
#> [232] 0.5059869 0.4361667 0.4629950 0.5434543 0.5135350 0.4618178 0.4210633
#> [239] 0.4421347 0.2992246 0.3973299 0.6113405 0.6719475 0.4586217 0.4708366
#> [246] 0.5818120 0.5932855 0.5093971 0.4912403 0.4760963 0.3984329 0.3658790
#> [253] 0.3686945 0.3301447 0.3566900 0.5746998 0.5535107 0.5513128 0.5817626
#> [260] 0.5226911 0.5616391 0.4938913 0.5115292 0.5030500 0.4567238 0.4612228
#> [267] 0.5191886 0.3473339 0.4572257 0.3955787 0.3762567 0.4304493 0.4071590
#> [274] 0.3937213 0.2893082 0.2609094 0.3870499 0.3976060 0.3347657 0.3614164
#> [281] 0.3785253 0.4191122 0.3930483 0.4083319 0.4059580 0.3782395 0.4350316
#> [288] 0.4395548 0.3595095 0.3860511 0.4174704 0.3736078 0.3595276 0.3291082
#> [295] 0.3767417 0.2420292 0.2895243 0.2396311 0.2901166 0.3354670 0.3812317
#> [302] 0.5177372 0.5639793 0.5740211 0.4853825 0.4465460 0.4235103 0.5033337
#> [309] 0.5027153 0.5297941 0.5702323 0.4576877 0.4770236 0.3904161 0.4724029
#> [316] 0.5122585 0.5147642 0.5853599 0.6280197 0.5030917 0.4843991 0.6024581
#> [323] 0.6498895 0.5362435 0.4749134 0.5674653 0.4742657 0.5455495 0.5052330
#> [330] 0.6239110 0.5638511 0.6545432 0.5694525 0.5522716 0.3639990 0.3309992
#> [337] 0.3086143 0.3531335 0.2116691 0.3056314 0.2944261 0.2758859 0.3388438
#> [344] 0.3321316 0.3025126 0.3440771 0.3382706 0.4125125 0.4784770 0.4422680
#> [351] 0.4102739 0.4824772 0.4794904 0.4767623 0.4932323 0.3919425 0.4211240
#> [358] 0.3655298 0.4012079 0.4040628 0.4278884 0.2730166 0.3628741 0.3064578
#> [365] 0.3414600 0.3872493 0.3666975 0.3651701 0.4153747 0.3275397 0.3475016
#> [372] 0.3833483 0.3643014 0.3883591 0.4299264 0.4217147 0.4117686 0.4318801
#> [379] 0.4003021 0.4704130 0.4461889 0.4355962 0.4007028 0.4092373 0.3958605
#> [386] 0.3602546 0.4469158 0.3134621 0.4833757 0.5240301 0.6749684 0.6627209
#> [393] 0.5880077 0.4860053 0.4604721 0.3384785 0.2945183 0.3549040 0.3859217
#> [400] 0.3867716 0.4134537 0.4331953 0.4205517 0.4276749 0.4156732 0.4076043
#> [407] 0.3816841 0.3452609 0.3223442 0.4020577 0.3896009 0.3647136 0.3717888
#> [414] 0.3929000 0.3834370 0.3631577 0.3435474 0.3231358 0.4964612 0.4749943
#> [421] 0.5027193 0.4233306 0.3616597 0.4289286 0.4335158 0.5516203 0.4790647
#> [428] 0.4967477 0.5129550 0.4062186 0.3835474 0.3343140 0.3472461 0.3483000
#> [435] 0.3420801 0.3591444 0.3904941 0.5603306 0.5551008 0.5436881 0.4770082
#> [442] 0.4264239 0.3740654 0.3443047 0.3096150 0.4415406 0.6828247 0.6674093
#> [449] 0.5969847 0.7434676 0.5048316 0.4580666 0.4178802 0.4114181 0.4110880
#> [456] 0.4065421 0.3777813 0.3612726 0.4259205 0.3345020 0.3281056 0.3537940
#> [463] 0.3074721 0.4572456 0.5970253 0.5170047 0.4462326 0.5142506 0.4774139
#> [470] 0.6398551 0.5870588 0.5762068 0.5722555 0.5814670 0.5587986 0.4083775
#> [477] 0.4335846 0.4261520 0.4546980 0.4580976 0.4871398 0.4907905 0.5216585
#> [484] 0.3948011 0.3189856 0.3361533 0.4054279 0.5958587 0.5861721 0.5389643
#> [491] 0.4769575 0.3532107 0.4669879 0.4704272 0.3366970 0.3254377 0.4387821
#> [498] 0.3657602 0.4122346 0.4243818
```
