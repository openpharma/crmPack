# Get the Biomarker Levels for a Given Dual-Endpoint Model, Given Dose Levels and Samples

**\[experimental\]**

## Usage

``` r
biomarker(xLevel, model, samples, ...)

# S4 method for class 'integer,DualEndpoint,Samples'
biomarker(xLevel, model, samples, ...)
```

## Arguments

- xLevel:

  (`integer`)  
  the levels for the doses the patients have been given w.r.t dose grid.
  See
  [`Data`](https://openpharma.github.io/crmPack/reference/Data-class.md)
  for more details.

- model:

  (`DualEndpoint`)  
  the model.

- samples:

  (`Samples`)  
  the samples of model's parameters that store the value of biomarker
  levels for all doses on the dose grid.

- ...:

  not used.

## Value

The biomarker levels.

## Details

This function simply returns a specific columns (with the indices equal
to `xLevel`) of the biomarker samples matrix, which is included in the
the `samples` object.

## Functions

- `biomarker(xLevel = integer, model = DualEndpoint, samples = Samples)`:

## Examples

``` r
# Create the data.
my_data <- DataDual(
  x = c(0.1, 0.5, 1.5, 3, 6, 10, 10, 10, 20, 20, 20, 40, 40, 40, 50, 50, 50),
  y = c(0, 0, 0, 0, 0, 0, 1, 0, 0, 1, 1, 0, 0, 1, 0, 1, 1),
  ID = 1:17,
  cohort = c(
    1L,
    2L,
    3L,
    4L,
    5L,
    6L,
    6L,
    6L,
    7L,
    7L,
    7L,
    8L,
    8L,
    8L,
    9L,
    9L,
    9L
  ),
  w = c(
    0.31,
    0.42,
    0.59,
    0.45,
    0.6,
    0.7,
    0.55,
    0.6,
    0.52,
    0.54,
    0.56,
    0.43,
    0.41,
    0.39,
    0.34,
    0.38,
    0.21
  ),
  doseGrid = c(0.1, 0.5, 1.5, 3, 6, seq(from = 10, to = 80, by = 2))
)

# Initialize the Dual-Endpoint model (in this case RW1).
my_model <- DualEndpointRW(
  mean = c(0, 1),
  cov = matrix(c(1, 0, 0, 1), nrow = 2),
  sigma2betaW = 0.01,
  sigma2W = c(a = 0.1, b = 0.1),
  rho = c(a = 1, b = 1),
  rw1 = TRUE
)

# Set-up some MCMC parameters and generate samples from the posterior.
my_options <- McmcOptions(
  burnin = 100,
  step = 2,
  samples = 500
)
my_samples <- mcmc(my_data, my_model, my_options)

# Obtain the biomarker levels (samples) for the second dose from the dose grid,
# which is 0.5.
biomarker(
  xLevel = 2L,
  model = my_model,
  samples = my_samples
)
#>   [1] 0.5872191 0.5057421 0.4349193 0.4244843 0.5335419 0.5486771 0.4854834
#>   [8] 0.4718960 0.3471464 0.2807405 0.3066113 0.2934814 0.4259749 0.5622447
#>  [15] 0.4833458 0.4233652 0.4740078 0.4301411 0.3649423 0.4483812 0.4370801
#>  [22] 0.3916008 0.4166870 0.4692068 0.4119649 0.4681302 0.4269352 0.5744621
#>  [29] 0.6113972 0.6500969 0.5442439 0.4331386 0.4663542 0.3153624 0.3251789
#>  [36] 0.3110661 0.3516091 0.3327760 0.3456776 0.3312388 0.3695870 0.2883092
#>  [43] 0.4201025 0.2591166 0.2512093 0.3553962 0.4367666 0.4540767 0.4440709
#>  [50] 0.4411970 0.5490040 0.5089590 0.7278775 0.7664835 0.7051096 0.4687007
#>  [57] 0.6041722 0.2059566 0.1379177 0.2217563 0.3028793 0.3411635 0.3358101
#>  [64] 0.6051698 0.3680685 0.4583366 0.4299447 0.3884146 0.2965530 0.3178765
#>  [71] 0.4494785 0.5566529 0.5406030 0.5845946 0.6654619 0.7349879 0.7541507
#>  [78] 0.5724415 0.5198026 0.5296431 0.5310346 0.5224768 0.5313139 0.4392415
#>  [85] 0.4002517 0.3659591 0.2287076 0.2893187 0.3095155 0.2672672 0.2379904
#>  [92] 0.2397387 0.3480736 0.3938435 0.4019038 0.4857666 0.3878369 0.3794622
#>  [99] 0.3553310 0.3206684 0.4728368 0.4861712 0.4096684 0.3952821 0.3480602
#> [106] 0.3832673 0.3701821 0.3914018 0.3606716 0.4380357 0.4116333 0.4467485
#> [113] 0.3969980 0.4168311 0.4185351 0.4314694 0.4284721 0.5074673 0.4292323
#> [120] 0.3048963 0.3787178 0.2923062 0.3894063 0.2904495 0.3104179 0.3210596
#> [127] 0.3798835 0.3335436 0.3706331 0.5140025 0.4088573 0.4607500 0.5507988
#> [134] 0.6004194 0.5343494 0.4212051 0.4990200 0.4582145 0.4165316 0.4814363
#> [141] 0.4815459 0.4954229 0.5031213 0.4999146 0.4927823 0.4183311 0.3974679
#> [148] 0.3853085 0.4017905 0.3889159 0.3663517 0.3758587 0.3818125 0.3801236
#> [155] 0.3784538 0.4359978 0.4424341 0.5408209 0.5042891 0.4953952 0.4334559
#> [162] 0.3063664 0.3786821 0.3633801 0.7692978 0.6053253 0.8458233 0.7114433
#> [169] 0.4289782 0.3998196 0.4206053 0.4270770 0.2992761 0.2269017 0.1641281
#> [176] 0.2618780 0.2820979 0.3004906 0.1965660 0.2386531 0.2440268 0.3241011
#> [183] 0.5197148 0.6046739 0.4741744 0.5798308 0.5164780 0.4985104 0.4188933
#> [190] 0.5182612 0.5542154 0.4409253 0.4115360 0.4241613 0.4518274 0.4074638
#> [197] 0.4313014 0.4954820 0.4192653 0.5121772 0.4622938 0.4941726 0.5287816
#> [204] 0.5446107 0.4728712 0.4453424 0.3498449 0.2939749 0.4250823 0.5015701
#> [211] 0.5276808 0.5323083 0.5067040 0.6186573 0.5360135 0.5310727 0.6489821
#> [218] 0.6778918 0.5953313 0.4654968 0.4040326 0.4416367 0.4291488 0.4071337
#> [225] 0.4254041 0.5078812 0.5970114 0.5895239 0.6693502 0.5245197 0.5563305
#> [232] 0.6121860 0.4877967 0.3663444 0.4306748 0.3490868 0.3952648 0.5077164
#> [239] 0.5304828 0.5108327 0.5085574 0.3795007 0.4406287 0.5082358 0.4963238
#> [246] 0.5843599 0.5359517 0.4960888 0.3918951 0.3765856 0.4622778 0.3371594
#> [253] 0.2227911 0.3429960 0.4260929 0.4932294 0.6004016 0.4752286 0.5156375
#> [260] 0.5481331 0.4988723 0.4194889 0.3095767 0.3504861 0.4428331 0.4646480
#> [267] 0.4838073 0.5615087 0.4047889 0.4234345 0.3574926 0.3475796 0.3885543
#> [274] 0.3356419 0.3076266 0.2160020 0.1728063 0.2232673 0.3253421 0.3693543
#> [281] 0.4579714 0.4711962 0.4817252 0.4164584 0.4617656 0.3016830 0.2366389
#> [288] 0.1884536 0.3311370 0.3886525 0.4288949 0.4490854 0.4419622 0.4947811
#> [295] 0.5280831 0.5346709 0.4086835 0.3805084 0.4089733 0.3575878 0.3345882
#> [302] 0.3671240 0.4518838 0.4849356 0.4427694 0.5654733 0.4512488 0.4502466
#> [309] 0.4650020 0.5492042 0.4720676 0.4928686 0.4776915 0.4279350 0.4426841
#> [316] 0.4350989 0.4393666 0.4908872 0.5255337 0.5273057 0.4868556 0.3533182
#> [323] 0.3571976 0.3930685 0.3736491 0.4230778 0.3782559 0.5050092 0.5342503
#> [330] 0.4449856 0.5624437 0.5092434 0.5561567 0.6075004 0.4231962 0.3940860
#> [337] 0.3107265 0.3338638 0.4016628 0.4304886 0.4325818 0.5186454 0.4886902
#> [344] 0.5871831 0.5349716 0.4830442 0.5228830 0.6000917 0.4948011 0.4982246
#> [351] 0.5054131 0.4161811 0.3923066 0.4054465 0.4025669 0.2349228 0.2890068
#> [358] 0.3313013 0.3328574 0.3718876 0.2326625 0.2431109 0.3605754 0.3869735
#> [365] 0.2686233 0.3451418 0.3283511 0.3466518 0.3990738 0.3343076 0.3691975
#> [372] 0.2981291 0.3662620 0.3373631 0.2950963 0.2233695 0.2378525 0.3418567
#> [379] 0.4301617 0.3736530 0.4279889 0.5141063 0.4838408 0.5239916 0.6633414
#> [386] 0.6400156 0.5577741 0.5314049 0.5933025 0.6259949 0.4655350 0.4653604
#> [393] 0.5214962 0.5967028 0.4762491 0.3610246 0.2657943 0.2266317 0.2321038
#> [400] 0.3351174 0.2704893 0.2606520 0.3115254 0.3387611 0.3248171 0.2952948
#> [407] 0.3651551 0.3256180 0.3512965 0.4344908 0.5394649 0.5466699 0.5551856
#> [414] 0.5250604 0.4230373 0.3569054 0.3550041 0.4148266 0.3623332 0.4214024
#> [421] 0.4164025 0.3459055 0.3631115 0.5382441 0.5702917 0.5024810 0.3840185
#> [428] 0.4175362 0.3215827 0.3134880 0.2662787 0.2875390 0.3236998 0.4010674
#> [435] 0.4297051 0.3492418 0.2692127 0.2461044 0.3319154 0.3512783 0.3327679
#> [442] 0.3021265 0.3421719 0.3770695 0.3911682 0.3540539 0.2696358 0.4317820
#> [449] 0.4248518 0.4612207 0.4252703 0.4582971 0.4084184 0.3083240 0.2942197
#> [456] 0.4014232 0.3450399 0.3655773 0.3357141 0.3634734 0.3722589 0.3483733
#> [463] 0.3003884 0.3452634 0.4152438 0.2669032 0.3324191 0.3248076 0.3287386
#> [470] 0.3265801 0.3010738 0.4033832 0.4381382 0.3527103 0.4282539 0.3888260
#> [477] 0.4401098 0.4692207 0.4367726 0.3344858 0.4146956 0.4073518 0.3297154
#> [484] 0.4011653 0.5007327 0.4912439 0.4521863 0.5168526 0.6043881 0.6876434
#> [491] 0.5234041 0.5494162 0.4636999 0.5461879 0.6104718 0.5636672 0.6164419
#> [498] 0.6652816 0.5863812 0.4971274
```
