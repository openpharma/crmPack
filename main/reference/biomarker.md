# Get the Biomarker Levels for a Given Dual-Endpoint Model, Given Dose Levels and Samples

**\[experimental\]**

## Usage

``` r
biomarker(xLevel, model, samples, ...)

# S4 method for class 'integer,DualEndpoint,Samples'
biomarker(xLevel, model, samples, ...)
```

## Arguments

- xLevel:

  (`integer`)  
  the levels for the doses the patients have been given w.r.t dose grid.
  See
  [`Data`](https://openpharma.github.io/crmPack/reference/Data-class.md)
  for more details.

- model:

  (`DualEndpoint`)  
  the model.

- samples:

  (`Samples`)  
  the samples of model's parameters that store the value of biomarker
  levels for all doses on the dose grid.

- ...:

  not used.

## Value

The biomarker levels.

## Details

This function simply returns a specific columns (with the indices equal
to `xLevel`) of the biomarker samples matrix, which is included in the
the `samples` object.

## Functions

- `biomarker(xLevel = integer, model = DualEndpoint, samples = Samples)`:

## Examples

``` r
# Create the data.
my_data <- DataDual(
  x = c(0.1, 0.5, 1.5, 3, 6, 10, 10, 10, 20, 20, 20, 40, 40, 40, 50, 50, 50),
  y = c(0, 0, 0, 0, 0, 0, 1, 0, 0, 1, 1, 0, 0, 1, 0, 1, 1),
  ID = 1:17,
  cohort = c(
    1L,
    2L,
    3L,
    4L,
    5L,
    6L,
    6L,
    6L,
    7L,
    7L,
    7L,
    8L,
    8L,
    8L,
    9L,
    9L,
    9L
  ),
  w = c(
    0.31,
    0.42,
    0.59,
    0.45,
    0.6,
    0.7,
    0.55,
    0.6,
    0.52,
    0.54,
    0.56,
    0.43,
    0.41,
    0.39,
    0.34,
    0.38,
    0.21
  ),
  doseGrid = c(0.1, 0.5, 1.5, 3, 6, seq(from = 10, to = 80, by = 2))
)

# Initialize the Dual-Endpoint model (in this case RW1).
my_model <- DualEndpointRW(
  mean = c(0, 1),
  cov = matrix(c(1, 0, 0, 1), nrow = 2),
  sigma2betaW = 0.01,
  sigma2W = c(a = 0.1, b = 0.1),
  rho = c(a = 1, b = 1),
  rw1 = TRUE
)

# Set-up some MCMC parameters and generate samples from the posterior.
my_options <- McmcOptions(
  burnin = 100,
  step = 2,
  samples = 500
)
my_samples <- mcmc(my_data, my_model, my_options)

# Obtain the biomarker levels (samples) for the second dose from the dose grid,
# which is 0.5.
biomarker(
  xLevel = 2L,
  model = my_model,
  samples = my_samples
)
#>   [1] 0.3767538 0.4257763 0.3637305 0.4128534 0.5376102 0.4361887 0.4599906
#>   [8] 0.5865825 0.5605980 0.4830016 0.4849558 0.2860321 0.3006170 0.3397975
#>  [15] 0.3856894 0.3587860 0.3880916 0.4036198 0.4035739 0.4555130 0.4252294
#>  [22] 0.4190981 0.4313340 0.4558177 0.4268488 0.4593843 0.5931246 0.5684774
#>  [29] 0.5254853 0.4741968 0.4900851 0.4107580 0.4120758 0.4211871 0.3165998
#>  [36] 0.3273849 0.3166562 0.3276489 0.3592667 0.4278779 0.3779780 0.3768011
#>  [43] 0.4034515 0.4900988 0.5153085 0.4482632 0.5076271 0.5153113 0.4461475
#>  [50] 0.3757091 0.3157894 0.4447214 0.3845384 0.3755993 0.5686021 0.5254819
#>  [57] 0.4165756 0.3918987 0.3854943 0.4051801 0.3956934 0.3683649 0.3789898
#>  [64] 0.2921273 0.4186223 0.3496407 0.4790230 0.4974778 0.4269394 0.4333865
#>  [71] 0.4008989 0.4395098 0.4650749 0.3482572 0.4357329 0.4279749 0.4514929
#>  [78] 0.3061866 0.3336463 0.3865239 0.3524923 0.5928743 0.4609360 0.5558844
#>  [85] 0.5192517 0.4955954 0.4721415 0.4955402 0.4912587 0.3395811 0.3339047
#>  [92] 0.3529030 0.4548613 0.4500262 0.3925793 0.4286735 0.3669383 0.3559288
#>  [99] 0.3149580 0.2813694 0.2962821 0.4357552 0.3843856 0.3739884 0.3169359
#> [106] 0.3719227 0.3538892 0.2954441 0.5325772 0.4583351 0.4314309 0.4569518
#> [113] 0.4220307 0.4523262 0.2376438 0.2510679 0.3858982 0.4132749 0.4774996
#> [120] 0.4781288 0.3799251 0.4255387 0.5559670 0.5457080 0.5477428 0.5033831
#> [127] 0.5202887 0.5208435 0.4466178 0.3972270 0.4107058 0.4917141 0.5518716
#> [134] 0.5400227 0.5411964 0.5311865 0.3438091 0.3461399 0.3368345 0.4369723
#> [141] 0.3854957 0.2974555 0.3417847 0.4158778 0.4450713 0.4724419 0.4659388
#> [148] 0.4534487 0.3903126 0.3655987 0.4232477 0.4503079 0.3946738 0.3599505
#> [155] 0.3741880 0.2264123 0.2013972 0.2810391 0.3417856 0.4091802 0.4552121
#> [162] 0.4451257 0.4514789 0.5143618 0.5654407 0.5219867 0.4690047 0.5392481
#> [169] 0.5574709 0.5525959 0.3883455 0.3637578 0.4885368 0.4647612 0.4568771
#> [176] 0.3569326 0.3452613 0.3098810 0.4089357 0.5096234 0.4925196 0.4354827
#> [183] 0.4689312 0.3698299 0.4742022 0.4854588 0.4582321 0.3965318 0.4604360
#> [190] 0.4796899 0.4373051 0.4594559 0.4575967 0.4632717 0.4630648 0.3218085
#> [197] 0.2141000 0.1522802 0.1311100 0.2879120 0.3223648 0.3151990 0.4510678
#> [204] 0.3760240 0.3385183 0.3803843 0.3858561 0.3507873 0.3711693 0.4197890
#> [211] 0.4091953 0.3827800 0.2762220 0.2691071 0.2916446 0.3091447 0.3452973
#> [218] 0.3741995 0.3574908 0.4945351 0.4354789 0.3984017 0.4578017 0.4034004
#> [225] 0.4976799 0.5625613 0.5024712 0.5526834 0.4256071 0.4472520 0.5288728
#> [232] 0.4462976 0.4078267 0.4411329 0.3509985 0.3728820 0.5112026 0.4616056
#> [239] 0.5797616 0.5134886 0.5453210 0.4317671 0.3457851 0.3036256 0.2553108
#> [246] 0.5005197 0.5079971 0.3786455 0.4487987 0.3763745 0.2581414 0.2072946
#> [253] 0.3073798 0.3405420 0.3284567 0.4233798 0.4570467 0.4956201 0.7178485
#> [260] 0.6950215 0.5532526 0.5749718 0.5688403 0.6071270 0.5074866 0.6402056
#> [267] 0.4233206 0.3441671 0.3360115 0.3783774 0.3601275 0.3830792 0.3920067
#> [274] 0.4011998 0.5515331 0.5898669 0.5381853 0.4000409 0.3406012 0.4460886
#> [281] 0.4882264 0.4752355 0.5484067 0.5650603 0.6138690 0.5567181 0.4383042
#> [288] 0.3653899 0.5495079 0.5484023 0.4197885 0.4312673 0.4401713 0.4850159
#> [295] 0.5281749 0.4262507 0.3805700 0.3482375 0.4191804 0.3811894 0.5674730
#> [302] 0.5707395 0.3459102 0.3443768 0.2947583 0.3084105 0.3274779 0.4458457
#> [309] 0.3634760 0.2968198 0.3248050 0.3444463 0.3533075 0.4893126 0.5581912
#> [316] 0.5596694 0.6773941 0.5772839 0.4318718 0.2838237 0.3003069 0.3337030
#> [323] 0.3795722 0.4017277 0.4943359 0.6063416 0.5892528 0.4703197 0.5871420
#> [330] 0.5693585 0.6341975 0.5763494 0.4965451 0.4032141 0.3909298 0.3225137
#> [337] 0.3915424 0.4984280 0.4553282 0.4569474 0.4354447 0.3819083 0.3811547
#> [344] 0.3288930 0.2436196 0.3763075 0.5023800 0.5023620 0.4864751 0.3022282
#> [351] 0.3599864 0.4014161 0.3583905 0.2998160 0.2594513 0.3349212 0.3409815
#> [358] 0.3325947 0.3706923 0.2641229 0.4303290 0.4267098 0.4323392 0.5863229
#> [365] 0.5660225 0.4658210 0.4674107 0.3687245 0.3505409 0.3274278 0.3792459
#> [372] 0.2461722 0.2215361 0.1967299 0.3246802 0.3281289 0.3274877 0.3732630
#> [379] 0.4037549 0.4215576 0.3032395 0.2381102 0.3410031 0.2985166 0.2620937
#> [386] 0.4099417 0.5406991 0.6112498 0.3869174 0.4086223 0.4148269 0.3851557
#> [393] 0.3743350 0.3892016 0.5151751 0.5969131 0.5451462 0.5032442 0.3847539
#> [400] 0.3388990 0.3398678 0.3728281 0.3734643 0.3830471 0.4611611 0.3928274
#> [407] 0.3752932 0.4338522 0.4680998 0.4443436 0.4215737 0.4516559 0.3570480
#> [414] 0.3296695 0.3010332 0.3412293 0.3395096 0.2943927 0.3135377 0.3179654
#> [421] 0.3431942 0.3474140 0.3322789 0.3212598 0.3246233 0.2164678 0.2110919
#> [428] 0.2712253 0.3055111 0.2751533 0.3128144 0.4502210 0.4868848 0.5359880
#> [435] 0.5841097 0.5869468 0.5169488 0.5232541 0.4850188 0.4457398 0.3815339
#> [442] 0.4432181 0.5124020 0.4712107 0.4708761 0.4492696 0.4810364 0.4709703
#> [449] 0.5404983 0.5479041 0.5139700 0.4913994 0.4131852 0.4980428 0.4769406
#> [456] 0.5269047 0.3404176 0.3236711 0.3246158 0.3304740 0.3140280 0.2968634
#> [463] 0.4769461 0.4536026 0.5100497 0.5089404 0.5595481 0.5118766 0.5770970
#> [470] 0.4889304 0.4550609 0.4463421 0.4558670 0.3616007 0.3662767 0.4561291
#> [477] 0.4226500 0.3632342 0.3360165 0.3440721 0.4518037 0.3726565 0.5177493
#> [484] 0.5830546 0.4714096 0.3587448 0.4211896 0.4715330 0.4797066 0.3650855
#> [491] 0.3448735 0.4413403 0.5159419 0.4591730 0.4637980 0.4757130 0.4061267
#> [498] 0.3368016 0.3597170 0.4516592
```
