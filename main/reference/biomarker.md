# Get the Biomarker Levels for a Given Dual-Endpoint Model, Given Dose Levels and Samples

**\[experimental\]**

## Usage

``` r
biomarker(xLevel, model, samples, ...)

# S4 method for class 'integer,DualEndpoint,Samples'
biomarker(xLevel, model, samples, ...)
```

## Arguments

- xLevel:

  (`integer`)  
  the levels for the doses the patients have been given w.r.t dose grid.
  See
  [`Data`](https://openpharma.github.io/crmPack/reference/Data-class.md)
  for more details.

- model:

  (`DualEndpoint`)  
  the model.

- samples:

  (`Samples`)  
  the samples of model's parameters that store the value of biomarker
  levels for all doses on the dose grid.

- ...:

  not used.

## Value

The biomarker levels.

## Details

This function simply returns a specific columns (with the indices equal
to `xLevel`) of the biomarker samples matrix, which is included in the
the `samples` object.

## Functions

- `biomarker(xLevel = integer, model = DualEndpoint, samples = Samples)`:

## Examples

``` r
# Create the data.
my_data <- DataDual(
  x = c(0.1, 0.5, 1.5, 3, 6, 10, 10, 10, 20, 20, 20, 40, 40, 40, 50, 50, 50),
  y = c(0, 0, 0, 0, 0, 0, 1, 0, 0, 1, 1, 0, 0, 1, 0, 1, 1),
  ID = 1:17,
  cohort = c(
    1L,
    2L,
    3L,
    4L,
    5L,
    6L,
    6L,
    6L,
    7L,
    7L,
    7L,
    8L,
    8L,
    8L,
    9L,
    9L,
    9L
  ),
  w = c(
    0.31,
    0.42,
    0.59,
    0.45,
    0.6,
    0.7,
    0.55,
    0.6,
    0.52,
    0.54,
    0.56,
    0.43,
    0.41,
    0.39,
    0.34,
    0.38,
    0.21
  ),
  doseGrid = c(0.1, 0.5, 1.5, 3, 6, seq(from = 10, to = 80, by = 2))
)

# Initialize the Dual-Endpoint model (in this case RW1).
my_model <- DualEndpointRW(
  mean = c(0, 1),
  cov = matrix(c(1, 0, 0, 1), nrow = 2),
  sigma2betaW = 0.01,
  sigma2W = c(a = 0.1, b = 0.1),
  rho = c(a = 1, b = 1),
  rw1 = TRUE
)

# Set-up some MCMC parameters and generate samples from the posterior.
my_options <- McmcOptions(
  burnin = 100,
  step = 2,
  samples = 500
)
my_samples <- mcmc(my_data, my_model, my_options)

# Obtain the biomarker levels (samples) for the second dose from the dose grid,
# which is 0.5.
biomarker(
  xLevel = 2L,
  model = my_model,
  samples = my_samples
)
#>   [1] 0.33130536 0.37088186 0.41253696 0.42932857 0.38648031 0.37583399
#>   [7] 0.35653483 0.38238954 0.36514656 0.37571831 0.41565796 0.42422863
#>  [13] 0.34806981 0.33674956 0.33320646 0.32991875 0.34247704 0.27869851
#>  [19] 0.27649611 0.24134293 0.32640088 0.35319350 0.40415920 0.47561030
#>  [25] 0.47867256 0.50669540 0.46232868 0.53058997 0.49838708 0.49263218
#>  [31] 0.48701603 0.47741405 0.40447947 0.34182338 0.33426999 0.34855170
#>  [37] 0.25662919 0.36266239 0.34283889 0.49096700 0.43706470 0.41107984
#>  [43] 0.42464722 0.51714895 0.40479138 0.52857908 0.43798746 0.31781762
#>  [49] 0.24083558 0.17461415 0.28142317 0.37977707 0.35985125 0.36195788
#>  [55] 0.37115958 0.38717133 0.37335594 0.43493342 0.49387624 0.40539079
#>  [61] 0.52219897 0.52300089 0.51948656 0.53172385 0.43988544 0.34647114
#>  [67] 0.37309100 0.46984809 0.42306199 0.40931277 0.44568303 0.36895729
#>  [73] 0.30855041 0.24495378 0.31177822 0.23712959 0.33209889 0.43550071
#>  [79] 0.43901422 0.47478131 0.44320233 0.46357464 0.43307282 0.51170040
#>  [85] 0.49018646 0.48028334 0.54634064 0.50976207 0.45267878 0.43346952
#>  [91] 0.41211100 0.50337094 0.47978554 0.56666345 0.57059707 0.48625442
#>  [97] 0.48528773 0.45660986 0.56495068 0.66291031 0.63508057 0.60026051
#> [103] 0.55988280 0.53748273 0.57867382 0.58311106 0.45256182 0.39408686
#> [109] 0.31739809 0.12994301 0.10350208 0.27046075 0.37351639 0.34916915
#> [115] 0.29547844 0.33892578 0.44477692 0.39418975 0.39329807 0.47919321
#> [121] 0.47946278 0.39234756 0.35350011 0.39389065 0.49810997 0.59251396
#> [127] 0.58783585 0.50975538 0.55421685 0.40878458 0.45068341 0.42369114
#> [133] 0.44921869 0.40162697 0.37806803 0.57672638 0.54095099 0.48180019
#> [139] 0.44026678 0.36732498 0.31159002 0.38284185 0.44296423 0.42992295
#> [145] 0.49519303 0.59228575 0.56308615 0.73800071 0.64669336 0.48807566
#> [151] 0.35591462 0.24740764 0.13566536 0.29782998 0.36754077 0.37019306
#> [157] 0.32664141 0.36605559 0.43360815 0.45039506 0.45063770 0.40116282
#> [163] 0.39877399 0.51601362 0.56590362 0.55609891 0.61059884 0.56556468
#> [169] 0.44737376 0.44299150 0.37242467 0.43929273 0.43680893 0.45228944
#> [175] 0.46530902 0.52893484 0.50949805 0.53077292 0.53040314 0.43500142
#> [181] 0.32525835 0.26976822 0.30757212 0.30406231 0.30214684 0.36012195
#> [187] 0.49700351 0.55075768 0.60424829 0.61366673 0.52331016 0.54889363
#> [193] 0.42953009 0.36575825 0.49070024 0.37476906 0.30641122 0.35003115
#> [199] 0.31612062 0.44352890 0.48822006 0.60734116 0.58072677 0.69388381
#> [205] 0.60124938 0.64642715 0.52253608 0.43687842 0.46490296 0.44781770
#> [211] 0.46330168 0.28133248 0.35272923 0.40810655 0.43758331 0.47977447
#> [217] 0.39075763 0.49670880 0.37866749 0.22863816 0.34470408 0.35479338
#> [223] 0.39413377 0.45956689 0.40358628 0.38146559 0.40599143 0.39094820
#> [229] 0.39762228 0.37429997 0.37286412 0.42795862 0.43702079 0.60773123
#> [235] 0.49112542 0.44888992 0.48177277 0.36722602 0.37855608 0.49513629
#> [241] 0.47567498 0.47196202 0.33140179 0.37821081 0.33963739 0.41972953
#> [247] 0.51165066 0.48590664 0.37377474 0.24799295 0.36364747 0.45057146
#> [253] 0.44941845 0.47868098 0.52541197 0.49923028 0.47240075 0.43389528
#> [259] 0.34061320 0.29310669 0.35468628 0.39033235 0.49994617 0.53242804
#> [265] 0.48235748 0.55723067 0.55010538 0.43629631 0.55126593 0.56378937
#> [271] 0.46887582 0.44238594 0.41809952 0.39301691 0.33726213 0.35174255
#> [277] 0.42204486 0.29737050 0.20276184 0.20346302 0.30311028 0.32265993
#> [283] 0.36009446 0.27018011 0.21156691 0.13085623 0.16885292 0.26720620
#> [289] 0.28817935 0.46392111 0.42428343 0.40265990 0.40959622 0.44796346
#> [295] 0.46139857 0.42329864 0.46378840 0.47781802 0.52987681 0.45499853
#> [301] 0.35281330 0.36414880 0.44509303 0.26856335 0.31058300 0.37396125
#> [307] 0.35863446 0.44521848 0.39030457 0.53366218 0.50384072 0.53898682
#> [313] 0.48022908 0.50912640 0.40219255 0.39157609 0.43207955 0.36641564
#> [319] 0.35020508 0.32698862 0.34005375 0.32290296 0.27933372 0.31512229
#> [325] 0.41636579 0.42163778 0.40327673 0.36416633 0.41388622 0.30754316
#> [331] 0.34955589 0.48853973 0.53148285 0.49264913 0.40430807 0.29799631
#> [337] 0.14763451 0.30403792 0.27102713 0.27408542 0.38688367 0.55613881
#> [343] 0.51568131 0.35295225 0.37470421 0.33738158 0.38209593 0.44548881
#> [349] 0.33553899 0.33681878 0.30699122 0.32613478 0.33552002 0.37242091
#> [355] 0.57427990 0.55345130 0.56558937 0.63791246 0.41443801 0.50835583
#> [361] 0.44774474 0.31382558 0.32564339 0.31575945 0.25957639 0.24877053
#> [367] 0.11304966 0.13899445 0.20137119 0.29827345 0.22481915 0.24373982
#> [373] 0.35764232 0.43745436 0.31413542 0.34845238 0.45112800 0.45993436
#> [379] 0.51302960 0.48594104 0.47731239 0.52091839 0.52145277 0.56171426
#> [385] 0.37759404 0.29923461 0.32929665 0.29881747 0.40475221 0.44673172
#> [391] 0.33008085 0.46028541 0.47419383 0.58962089 0.48792492 0.56131383
#> [397] 0.55511043 0.45906523 0.40596384 0.38603338 0.45039820 0.46378301
#> [403] 0.38716364 0.33496397 0.40197401 0.48256490 0.48625473 0.54413434
#> [409] 0.42198016 0.56758957 0.52774870 0.55448425 0.50252354 0.42520062
#> [415] 0.51899600 0.43346109 0.46204914 0.40061833 0.45025456 0.35044057
#> [421] 0.36750401 0.35513516 0.29469778 0.32257101 0.39878108 0.41726380
#> [427] 0.41391338 0.37219962 0.37164107 0.51983649 0.44832431 0.54597088
#> [433] 0.39666846 0.41451121 0.36157697 0.22743560 0.08825483 0.24107379
#> [439] 0.26282589 0.26495286 0.40017520 0.41063920 0.33502025 0.41819114
#> [445] 0.51446304 0.46981286 0.43168850 0.41200923 0.30780083 0.46594310
#> [451] 0.44229257 0.58323491 0.43144519 0.52313263 0.53342408 0.42835570
#> [457] 0.38726629 0.43043299 0.32472275 0.30321764 0.29806785 0.33193661
#> [463] 0.39514038 0.46751541 0.44136824 0.43979030 0.38049498 0.36488557
#> [469] 0.35634500 0.45072894 0.42278634 0.46542865 0.34594970 0.32073168
#> [475] 0.33275497 0.42835421 0.44420297 0.43872320 0.39494722 0.40650880
#> [481] 0.33503981 0.36417639 0.39783741 0.36340468 0.36684850 0.34145214
#> [487] 0.32681278 0.32365060 0.36299042 0.42845011 0.47710013 0.55878647
#> [493] 0.50858302 0.41034273 0.35976800 0.45598031 0.29490109 0.31848254
#> [499] 0.44706940 0.34207294
```
