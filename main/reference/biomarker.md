# Get the Biomarker Levels for a Given Dual-Endpoint Model, Given Dose Levels and Samples

**\[experimental\]**

## Usage

``` r
biomarker(xLevel, model, samples, ...)

# S4 method for class 'integer,DualEndpoint,Samples'
biomarker(xLevel, model, samples, ...)
```

## Arguments

- xLevel:

  (`integer`)  
  the levels for the doses the patients have been given w.r.t dose grid.
  See
  [`Data`](https://openpharma.github.io/crmPack/reference/Data-class.md)
  for more details.

- model:

  (`DualEndpoint`)  
  the model.

- samples:

  (`Samples`)  
  the samples of model's parameters that store the value of biomarker
  levels for all doses on the dose grid.

- ...:

  not used.

## Value

The biomarker levels.

## Details

This function simply returns a specific columns (with the indices equal
to `xLevel`) of the biomarker samples matrix, which is included in the
the `samples` object.

## Functions

- `biomarker(xLevel = integer, model = DualEndpoint, samples = Samples)`:

## Examples

``` r
# Create the data.
my_data <- DataDual(
  x = c(0.1, 0.5, 1.5, 3, 6, 10, 10, 10, 20, 20, 20, 40, 40, 40, 50, 50, 50),
  y = c(0, 0, 0, 0, 0, 0, 1, 0, 0, 1, 1, 0, 0, 1, 0, 1, 1),
  ID = 1:17,
  cohort = c(
    1L,
    2L,
    3L,
    4L,
    5L,
    6L,
    6L,
    6L,
    7L,
    7L,
    7L,
    8L,
    8L,
    8L,
    9L,
    9L,
    9L
  ),
  w = c(
    0.31,
    0.42,
    0.59,
    0.45,
    0.6,
    0.7,
    0.55,
    0.6,
    0.52,
    0.54,
    0.56,
    0.43,
    0.41,
    0.39,
    0.34,
    0.38,
    0.21
  ),
  doseGrid = c(0.1, 0.5, 1.5, 3, 6, seq(from = 10, to = 80, by = 2))
)

# Initialize the Dual-Endpoint model (in this case RW1).
my_model <- DualEndpointRW(
  mean = c(0, 1),
  cov = matrix(c(1, 0, 0, 1), nrow = 2),
  sigma2betaW = 0.01,
  sigma2W = c(a = 0.1, b = 0.1),
  rho = c(a = 1, b = 1),
  rw1 = TRUE
)

# Set-up some MCMC parameters and generate samples from the posterior.
my_options <- McmcOptions(
  burnin = 100,
  step = 2,
  samples = 500
)
my_samples <- mcmc(my_data, my_model, my_options)

# Obtain the biomarker levels (samples) for the second dose from the dose grid,
# which is 0.5.
biomarker(
  xLevel = 2L,
  model = my_model,
  samples = my_samples
)
#>   [1] 0.2056964 0.2585293 0.3726457 0.3392698 0.4786756 0.4322193 0.4733259
#>   [8] 0.4880080 0.6698786 0.4825736 0.4189411 0.3201006 0.3038607 0.2644173
#>  [15] 0.4200364 0.4325265 0.3034550 0.2727577 0.3713644 0.5081865 0.5272001
#>  [22] 0.5194641 0.6059988 0.7710008 0.6744392 0.6434928 0.5339625 0.4322041
#>  [29] 0.3944717 0.4741961 0.2871306 0.3567021 0.2890801 0.2620289 0.1865305
#>  [36] 0.2620560 0.4072841 0.4186737 0.3749994 0.4138994 0.3504756 0.4166010
#>  [43] 0.3970123 0.4967598 0.5854922 0.5757381 0.4169698 0.2964247 0.2595963
#>  [50] 0.1359258 0.2599221 0.3014057 0.3804521 0.7329436 0.7417821 0.5987999
#>  [57] 0.3931715 0.3436466 0.3731211 0.5733516 0.5772829 0.5420489 0.4440425
#>  [64] 0.3929483 0.4368828 0.4390382 0.4070703 0.3379796 0.2664159 0.2710828
#>  [71] 0.3307506 0.3433061 0.4134924 0.4195809 0.4602030 0.4750470 0.4822790
#>  [78] 0.4423093 0.4402009 0.4700814 0.5040052 0.4370984 0.4045462 0.3557197
#>  [85] 0.4309339 0.4485677 0.4217871 0.4387446 0.4795003 0.5581433 0.5712066
#>  [92] 0.5640178 0.5167064 0.4600966 0.5026363 0.4067479 0.3830818 0.3976283
#>  [99] 0.4088486 0.4484008 0.4842594 0.4714585 0.4375016 0.4997530 0.4244593
#> [106] 0.3861186 0.4794458 0.6078508 0.6815727 0.7447537 0.6310103 0.6110347
#> [113] 0.5752183 0.4856775 0.4061238 0.5163463 0.5411891 0.4827463 0.4406085
#> [120] 0.4433171 0.4780868 0.5108158 0.3862050 0.3446824 0.3365988 0.3435317
#> [127] 0.2511187 0.3292022 0.4443874 0.4042115 0.4056322 0.3912277 0.2993380
#> [134] 0.3089434 0.2454853 0.3605049 0.4070505 0.3777483 0.3975316 0.4481045
#> [141] 0.5226474 0.4626480 0.4068506 0.4472055 0.3803203 0.3769137 0.3362380
#> [148] 0.3919021 0.4352627 0.5236993 0.5606409 0.5141076 0.4895591 0.4390665
#> [155] 0.4495261 0.3625217 0.3911151 0.3515324 0.2592371 0.2936477 0.3209976
#> [162] 0.4216132 0.4229990 0.4834894 0.5020962 0.6136162 0.5552083 0.6019784
#> [169] 0.6433015 0.4033587 0.2798901 0.2832479 0.3743081 0.3712936 0.4204809
#> [176] 0.2972773 0.5762840 0.6499734 0.7322534 0.5325855 0.4290719 0.4276478
#> [183] 0.4472753 0.5321603 0.4575590 0.4075991 0.4626472 0.4418489 0.3841144
#> [190] 0.3864981 0.4778087 0.3881546 0.3623110 0.2631877 0.4125759 0.3710619
#> [197] 0.2939382 0.4571116 0.6218282 0.6730097 0.6617542 0.5123571 0.4809362
#> [204] 0.2607020 0.2302963 0.2475403 0.3037868 0.3188257 0.3290838 0.3469029
#> [211] 0.3853859 0.3370131 0.3453177 0.4342860 0.4387017 0.5287245 0.4835950
#> [218] 0.3681170 0.3697156 0.4054161 0.4438841 0.6034115 0.4809722 0.4831952
#> [225] 0.4112190 0.3918472 0.3762713 0.2955564 0.3825984 0.2991746 0.3624535
#> [232] 0.4243455 0.4424287 0.5224205 0.4766915 0.5594929 0.4278320 0.3762311
#> [239] 0.3992749 0.4007851 0.3722592 0.3358650 0.3298186 0.4625357 0.4148956
#> [246] 0.4465819 0.4602018 0.4318153 0.4065065 0.4789188 0.6132631 0.5173868
#> [253] 0.4495294 0.4988777 0.5160110 0.4363225 0.4761037 0.4731856 0.4250342
#> [260] 0.4423919 0.5073015 0.5407648 0.6185762 0.6813540 0.4852059 0.4290603
#> [267] 0.2616486 0.3597660 0.3272045 0.3162718 0.3261852 0.3669330 0.4324933
#> [274] 0.3316102 0.4424039 0.4962700 0.4300994 0.5520050 0.3680060 0.3050478
#> [281] 0.3208888 0.4516480 0.4399369 0.4373364 0.4287935 0.4499242 0.4081392
#> [288] 0.3700446 0.2613721 0.3229284 0.3835669 0.3582952 0.3464015 0.3477538
#> [295] 0.3915609 0.3712279 0.4143664 0.4247772 0.4130832 0.4467237 0.4773314
#> [302] 0.4298325 0.5350326 0.6252837 0.6085039 0.6745691 0.5443041 0.3477803
#> [309] 0.2939132 0.3675489 0.3536180 0.3694416 0.3809673 0.3945128 0.4009023
#> [316] 0.3064097 0.3869998 0.4284364 0.3995632 0.3941357 0.4056801 0.4588775
#> [323] 0.3525386 0.3898810 0.4182077 0.3764847 0.5157591 0.4205513 0.4272374
#> [330] 0.4080116 0.3869665 0.4629171 0.4371465 0.4357808 0.4030905 0.4339569
#> [337] 0.4761442 0.4899104 0.3992537 0.5049128 0.3604650 0.4140880 0.4352505
#> [344] 0.5314804 0.4252845 0.5498127 0.4761178 0.5172243 0.4295885 0.3536842
#> [351] 0.3979050 0.3630327 0.3736134 0.3101900 0.3417416 0.3686994 0.3547446
#> [358] 0.5314823 0.4590064 0.4927546 0.2930915 0.3477862 0.2375769 0.2925048
#> [365] 0.3511930 0.4597567 0.5998368 0.7265371 0.5847110 0.6324169 0.5833994
#> [372] 0.5309425 0.5402742 0.4516660 0.3559191 0.4316390 0.4535855 0.3933624
#> [379] 0.3515456 0.4053116 0.4313120 0.4780037 0.7412083 0.6956555 0.4627356
#> [386] 0.4515139 0.4473192 0.4434326 0.4072629 0.4533062 0.4518596 0.4295044
#> [393] 0.3983997 0.5341455 0.4524319 0.4418045 0.4279179 0.4509916 0.4066067
#> [400] 0.4219312 0.3950198 0.2975987 0.3035201 0.2464711 0.3273437 0.3487663
#> [407] 0.3423923 0.3940987 0.4395932 0.3171402 0.3652019 0.3710069 0.4597354
#> [414] 0.5010479 0.6208370 0.6649445 0.6753400 0.5223993 0.5113318 0.5209825
#> [421] 0.4466275 0.4298469 0.3654058 0.3971360 0.3675723 0.4057663 0.3722684
#> [428] 0.3464186 0.3978264 0.3818755 0.4727722 0.5701094 0.4959634 0.4533759
#> [435] 0.5339932 0.4746569 0.5309832 0.3888928 0.3405728 0.2552051 0.3257955
#> [442] 0.2830318 0.1918557 0.3131113 0.3292254 0.4060165 0.3656911 0.3224114
#> [449] 0.2927916 0.3938073 0.3820870 0.4828448 0.5252313 0.3950557 0.5900817
#> [456] 0.5023741 0.4069847 0.4989675 0.4301934 0.3825208 0.3170721 0.2570820
#> [463] 0.2471352 0.3827653 0.4238789 0.3748100 0.3750709 0.4046141 0.4142092
#> [470] 0.4018526 0.3391675 0.3979396 0.3898797 0.3521244 0.4151041 0.3112265
#> [477] 0.3242428 0.1547647 0.2590925 0.2793677 0.3895594 0.5088387 0.4974867
#> [484] 0.6136944 0.6681068 0.5877035 0.6035858 0.5854419 0.4936050 0.5218820
#> [491] 0.5117649 0.5038460 0.4870032 0.5238236 0.4736920 0.3967588 0.2091165
#> [498] 0.2799014 0.2339645 0.1338738
```
