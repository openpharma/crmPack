# Get the Biomarker Levels for a Given Dual-Endpoint Model, Given Dose Levels and Samples

**\[experimental\]**

## Usage

``` r
biomarker(xLevel, model, samples, ...)

# S4 method for class 'integer,DualEndpoint,Samples'
biomarker(xLevel, model, samples, ...)
```

## Arguments

- xLevel:

  (`integer`)  
  the levels for the doses the patients have been given w.r.t dose grid.
  See
  [`Data`](https://openpharma.github.io/crmPack/reference/Data-class.md)
  for more details.

- model:

  (`DualEndpoint`)  
  the model.

- samples:

  (`Samples`)  
  the samples of model's parameters that store the value of biomarker
  levels for all doses on the dose grid.

- ...:

  not used.

## Value

The biomarker levels.

## Details

This function simply returns a specific columns (with the indices equal
to `xLevel`) of the biomarker samples matrix, which is included in the
the `samples` object.

## Functions

- `biomarker(xLevel = integer, model = DualEndpoint, samples = Samples)`:

## Examples

``` r
# Create the data.
my_data <- DataDual(
  x = c(0.1, 0.5, 1.5, 3, 6, 10, 10, 10, 20, 20, 20, 40, 40, 40, 50, 50, 50),
  y = c(0, 0, 0, 0, 0, 0, 1, 0, 0, 1, 1, 0, 0, 1, 0, 1, 1),
  ID = 1:17,
  cohort = c(
    1L,
    2L,
    3L,
    4L,
    5L,
    6L,
    6L,
    6L,
    7L,
    7L,
    7L,
    8L,
    8L,
    8L,
    9L,
    9L,
    9L
  ),
  w = c(
    0.31,
    0.42,
    0.59,
    0.45,
    0.6,
    0.7,
    0.55,
    0.6,
    0.52,
    0.54,
    0.56,
    0.43,
    0.41,
    0.39,
    0.34,
    0.38,
    0.21
  ),
  doseGrid = c(0.1, 0.5, 1.5, 3, 6, seq(from = 10, to = 80, by = 2))
)

# Initialize the Dual-Endpoint model (in this case RW1).
my_model <- DualEndpointRW(
  mean = c(0, 1),
  cov = matrix(c(1, 0, 0, 1), nrow = 2),
  sigma2betaW = 0.01,
  sigma2W = c(a = 0.1, b = 0.1),
  rho = c(a = 1, b = 1),
  rw1 = TRUE
)

# Set-up some MCMC parameters and generate samples from the posterior.
my_options <- McmcOptions(
  burnin = 100,
  step = 2,
  samples = 500
)
my_samples <- mcmc(my_data, my_model, my_options)

# Obtain the biomarker levels (samples) for the second dose from the dose grid,
# which is 0.5.
biomarker(
  xLevel = 2L,
  model = my_model,
  samples = my_samples
)
#>   [1] 0.3175498 0.4181712 0.4472726 0.4224757 0.5035676 0.5661711 0.5332741
#>   [8] 0.5371946 0.6268869 0.6253245 0.5792276 0.6056886 0.4102827 0.4327387
#>  [15] 0.4364567 0.4694935 0.4679482 0.4269410 0.3860061 0.3243284 0.2270105
#>  [22] 0.3790702 0.3293523 0.3803245 0.3550985 0.4770481 0.3809765 0.3293630
#>  [29] 0.2883114 0.2818634 0.3189991 0.1797983 0.2772674 0.2864778 0.2804314
#>  [36] 0.4310247 0.4427788 0.4762237 0.5156993 0.5751988 0.4956935 0.5056810
#>  [43] 0.5815003 0.4533181 0.4679328 0.3553396 0.4370329 0.3416894 0.3886000
#>  [50] 0.3833021 0.3213102 0.3815903 0.3346331 0.3179680 0.4022101 0.3499943
#>  [57] 0.2909526 0.3212300 0.2752633 0.3755275 0.4038441 0.3087173 0.3253306
#>  [64] 0.3593311 0.3806714 0.4206235 0.4999139 0.3622413 0.5068519 0.4654618
#>  [71] 0.3994080 0.3973383 0.3693066 0.4246272 0.3133541 0.3372577 0.4596955
#>  [78] 0.5245574 0.5429802 0.5326531 0.4268595 0.4518866 0.4476886 0.4609098
#>  [85] 0.4009912 0.3647230 0.4073133 0.4509396 0.3677713 0.4085242 0.3785130
#>  [92] 0.4435736 0.4837161 0.5218692 0.4018869 0.4688071 0.4912353 0.4203358
#>  [99] 0.3777498 0.3603728 0.3482117 0.2985624 0.3243590 0.3533074 0.3215925
#> [106] 0.2764476 0.4044461 0.4278630 0.4945910 0.4456864 0.4545073 0.3864602
#> [113] 0.4502606 0.3780217 0.4152071 0.4698098 0.4791226 0.3733091 0.4878238
#> [120] 0.4658394 0.5537815 0.4188689 0.4102227 0.5446257 0.6976742 0.5667208
#> [127] 0.6203253 0.6354561 0.7127384 0.6437270 0.5507947 0.5278064 0.6072952
#> [134] 0.5264481 0.6013638 0.5710795 0.5334609 0.4984169 0.5062407 0.4511509
#> [141] 0.3278784 0.3878815 0.5040832 0.5651210 0.5569533 0.5624030 0.3869449
#> [148] 0.3097551 0.4151795 0.4481815 0.4381713 0.4145935 0.3940582 0.3965144
#> [155] 0.4301681 0.4348879 0.3723789 0.3105046 0.3215496 0.3566779 0.3177180
#> [162] 0.2999648 0.2841219 0.2597720 0.3208300 0.3046964 0.3317505 0.3496021
#> [169] 0.3739172 0.4068958 0.3544116 0.3811388 0.3866259 0.3247545 0.3750307
#> [176] 0.2860940 0.4322042 0.5094794 0.3906477 0.3434808 0.3825842 0.4229757
#> [183] 0.4165675 0.4251385 0.3787885 0.3926712 0.3015210 0.2651971 0.2887959
#> [190] 0.3300934 0.3558446 0.4658683 0.4061565 0.2338037 0.2001261 0.3981323
#> [197] 0.4638421 0.4352124 0.4179354 0.3952035 0.3569692 0.4017369 0.3066745
#> [204] 0.3767434 0.4250123 0.4994745 0.5008076 0.6167590 0.5881381 0.4729695
#> [211] 0.5866049 0.6004586 0.5283847 0.4539595 0.3650537 0.4036072 0.6127950
#> [218] 0.5916555 0.5437522 0.6066575 0.4467465 0.3026779 0.3140732 0.3616002
#> [225] 0.3025832 0.3071995 0.4712642 0.5156087 0.4014345 0.3098027 0.4045887
#> [232] 0.2951931 0.3166432 0.2255245 0.3251979 0.3710522 0.3211634 0.3916772
#> [239] 0.3426559 0.3537089 0.4688114 0.5578834 0.4193632 0.3706989 0.3947175
#> [246] 0.3515891 0.4194294 0.4116243 0.3888133 0.3519769 0.4702856 0.4885461
#> [253] 0.4442850 0.3925604 0.3279783 0.3507904 0.3830089 0.3903393 0.4143620
#> [260] 0.4022152 0.4157703 0.4268920 0.3781082 0.3721128 0.3617928 0.3415989
#> [267] 0.2516367 0.2766666 0.3868137 0.3706079 0.3286136 0.2966473 0.3094641
#> [274] 0.3520273 0.4051633 0.5273727 0.3917145 0.5236066 0.6105576 0.6235900
#> [281] 0.5261110 0.4637086 0.3844691 0.3473066 0.3144227 0.2199509 0.2333414
#> [288] 0.2648739 0.3257922 0.2740801 0.4663862 0.4464537 0.4691840 0.4988656
#> [295] 0.4824970 0.5314067 0.4297728 0.3306039 0.1991899 0.3622381 0.4344216
#> [302] 0.3813849 0.4477599 0.4853215 0.4734775 0.4060846 0.4078038 0.4091995
#> [309] 0.4196019 0.4165532 0.4060088 0.3709922 0.3407710 0.2768719 0.3366155
#> [316] 0.4658726 0.4877056 0.3371388 0.3231378 0.3316918 0.3365739 0.4250467
#> [323] 0.4835862 0.3482541 0.3901782 0.4478297 0.5747531 0.5831039 0.5362172
#> [330] 0.6327919 0.5353009 0.5663060 0.4558901 0.4683052 0.4864594 0.4314818
#> [337] 0.3961920 0.4158460 0.4768615 0.3823793 0.3973200 0.3845212 0.4038860
#> [344] 0.3921994 0.4671703 0.3028325 0.3309290 0.4069986 0.5163348 0.5219495
#> [351] 0.5132395 0.5246126 0.4307779 0.5144462 0.6335424 0.5635771 0.4688530
#> [358] 0.3652249 0.3680217 0.3483432 0.4469869 0.3547494 0.4425450 0.5284508
#> [365] 0.4347720 0.5449990 0.5661838 0.5308425 0.4131333 0.4097683 0.5245082
#> [372] 0.4884197 0.4951166 0.5691535 0.4784530 0.4418479 0.4601305 0.5151166
#> [379] 0.3781687 0.4145580 0.3527434 0.3233951 0.3380878 0.2495979 0.3413313
#> [386] 0.3821930 0.4338640 0.4313652 0.4830163 0.4767807 0.3870247 0.3966628
#> [393] 0.3904131 0.4310856 0.4395794 0.4687492 0.4444830 0.4509736 0.4678793
#> [400] 0.4182607 0.4191555 0.5106044 0.5019397 0.5668788 0.4898047 0.3266015
#> [407] 0.2439887 0.2081577 0.2480096 0.3030404 0.3749246 0.4198701 0.4278603
#> [414] 0.4756874 0.4217607 0.4307139 0.4274726 0.4236061 0.4794851 0.4861954
#> [421] 0.4269025 0.5544854 0.4532479 0.4227708 0.3488408 0.4879812 0.4266024
#> [428] 0.4935458 0.3796250 0.3180358 0.4035215 0.3268421 0.3931431 0.5094246
#> [435] 0.5136575 0.4650932 0.4746138 0.5264081 0.4361628 0.4134067 0.2844277
#> [442] 0.2092769 0.2747779 0.1824296 0.3303720 0.3732529 0.4158179 0.4527355
#> [449] 0.5195660 0.5099811 0.5176173 0.3902634 0.3077746 0.1358255 0.3401268
#> [456] 0.3706743 0.4409590 0.4560684 0.4272422 0.4033285 0.3493144 0.3630724
#> [463] 0.3757493 0.3835884 0.4851081 0.4401284 0.4660367 0.4365573 0.4103746
#> [470] 0.4545598 0.4273716 0.5271237 0.6095499 0.4529546 0.4365740 0.4741980
#> [477] 0.5737592 0.6036756 0.5335696 0.4476346 0.3790423 0.3306599 0.2559077
#> [484] 0.1672458 0.3320541 0.4537453 0.5098195 0.5021296 0.3966253 0.5334379
#> [491] 0.4672123 0.4187021 0.4100512 0.3650177 0.3031543 0.2416214 0.1771103
#> [498] 0.4331055 0.3247060 0.4171483
```
