# Get the Biomarker Levels for a Given Dual-Endpoint Model, Given Dose Levels and Samples

**\[experimental\]**

## Usage

``` r
biomarker(xLevel, model, samples, ...)

# S4 method for class 'integer,DualEndpoint,Samples'
biomarker(xLevel, model, samples, ...)
```

## Arguments

- xLevel:

  (`integer`)  
  the levels for the doses the patients have been given w.r.t dose grid.
  See
  [`Data`](https://openpharma.github.io/crmPack/reference/Data-class.md)
  for more details.

- model:

  (`DualEndpoint`)  
  the model.

- samples:

  (`Samples`)  
  the samples of model's parameters that store the value of biomarker
  levels for all doses on the dose grid.

- ...:

  not used.

## Value

The biomarker levels.

## Details

This function simply returns a specific columns (with the indices equal
to `xLevel`) of the biomarker samples matrix, which is included in the
the `samples` object.

## Functions

- `biomarker(xLevel = integer, model = DualEndpoint, samples = Samples)`:

## Examples

``` r
# Create the data.
my_data <- DataDual(
  x = c(0.1, 0.5, 1.5, 3, 6, 10, 10, 10, 20, 20, 20, 40, 40, 40, 50, 50, 50),
  y = c(0, 0, 0, 0, 0, 0, 1, 0, 0, 1, 1, 0, 0, 1, 0, 1, 1),
  ID = 1:17,
  cohort = c(
    1L,
    2L,
    3L,
    4L,
    5L,
    6L,
    6L,
    6L,
    7L,
    7L,
    7L,
    8L,
    8L,
    8L,
    9L,
    9L,
    9L
  ),
  w = c(
    0.31,
    0.42,
    0.59,
    0.45,
    0.6,
    0.7,
    0.55,
    0.6,
    0.52,
    0.54,
    0.56,
    0.43,
    0.41,
    0.39,
    0.34,
    0.38,
    0.21
  ),
  doseGrid = c(0.1, 0.5, 1.5, 3, 6, seq(from = 10, to = 80, by = 2))
)

# Initialize the Dual-Endpoint model (in this case RW1).
my_model <- DualEndpointRW(
  mean = c(0, 1),
  cov = matrix(c(1, 0, 0, 1), nrow = 2),
  sigma2betaW = 0.01,
  sigma2W = c(a = 0.1, b = 0.1),
  rho = c(a = 1, b = 1),
  rw1 = TRUE
)

# Set-up some MCMC parameters and generate samples from the posterior.
my_options <- McmcOptions(
  burnin = 100,
  step = 2,
  samples = 500
)
my_samples <- mcmc(my_data, my_model, my_options)

# Obtain the biomarker levels (samples) for the second dose from the dose grid,
# which is 0.5.
biomarker(
  xLevel = 2L,
  model = my_model,
  samples = my_samples
)
#>   [1] 0.4376989 0.5106827 0.5824856 0.5355094 0.5543862 0.5213624 0.5290405
#>   [8] 0.4736536 0.4069638 0.4568190 0.4090593 0.3808334 0.3755182 0.3637987
#>  [15] 0.5552158 0.5780739 0.4750878 0.3992752 0.4221287 0.4542577 0.4522105
#>  [22] 0.3965731 0.4035064 0.4051792 0.3958143 0.2989886 0.2316681 0.2781234
#>  [29] 0.3250316 0.2694403 0.4610554 0.4006618 0.4598495 0.4377497 0.5164025
#>  [36] 0.3927298 0.5042270 0.3919757 0.4156935 0.4973749 0.3913598 0.3326307
#>  [43] 0.4580682 0.4890629 0.5308072 0.5477429 0.4628087 0.5229629 0.4497160
#>  [50] 0.4690653 0.5055480 0.4568135 0.4453672 0.3818815 0.2812376 0.2874577
#>  [57] 0.3911409 0.3199909 0.3716880 0.4076635 0.3946123 0.4054077 0.3276099
#>  [64] 0.3778014 0.5432532 0.4978465 0.5054447 0.4824209 0.3758021 0.4967784
#>  [71] 0.4448569 0.3066854 0.3752291 0.4600299 0.4389557 0.3683385 0.4624023
#>  [78] 0.5060060 0.6862788 0.6874962 0.4632018 0.4993858 0.4592020 0.3522611
#>  [85] 0.4141959 0.4665610 0.5250947 0.4993013 0.4187704 0.3296688 0.3185128
#>  [92] 0.3558622 0.3980117 0.4610737 0.4709466 0.5123494 0.4126055 0.4446714
#>  [99] 0.4182338 0.3612064 0.4017145 0.5159785 0.3993888 0.3243119 0.4445311
#> [106] 0.4363198 0.3669797 0.3589205 0.4091106 0.3764008 0.4831456 0.5422045
#> [113] 0.4314637 0.3444751 0.3771939 0.3599516 0.4189396 0.4898251 0.4486605
#> [120] 0.4355091 0.4716540 0.3904879 0.3974081 0.4444282 0.3425977 0.3757151
#> [127] 0.4597738 0.4660175 0.5859982 0.6508910 0.6773597 0.6127861 0.4721003
#> [134] 0.3598851 0.3641368 0.3950086 0.3898979 0.4919646 0.5302690 0.5712815
#> [141] 0.4292082 0.5488286 0.5443801 0.5009219 0.4936617 0.5363098 0.3888728
#> [148] 0.3205254 0.3730726 0.4322195 0.4683992 0.5307661 0.5158405 0.4471060
#> [155] 0.3567826 0.3547059 0.4421080 0.4291205 0.4373897 0.3855337 0.2664702
#> [162] 0.3712908 0.3261531 0.4237395 0.5160479 0.6069046 0.5618672 0.5053220
#> [169] 0.5131598 0.4940188 0.4822539 0.5129475 0.4644713 0.5354406 0.4697484
#> [176] 0.4454795 0.3991681 0.4826367 0.4024015 0.3995593 0.4322774 0.3851116
#> [183] 0.4445547 0.4074747 0.4638689 0.4921081 0.3916674 0.2805203 0.3248403
#> [190] 0.2588305 0.2547417 0.3292750 0.4416729 0.3777015 0.3855033 0.4017977
#> [197] 0.4646654 0.4937620 0.5983683 0.4914085 0.5105957 0.5160258 0.4392151
#> [204] 0.2998816 0.3088452 0.3046173 0.2929750 0.3352838 0.4076477 0.3091026
#> [211] 0.4174472 0.4101518 0.3993304 0.4521267 0.4995368 0.4322220 0.4796585
#> [218] 0.5006833 0.5287626 0.4841446 0.5162228 0.5199929 0.4671531 0.4919175
#> [225] 0.4005164 0.4714369 0.4338438 0.3848415 0.3706170 0.4259971 0.3782280
#> [232] 0.3500341 0.3402640 0.3613609 0.3541597 0.4091944 0.4745822 0.5522096
#> [239] 0.5105012 0.5749946 0.6143465 0.5831355 0.4599330 0.4718564 0.3415956
#> [246] 0.3975572 0.3589356 0.3099402 0.3511871 0.3743423 0.4098498 0.3621004
#> [253] 0.2637084 0.3863383 0.3543057 0.3004156 0.3719962 0.3987878 0.4146729
#> [260] 0.5126312 0.3936597 0.3897039 0.3345978 0.4580563 0.4348690 0.4699890
#> [267] 0.4959641 0.5149248 0.3890666 0.3880693 0.4528837 0.4768400 0.5082415
#> [274] 0.5510278 0.4910341 0.4862311 0.5132064 0.5387481 0.5317127 0.4236569
#> [281] 0.4831357 0.5065441 0.5106237 0.4673553 0.4277840 0.4099584 0.3777795
#> [288] 0.3883939 0.3054115 0.3424844 0.3399379 0.2860785 0.4060665 0.4446703
#> [295] 0.4267941 0.3820535 0.4557910 0.5714811 0.6795674 0.6494954 0.5428204
#> [302] 0.5327566 0.5113267 0.4125935 0.4723640 0.4564496 0.3820843 0.3341062
#> [309] 0.2911829 0.3311894 0.4115509 0.4160214 0.4427943 0.3847420 0.4290007
#> [316] 0.4215104 0.4307919 0.3864137 0.3563672 0.4095200 0.5251074 0.4643843
#> [323] 0.5107856 0.5202099 0.6058173 0.5024397 0.5864378 0.4581247 0.4820035
#> [330] 0.3746108 0.4080703 0.4987138 0.5212386 0.3531064 0.3654970 0.3322349
#> [337] 0.4604011 0.4926816 0.5040655 0.5498654 0.5982523 0.5865130 0.4836525
#> [344] 0.4035962 0.5004243 0.4750044 0.4607893 0.4478604 0.5084200 0.4181064
#> [351] 0.4478652 0.4028686 0.5405323 0.5669108 0.5550245 0.4673620 0.4551640
#> [358] 0.4245769 0.3702019 0.3866360 0.4747204 0.4953454 0.4829486 0.5467323
#> [365] 0.4468167 0.3825347 0.3339176 0.4836088 0.5398436 0.5707370 0.5598428
#> [372] 0.4878096 0.5077392 0.4310315 0.4231159 0.4772270 0.5183533 0.5784542
#> [379] 0.4829989 0.4758610 0.4502374 0.4252994 0.5534946 0.5160700 0.4624127
#> [386] 0.4057038 0.4022573 0.3867172 0.4198897 0.4399313 0.3668697 0.3368878
#> [393] 0.3306014 0.4042096 0.3209596 0.3214609 0.4425308 0.4204400 0.3968900
#> [400] 0.3154775 0.2886267 0.3942913 0.4418378 0.4761153 0.4303978 0.3416890
#> [407] 0.4027734 0.4035453 0.4158930 0.5226994 0.3605574 0.4005515 0.5046879
#> [414] 0.4226168 0.3904821 0.4578324 0.4784578 0.4063098 0.4299567 0.3985303
#> [421] 0.4161640 0.3631429 0.4531114 0.4641926 0.3521914 0.3450576 0.4752119
#> [428] 0.4672158 0.4021650 0.4897360 0.5718531 0.5514503 0.5221286 0.4229556
#> [435] 0.4975240 0.4472552 0.5181591 0.3913128 0.3976553 0.4409406 0.3712274
#> [442] 0.4242914 0.3995125 0.3732341 0.3843278 0.4529136 0.4247686 0.3492219
#> [449] 0.3103465 0.3142753 0.4093937 0.4616352 0.4389378 0.4487538 0.5000933
#> [456] 0.4524329 0.4452862 0.4301026 0.4613039 0.4812986 0.4287157 0.4250672
#> [463] 0.4674912 0.4166728 0.3674233 0.2677743 0.3258606 0.4271194 0.4171889
#> [470] 0.4139651 0.4022554 0.4642771 0.4650661 0.5464184 0.4758803 0.4146666
#> [477] 0.4775161 0.2944405 0.2691154 0.2754680 0.2597930 0.3150931 0.3578797
#> [484] 0.2798771 0.2907279 0.3902288 0.3689301 0.4802375 0.4770413 0.5398158
#> [491] 0.6572484 0.6469295 0.5762227 0.4678342 0.4882570 0.4184250 0.3919792
#> [498] 0.4051369 0.4197044 0.4200368
```
