# Get the Biomarker Levels for a Given Dual-Endpoint Model, Given Dose Levels and Samples

**\[experimental\]**

## Usage

``` r
biomarker(xLevel, model, samples, ...)

# S4 method for class 'integer,DualEndpoint,Samples'
biomarker(xLevel, model, samples, ...)
```

## Arguments

- xLevel:

  (`integer`)  
  the levels for the doses the patients have been given w.r.t dose grid.
  See
  [`Data`](https://openpharma.github.io/crmPack/reference/Data-class.md)
  for more details.

- model:

  (`DualEndpoint`)  
  the model.

- samples:

  (`Samples`)  
  the samples of model's parameters that store the value of biomarker
  levels for all doses on the dose grid.

- ...:

  not used.

## Value

The biomarker levels.

## Details

This function simply returns a specific columns (with the indices equal
to `xLevel`) of the biomarker samples matrix, which is included in the
the `samples` object.

## Functions

- `biomarker(xLevel = integer, model = DualEndpoint, samples = Samples)`:

## Examples

``` r
# Create the data.
my_data <- DataDual(
  x = c(0.1, 0.5, 1.5, 3, 6, 10, 10, 10, 20, 20, 20, 40, 40, 40, 50, 50, 50),
  y = c(0, 0, 0, 0, 0, 0, 1, 0, 0, 1, 1, 0, 0, 1, 0, 1, 1),
  ID = 1:17,
  cohort = c(
    1L,
    2L,
    3L,
    4L,
    5L,
    6L,
    6L,
    6L,
    7L,
    7L,
    7L,
    8L,
    8L,
    8L,
    9L,
    9L,
    9L
  ),
  w = c(
    0.31,
    0.42,
    0.59,
    0.45,
    0.6,
    0.7,
    0.55,
    0.6,
    0.52,
    0.54,
    0.56,
    0.43,
    0.41,
    0.39,
    0.34,
    0.38,
    0.21
  ),
  doseGrid = c(0.1, 0.5, 1.5, 3, 6, seq(from = 10, to = 80, by = 2))
)

# Initialize the Dual-Endpoint model (in this case RW1).
my_model <- DualEndpointRW(
  mean = c(0, 1),
  cov = matrix(c(1, 0, 0, 1), nrow = 2),
  sigma2betaW = 0.01,
  sigma2W = c(a = 0.1, b = 0.1),
  rho = c(a = 1, b = 1),
  rw1 = TRUE
)

# Set-up some MCMC parameters and generate samples from the posterior.
my_options <- McmcOptions(
  burnin = 100,
  step = 2,
  samples = 500
)
my_samples <- mcmc(my_data, my_model, my_options)

# Obtain the biomarker levels (samples) for the second dose from the dose grid,
# which is 0.5.
biomarker(
  xLevel = 2L,
  model = my_model,
  samples = my_samples
)
#>   [1] 0.22812563 0.21673305 0.28653446 0.39072126 0.40419829 0.43908765
#>   [7] 0.50513275 0.38961340 0.48582906 0.47699014 0.40682819 0.42387472
#>  [13] 0.48365910 0.43016151 0.41269918 0.36255149 0.37333001 0.37167635
#>  [19] 0.51624702 0.49417308 0.47171825 0.48889982 0.45439452 0.42585346
#>  [25] 0.42216287 0.37196122 0.52005412 0.47422644 0.35661053 0.36654160
#>  [31] 0.40895805 0.35329066 0.40412092 0.36893160 0.33580269 0.43302922
#>  [37] 0.45128683 0.43147374 0.41856747 0.33025685 0.35368906 0.30205198
#>  [43] 0.28956305 0.29444097 0.28993601 0.28436319 0.30700518 0.29494023
#>  [49] 0.29560224 0.23315052 0.36947958 0.42407349 0.41810132 0.38598754
#>  [55] 0.44225807 0.36441837 0.36917248 0.31819872 0.29429191 0.31457382
#>  [61] 0.34370273 0.34190226 0.36451764 0.41044605 0.42485446 0.42183408
#>  [67] 0.43662359 0.40582682 0.47189113 0.32504526 0.24684305 0.36139225
#>  [73] 0.28498250 0.35338434 0.32266554 0.33446049 0.35404126 0.37460922
#>  [79] 0.34695997 0.30531814 0.38066570 0.47086173 0.42060968 0.46153897
#>  [85] 0.40671276 0.38371945 0.31766269 0.40222410 0.34920082 0.42478144
#>  [91] 0.50128704 0.40481496 0.38133990 0.40218792 0.38631333 0.38605818
#>  [97] 0.30944187 0.19928576 0.16951245 0.27307311 0.41482946 0.31261305
#> [103] 0.28932183 0.36085194 0.34986774 0.44041678 0.49007756 0.41963481
#> [109] 0.45289310 0.44062086 0.36158651 0.43041363 0.40920336 0.46708261
#> [115] 0.46148241 0.55446187 0.43280721 0.34066001 0.40395975 0.43235604
#> [121] 0.38785865 0.50510774 0.46824009 0.45630543 0.39872471 0.34112460
#> [127] 0.27327481 0.20194918 0.25253019 0.30741171 0.35723633 0.37264725
#> [133] 0.37207437 0.56847081 0.46262006 0.53175720 0.49190134 0.45391665
#> [139] 0.54024298 0.42696824 0.42416746 0.26590681 0.42071866 0.58506706
#> [145] 0.66007770 0.75212000 0.63157041 0.62340517 0.58693814 0.54579336
#> [151] 0.46077663 0.49004516 0.47262030 0.46465406 0.45038902 0.42799692
#> [157] 0.45009447 0.32163029 0.34085854 0.29097655 0.27989125 0.24217332
#> [163] 0.32478936 0.37999428 0.37303298 0.43563131 0.38143998 0.44476776
#> [169] 0.46666144 0.54394426 0.50495476 0.48021838 0.43898270 0.48785156
#> [175] 0.42979586 0.43347258 0.26662444 0.30028111 0.33958884 0.41807129
#> [181] 0.41241601 0.48435399 0.53986016 0.51192502 0.44721159 0.48971832
#> [187] 0.44864458 0.41837312 0.44525562 0.43113129 0.49807553 0.48143037
#> [193] 0.41574709 0.54439639 0.52693867 0.55693804 0.51622060 0.43379687
#> [199] 0.43945932 0.40019270 0.30715059 0.28729423 0.31258622 0.40724797
#> [205] 0.44003579 0.47679059 0.47017701 0.43719272 0.49305442 0.52229881
#> [211] 0.44710364 0.43170718 0.42145725 0.37895545 0.40195317 0.41713061
#> [217] 0.39656371 0.46990647 0.49509069 0.48429005 0.42513485 0.51263620
#> [223] 0.54178990 0.52707766 0.53679702 0.50137521 0.61159644 0.68073089
#> [229] 0.57999829 0.42671191 0.40601992 0.33296711 0.28803069 0.37285752
#> [235] 0.52529588 0.45113930 0.42403366 0.46329616 0.47231411 0.49054391
#> [241] 0.54909087 0.60598683 0.58416278 0.52108051 0.44821398 0.58944845
#> [247] 0.57172645 0.64657937 0.66846201 0.56020960 0.58551672 0.58690942
#> [253] 0.65418349 0.38551237 0.33382344 0.25763583 0.26099385 0.30240036
#> [259] 0.27789847 0.27431461 0.14120164 0.09738046 0.21469687 0.25393352
#> [265] 0.33734488 0.38110715 0.41003719 0.46631237 0.41449146 0.41964310
#> [271] 0.49058319 0.51876421 0.54145286 0.47412753 0.42243762 0.43478283
#> [277] 0.45979314 0.42780457 0.44701032 0.27528363 0.33037985 0.39287547
#> [283] 0.41955527 0.34682414 0.32031110 0.33394063 0.31436869 0.36176546
#> [289] 0.37022709 0.28554294 0.34683280 0.39811500 0.42464415 0.40918226
#> [295] 0.40782986 0.38856138 0.39248044 0.43131429 0.34712934 0.37346356
#> [301] 0.23900511 0.23126583 0.16741673 0.28435309 0.41034063 0.61818103
#> [307] 0.53488838 0.64889555 0.51842821 0.52012210 0.38439655 0.50061497
#> [313] 0.55408169 0.55221107 0.48603565 0.38892270 0.53908869 0.52431748
#> [319] 0.49685982 0.41111385 0.43541682 0.39847801 0.42385313 0.49080625
#> [325] 0.48441487 0.51950398 0.56162325 0.54223736 0.46986171 0.49669813
#> [331] 0.51589440 0.46343230 0.44462825 0.36752939 0.46578057 0.46433049
#> [337] 0.40590857 0.41895225 0.39064143 0.44989572 0.38986947 0.19590320
#> [343] 0.18388264 0.15749439 0.13558877 0.06652630 0.19588163 0.31005935
#> [349] 0.31800341 0.47933856 0.30191280 0.27991189 0.29076508 0.32142053
#> [355] 0.22807454 0.20576744 0.28239802 0.23025829 0.28105130 0.32735703
#> [361] 0.36583899 0.31626492 0.25950834 0.32187618 0.30004674 0.35898314
#> [367] 0.36801268 0.46681750 0.52985526 0.49199878 0.62649339 0.48003721
#> [373] 0.52473192 0.54278559 0.48262922 0.36876091 0.43140131 0.44738462
#> [379] 0.44758684 0.45702668 0.43240833 0.42609222 0.36149634 0.34488063
#> [385] 0.35402469 0.45272325 0.48757662 0.45198631 0.51479581 0.46202205
#> [391] 0.38139049 0.38855151 0.50645333 0.31932560 0.32115489 0.25468035
#> [397] 0.22088106 0.26094327 0.51685212 0.47478135 0.41421276 0.46618270
#> [403] 0.38219248 0.55705266 0.57565668 0.62714696 0.59064321 0.53242919
#> [409] 0.51066368 0.44878031 0.39776450 0.30642284 0.27953053 0.33803583
#> [415] 0.30367549 0.25449492 0.33954127 0.38174886 0.35764123 0.36683235
#> [421] 0.37362798 0.38449668 0.35697935 0.40193381 0.44107023 0.55672531
#> [427] 0.56308248 0.43022792 0.38784945 0.29375677 0.34374319 0.37321750
#> [433] 0.42445878 0.43003211 0.44669638 0.46056707 0.49740106 0.59856734
#> [439] 0.51390015 0.67879314 0.58658435 0.41998311 0.39620811 0.26233782
#> [445] 0.23134796 0.10113962 0.21918605 0.36763229 0.38633590 0.35542343
#> [451] 0.37054943 0.20277862 0.31229335 0.26816406 0.37586981 0.42851862
#> [457] 0.39878146 0.36747021 0.49504920 0.50501033 0.43101628 0.39053118
#> [463] 0.39123447 0.37567743 0.34733305 0.41723754 0.28369352 0.28267409
#> [469] 0.37948925 0.48471203 0.48244536 0.46799481 0.44561120 0.53299960
#> [475] 0.52271101 0.69639474 0.59109342 0.46283092 0.35685882 0.43427472
#> [481] 0.59297386 0.45976982 0.50760022 0.39090542 0.33737005 0.34657970
#> [487] 0.32379274 0.40418406 0.35845048 0.37166001 0.47661821 0.50870448
#> [493] 0.54459595 0.53305601 0.57217578 0.47940775 0.60019202 0.57496001
#> [499] 0.57712568 0.59845000
```
