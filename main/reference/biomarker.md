# Get the Biomarker Levels for a Given Dual-Endpoint Model, Given Dose Levels and Samples

**\[experimental\]**

## Usage

``` r
biomarker(xLevel, model, samples, ...)

# S4 method for class 'integer,DualEndpoint,Samples'
biomarker(xLevel, model, samples, ...)
```

## Arguments

- xLevel:

  (`integer`)  
  the levels for the doses the patients have been given w.r.t dose grid.
  See
  [`Data`](https://openpharma.github.io/crmPack/reference/Data-class.md)
  for more details.

- model:

  (`DualEndpoint`)  
  the model.

- samples:

  (`Samples`)  
  the samples of model's parameters that store the value of biomarker
  levels for all doses on the dose grid.

- ...:

  not used.

## Value

The biomarker levels.

## Details

This function simply returns a specific columns (with the indices equal
to `xLevel`) of the biomarker samples matrix, which is included in the
the `samples` object.

## Functions

- `biomarker(xLevel = integer, model = DualEndpoint, samples = Samples)`:

## Examples

``` r
# Create the data.
my_data <- DataDual(
  x = c(0.1, 0.5, 1.5, 3, 6, 10, 10, 10, 20, 20, 20, 40, 40, 40, 50, 50, 50),
  y = c(0, 0, 0, 0, 0, 0, 1, 0, 0, 1, 1, 0, 0, 1, 0, 1, 1),
  ID = 1:17,
  cohort = c(
    1L,
    2L,
    3L,
    4L,
    5L,
    6L,
    6L,
    6L,
    7L,
    7L,
    7L,
    8L,
    8L,
    8L,
    9L,
    9L,
    9L
  ),
  w = c(
    0.31,
    0.42,
    0.59,
    0.45,
    0.6,
    0.7,
    0.55,
    0.6,
    0.52,
    0.54,
    0.56,
    0.43,
    0.41,
    0.39,
    0.34,
    0.38,
    0.21
  ),
  doseGrid = c(0.1, 0.5, 1.5, 3, 6, seq(from = 10, to = 80, by = 2))
)

# Initialize the Dual-Endpoint model (in this case RW1).
my_model <- DualEndpointRW(
  mean = c(0, 1),
  cov = matrix(c(1, 0, 0, 1), nrow = 2),
  sigma2betaW = 0.01,
  sigma2W = c(a = 0.1, b = 0.1),
  rho = c(a = 1, b = 1),
  rw1 = TRUE
)

# Set-up some MCMC parameters and generate samples from the posterior.
my_options <- McmcOptions(
  burnin = 100,
  step = 2,
  samples = 500
)
my_samples <- mcmc(my_data, my_model, my_options)

# Obtain the biomarker levels (samples) for the second dose from the dose grid,
# which is 0.5.
biomarker(
  xLevel = 2L,
  model = my_model,
  samples = my_samples
)
#>   [1] 0.52025983 0.54840752 0.50426424 0.47062103 0.39279949 0.40495518
#>   [7] 0.42248778 0.37574745 0.41522534 0.34100807 0.31670873 0.36805305
#>  [13] 0.34489360 0.34449222 0.45168422 0.43951864 0.45299210 0.45315589
#>  [19] 0.54522198 0.56828744 0.51596639 0.40572367 0.34635542 0.43373524
#>  [25] 0.47981217 0.45272967 0.48725551 0.45641157 0.38526650 0.34211356
#>  [31] 0.32567564 0.32030311 0.44770572 0.44094955 0.46985745 0.50599824
#>  [37] 0.47857418 0.43132166 0.41635275 0.33027753 0.39543354 0.49591396
#>  [43] 0.49886792 0.42822040 0.41288062 0.46448542 0.49807137 0.56448707
#>  [49] 0.52743886 0.50124575 0.44689601 0.42060323 0.31350501 0.31947095
#>  [55] 0.38734094 0.36056617 0.26395435 0.35040486 0.44283414 0.46929796
#>  [61] 0.46029600 0.47008794 0.49164956 0.47331119 0.49801778 0.31722646
#>  [67] 0.29989894 0.42829358 0.47601674 0.38146915 0.40062917 0.42976338
#>  [73] 0.52718648 0.53019922 0.38056193 0.40339041 0.37350107 0.33306899
#>  [79] 0.37162220 0.33541291 0.26745927 0.18694246 0.31733964 0.34722218
#>  [85] 0.30123299 0.31201813 0.32568337 0.27803887 0.35579169 0.39529207
#>  [91] 0.46100675 0.55033293 0.47853872 0.41941880 0.40194848 0.42942412
#>  [97] 0.37654713 0.37644430 0.40223663 0.49266650 0.47856118 0.53257528
#> [103] 0.45897660 0.44032272 0.40087644 0.37350211 0.38567348 0.28703658
#> [109] 0.24304503 0.27899303 0.26911458 0.42349752 0.39743963 0.40959345
#> [115] 0.36227441 0.41628366 0.41272824 0.42938231 0.43240523 0.54390849
#> [121] 0.55764544 0.45221666 0.43775956 0.54327477 0.59611690 0.54831240
#> [127] 0.66270186 0.48230420 0.35717451 0.37500382 0.53422430 0.58918335
#> [133] 0.61898032 0.56826098 0.45601962 0.55358060 0.47094815 0.45340794
#> [139] 0.44458883 0.44696844 0.41975928 0.39456569 0.46928216 0.43377666
#> [145] 0.33518498 0.36644008 0.31335565 0.24600348 0.30905171 0.40316096
#> [151] 0.27626810 0.45049589 0.43951833 0.35891016 0.34574453 0.40291159
#> [157] 0.47786704 0.34911303 0.31281906 0.32292559 0.25995958 0.25435162
#> [163] 0.36058759 0.36197949 0.39796412 0.29300741 0.43474046 0.50196263
#> [169] 0.60736742 0.56078537 0.49929035 0.35555407 0.31021074 0.35547322
#> [175] 0.37012744 0.48833413 0.47091378 0.51900334 0.46022050 0.46183726
#> [181] 0.49819110 0.50213576 0.51610652 0.38386639 0.45067443 0.49076387
#> [187] 0.38734206 0.35503650 0.26982959 0.27313035 0.17767354 0.21631283
#> [193] 0.24621785 0.24949625 0.26557024 0.28124619 0.24913587 0.18261366
#> [199] 0.27594646 0.37163555 0.39773171 0.34563008 0.27496018 0.37606866
#> [205] 0.38877282 0.48376600 0.56723534 0.62034096 0.63799188 0.61091959
#> [211] 0.51216873 0.41484185 0.44685946 0.56352006 0.60104907 0.55551092
#> [217] 0.49658737 0.43919958 0.34213940 0.35001289 0.31021532 0.25585352
#> [223] 0.34059754 0.30272778 0.33960357 0.35999078 0.49554623 0.50013359
#> [229] 0.47429815 0.52131348 0.58904742 0.55247264 0.44656615 0.50887807
#> [235] 0.44549194 0.46355145 0.39939726 0.42302307 0.35677501 0.34707454
#> [241] 0.28545232 0.34344688 0.36488337 0.34924416 0.33859927 0.28265146
#> [247] 0.35948144 0.40399881 0.48415536 0.53938462 0.42521487 0.31138745
#> [253] 0.33263911 0.34684546 0.39374034 0.42188968 0.27497082 0.44961746
#> [259] 0.47872886 0.36924138 0.46077369 0.45153347 0.48106692 0.57152126
#> [265] 0.57438041 0.55512640 0.56910446 0.44085224 0.36372874 0.39475996
#> [271] 0.45605400 0.40786282 0.28727835 0.39003343 0.34613132 0.40772703
#> [277] 0.33846975 0.38795099 0.43697697 0.42913336 0.35940656 0.16448807
#> [283] 0.20009993 0.04520321 0.10082776 0.29987452 0.29267648 0.36202503
#> [289] 0.39141667 0.36931224 0.28509356 0.39151347 0.48882756 0.53487898
#> [295] 0.44404145 0.58302784 0.56696102 0.62511010 0.61399112 0.57496808
#> [301] 0.51242754 0.48195946 0.45112553 0.40606211 0.44332790 0.37145504
#> [307] 0.39536033 0.41434348 0.30739578 0.28974523 0.37893619 0.35478116
#> [313] 0.41603800 0.37791997 0.53190511 0.63552702 0.51826459 0.32590754
#> [319] 0.42355343 0.44254523 0.44511539 0.48459462 0.45940309 0.46180656
#> [325] 0.42102211 0.47396977 0.54811604 0.53385162 0.55120163 0.58250789
#> [331] 0.40635556 0.31558321 0.31015345 0.40176443 0.38580788 0.35028898
#> [337] 0.25118010 0.19751151 0.26855601 0.34768339 0.41995298 0.47150276
#> [343] 0.40190004 0.35461863 0.32446205 0.47723087 0.46594291 0.43975652
#> [349] 0.38291776 0.42400502 0.50459700 0.53847350 0.52135566 0.45433033
#> [355] 0.44151653 0.44637435 0.28145121 0.32507917 0.34935609 0.47799703
#> [361] 0.50381855 0.47177700 0.40707569 0.38264156 0.55035866 0.60135802
#> [367] 0.53643757 0.49479521 0.48642315 0.50309160 0.53572350 0.62981981
#> [373] 0.59798322 0.48273320 0.40475873 0.32544294 0.37208133 0.36059927
#> [379] 0.33981322 0.46525801 0.52086895 0.48087350 0.36755664 0.40976199
#> [385] 0.40859817 0.36306023 0.40507557 0.39578994 0.38539227 0.42173517
#> [391] 0.44980816 0.40478747 0.41807148 0.56081845 0.47277745 0.57159355
#> [397] 0.66635245 0.57089975 0.54395851 0.51587869 0.41167549 0.40880448
#> [403] 0.41418334 0.41143545 0.34072169 0.41894594 0.43067212 0.54657288
#> [409] 0.55217740 0.53905462 0.59589516 0.58884068 0.62859938 0.68053909
#> [415] 0.59583483 0.52045236 0.39290628 0.43006798 0.35547606 0.27446762
#> [421] 0.34723208 0.37868148 0.38465712 0.48678072 0.55884711 0.43622530
#> [427] 0.36113303 0.38365031 0.46613815 0.46189141 0.47468309 0.44240730
#> [433] 0.44948595 0.34560223 0.37908597 0.35575705 0.28818409 0.26487289
#> [439] 0.27386708 0.31770212 0.31080937 0.32700144 0.43125650 0.41516896
#> [445] 0.32262320 0.23853645 0.29157512 0.42514734 0.44293841 0.45456126
#> [451] 0.57174482 0.49460329 0.52114417 0.50431949 0.60140794 0.56264653
#> [457] 0.59659203 0.56446942 0.53464815 0.47483285 0.65129469 0.59106257
#> [463] 0.44286952 0.38358333 0.49258776 0.44632845 0.39744393 0.50467581
#> [469] 0.46819512 0.31430531 0.47852309 0.46132622 0.43237200 0.35840852
#> [475] 0.41051326 0.44346990 0.39179230 0.48609757 0.37757472 0.42190517
#> [481] 0.53989994 0.55586663 0.59625229 0.58148384 0.63544199 0.63893524
#> [487] 0.55640554 0.64126504 0.69991573 0.50803413 0.47768753 0.59785350
#> [493] 0.62382504 0.67198269 0.68311119 0.46891570 0.34187431 0.35538292
#> [499] 0.31964760 0.34675984
```
