# Get the Biomarker Levels for a Given Dual-Endpoint Model, Given Dose Levels and Samples

**\[experimental\]**

## Usage

``` r
biomarker(xLevel, model, samples, ...)

# S4 method for class 'integer,DualEndpoint,Samples'
biomarker(xLevel, model, samples, ...)
```

## Arguments

- xLevel:

  (`integer`)  
  the levels for the doses the patients have been given w.r.t dose grid.
  See
  [`Data`](https://openpharma.github.io/crmPack/reference/Data-class.md)
  for more details.

- model:

  (`DualEndpoint`)  
  the model.

- samples:

  (`Samples`)  
  the samples of model's parameters that store the value of biomarker
  levels for all doses on the dose grid.

- ...:

  not used.

## Value

The biomarker levels.

## Details

This function simply returns a specific columns (with the indices equal
to `xLevel`) of the biomarker samples matrix, which is included in the
the `samples` object.

## Functions

- `biomarker(xLevel = integer, model = DualEndpoint, samples = Samples)`:

## Examples

``` r
# Create the data.
my_data <- DataDual(
  x = c(0.1, 0.5, 1.5, 3, 6, 10, 10, 10, 20, 20, 20, 40, 40, 40, 50, 50, 50),
  y = c(0, 0, 0, 0, 0, 0, 1, 0, 0, 1, 1, 0, 0, 1, 0, 1, 1),
  ID = 1:17,
  cohort = c(
    1L,
    2L,
    3L,
    4L,
    5L,
    6L,
    6L,
    6L,
    7L,
    7L,
    7L,
    8L,
    8L,
    8L,
    9L,
    9L,
    9L
  ),
  w = c(
    0.31,
    0.42,
    0.59,
    0.45,
    0.6,
    0.7,
    0.55,
    0.6,
    0.52,
    0.54,
    0.56,
    0.43,
    0.41,
    0.39,
    0.34,
    0.38,
    0.21
  ),
  doseGrid = c(0.1, 0.5, 1.5, 3, 6, seq(from = 10, to = 80, by = 2))
)

# Initialize the Dual-Endpoint model (in this case RW1).
my_model <- DualEndpointRW(
  mean = c(0, 1),
  cov = matrix(c(1, 0, 0, 1), nrow = 2),
  sigma2betaW = 0.01,
  sigma2W = c(a = 0.1, b = 0.1),
  rho = c(a = 1, b = 1),
  rw1 = TRUE
)

# Set-up some MCMC parameters and generate samples from the posterior.
my_options <- McmcOptions(
  burnin = 100,
  step = 2,
  samples = 500
)
my_samples <- mcmc(my_data, my_model, my_options)

# Obtain the biomarker levels (samples) for the second dose from the dose grid,
# which is 0.5.
biomarker(
  xLevel = 2L,
  model = my_model,
  samples = my_samples
)
#>   [1] 0.2823294 0.3831981 0.4254371 0.4640321 0.4890129 0.3992853 0.4106978
#>   [8] 0.4302998 0.4930628 0.3947257 0.3703577 0.3240395 0.2789781 0.2719232
#>  [15] 0.3716965 0.3613525 0.3080645 0.3496408 0.3102349 0.3044577 0.3629631
#>  [22] 0.5457118 0.5234263 0.6264529 0.5140123 0.4692960 0.5241057 0.4636543
#>  [29] 0.4965415 0.4934487 0.6091745 0.6399327 0.5007584 0.5184351 0.5059221
#>  [36] 0.4761251 0.5193315 0.5183420 0.5384049 0.4821209 0.4865005 0.4079911
#>  [43] 0.3883669 0.5147865 0.5579656 0.4429432 0.3220829 0.3113412 0.2861985
#>  [50] 0.3066824 0.3079006 0.4162881 0.3819284 0.4115512 0.4682750 0.5079079
#>  [57] 0.4871439 0.5098128 0.4604802 0.4140287 0.4010514 0.4197808 0.4550918
#>  [64] 0.4397338 0.3986418 0.3934504 0.3729203 0.2650671 0.3237498 0.3660462
#>  [71] 0.3847326 0.4237668 0.3196140 0.3382754 0.2517160 0.3097603 0.3816728
#>  [78] 0.3382282 0.3848363 0.4029075 0.3904524 0.4110920 0.3379736 0.3492434
#>  [85] 0.3360375 0.4446071 0.4368521 0.4413576 0.3994855 0.5357404 0.4507340
#>  [92] 0.5246926 0.4607022 0.4729032 0.2994544 0.3567582 0.2603829 0.3370231
#>  [99] 0.2974048 0.4563147 0.4900964 0.2881019 0.2189375 0.2503182 0.2800395
#> [106] 0.2355555 0.2950221 0.3411630 0.4845860 0.4430787 0.5229171 0.5430393
#> [113] 0.5720213 0.5550431 0.6035226 0.5252752 0.5983326 0.4694259 0.4481913
#> [120] 0.4109102 0.4217301 0.5026645 0.5922250 0.5517598 0.5523993 0.4444386
#> [127] 0.4582893 0.3650229 0.3864099 0.3251181 0.3153830 0.2742811 0.2962523
#> [134] 0.2590794 0.2880723 0.2762205 0.3265789 0.3446378 0.3370068 0.3693844
#> [141] 0.3473444 0.4292158 0.3267511 0.3036173 0.3866411 0.3012199 0.3378797
#> [148] 0.3783575 0.3324168 0.3091316 0.4165100 0.5390147 0.3833069 0.4163289
#> [155] 0.4535267 0.3925963 0.3759100 0.4477709 0.3720905 0.3306439 0.3408436
#> [162] 0.3759761 0.4924773 0.3615017 0.3892880 0.4565896 0.5185763 0.4810681
#> [169] 0.5136956 0.3897870 0.4462075 0.4630463 0.4045425 0.5026518 0.5803090
#> [176] 0.6217063 0.5631798 0.4127845 0.3785824 0.4366851 0.5165395 0.4656729
#> [183] 0.4773661 0.4253450 0.3086904 0.2988428 0.3508780 0.4366522 0.3749637
#> [190] 0.3873623 0.4551519 0.4810583 0.5935292 0.5936608 0.5277993 0.4984063
#> [197] 0.3687767 0.4171967 0.3922957 0.3552267 0.3917012 0.3652962 0.4316608
#> [204] 0.5476434 0.5233826 0.5590289 0.5270706 0.3400740 0.3399311 0.3187184
#> [211] 0.3670053 0.3369597 0.3267905 0.3720184 0.4109937 0.3990828 0.3331034
#> [218] 0.3796282 0.3364724 0.3017544 0.3210601 0.3454336 0.3121369 0.3505169
#> [225] 0.4063443 0.4453745 0.4333446 0.3949682 0.2116908 0.1896657 0.1702763
#> [232] 0.1780937 0.1827489 0.2344793 0.3036471 0.3618017 0.3434853 0.3724369
#> [239] 0.4962547 0.4587428 0.4611280 0.3672756 0.3898528 0.3075980 0.3185209
#> [246] 0.3669193 0.4363913 0.4567320 0.3856308 0.5313793 0.5982902 0.5022506
#> [253] 0.4108421 0.3721133 0.3236315 0.2872588 0.3489685 0.3601163 0.2766839
#> [260] 0.2580861 0.3244966 0.4170996 0.4107741 0.4338858 0.4948754 0.5917725
#> [267] 0.5748441 0.6208788 0.5056479 0.4728375 0.4706703 0.4138679 0.4590955
#> [274] 0.4358400 0.4880687 0.4466732 0.4448507 0.4671054 0.3929385 0.3900592
#> [281] 0.3269224 0.3304720 0.3196870 0.2640482 0.3121813 0.3031698 0.3305933
#> [288] 0.5523136 0.5298488 0.5388672 0.4666079 0.4389633 0.5298808 0.4964973
#> [295] 0.4550332 0.4119809 0.4363780 0.4330631 0.4391038 0.4555765 0.4325817
#> [302] 0.5091132 0.4818513 0.4998131 0.4588826 0.4464567 0.5254789 0.4702861
#> [309] 0.4219694 0.3604235 0.3723422 0.4331467 0.4135808 0.3644412 0.3247860
#> [316] 0.3690969 0.4589605 0.4776702 0.4080367 0.4877078 0.4897427 0.4006597
#> [323] 0.3895343 0.4776449 0.5307524 0.4705174 0.5227792 0.5231023 0.4853561
#> [330] 0.4791020 0.4990028 0.5502708 0.5504627 0.6211513 0.3674613 0.4048290
#> [337] 0.4033401 0.5380923 0.4954938 0.4841939 0.4706494 0.4063315 0.3229960
#> [344] 0.3160214 0.3462695 0.3637688 0.3251231 0.3896589 0.4004287 0.3355554
#> [351] 0.4004145 0.3775275 0.3581163 0.3521359 0.4392721 0.4480865 0.4267644
#> [358] 0.3722000 0.5082634 0.4812795 0.4710340 0.4289184 0.4834417 0.4272004
#> [365] 0.4337106 0.4878559 0.3601453 0.3826319 0.4298812 0.2897318 0.3904879
#> [372] 0.3639543 0.4280765 0.3801393 0.4100842 0.4228123 0.4772195 0.4029960
#> [379] 0.3822998 0.6109070 0.5440125 0.5060412 0.4006436 0.3748886 0.4548603
#> [386] 0.4010484 0.3938225 0.4083848 0.3744829 0.3744050 0.4125830 0.3478922
#> [393] 0.4126321 0.5200567 0.5133885 0.5438286 0.4877075 0.4493912 0.5137751
#> [400] 0.5562140 0.6288552 0.5262926 0.4141143 0.4033504 0.4655663 0.4573432
#> [407] 0.4658274 0.4899858 0.4706884 0.4914181 0.4455329 0.5895893 0.5724727
#> [414] 0.5006011 0.4403250 0.4026890 0.3527681 0.3537209 0.3490636 0.2799199
#> [421] 0.4558815 0.4917915 0.4862672 0.5650857 0.5060312 0.4458442 0.4564189
#> [428] 0.3822833 0.4681181 0.4718068 0.2539831 0.3633980 0.3464467 0.6403656
#> [435] 0.5693394 0.4030888 0.3261534 0.4054678 0.4138217 0.4159168 0.3759825
#> [442] 0.4430851 0.3836868 0.3478529 0.4023775 0.3693392 0.3727505 0.2227493
#> [449] 0.3299654 0.2992208 0.1806804 0.3024164 0.3417333 0.3520062 0.3991234
#> [456] 0.4007482 0.3853912 0.6242501 0.6919481 0.6406074 0.5480651 0.6125190
#> [463] 0.5109505 0.5282294 0.5090124 0.4660294 0.3483829 0.3548559 0.3563568
#> [470] 0.3020032 0.2809577 0.2744565 0.3076810 0.3735241 0.4006840 0.4067857
#> [477] 0.3952962 0.3993244 0.4419342 0.4037592 0.4270255 0.2847017 0.2280588
#> [484] 0.4254884 0.4053504 0.5408213 0.5190924 0.5946792 0.5161010 0.4911782
#> [491] 0.4693102 0.4908258 0.4729931 0.5958008 0.5961351 0.4948566 0.6224902
#> [498] 0.5068050 0.5345153 0.4973018
```
