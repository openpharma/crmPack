<!DOCTYPE html>
<!-- Generated by pkgdown + https://github.com/insightsengineering/r-pkgdown-multiversion -->
<html lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Using tidy • crmPack</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Using tidy">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="default" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">crmPack</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">2.0.0.9002</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/trial_definition.html">Trial Definition</a></li>
    <li><a class="dropdown-item" href="../articles/trial_analysis.html">Trial Analysis</a></li>
    <li><a class="dropdown-item" href="../articles/trial_sanity_checks.html">Trial Design: basic sanity checks</a></li>
    <li><a class="dropdown-item" href="../articles/trial_simulation.html">Trial Simulation</a></li>
    <li><a class="dropdown-item" href="../articles/ordinal-crm.html">Ordinal CRM</a></li>
    <li><a class="dropdown-item" href="../articles/rolling-crm.html">Rolling CRM Example</a></li>
    <li><a class="dropdown-item" href="../articles/simulations.html">Simulation study example</a></li>
    <li><a class="dropdown-item" href="../articles/knit_print.html">Describing `crmPack` Objects</a></li>
    <li><a class="dropdown-item" href="../articles/tidy_method.html">Using tidy</a></li>
    <li><a class="dropdown-item" href="../articles/migration_from_the_old_crmPack.html">Migrating from crmPack version 1.0.3</a></li>
    <li><a class="dropdown-item" href="../articles/parallel_computing_with_extensions.html">Parallel computing with extensions</a></li>
    <li><a class="dropdown-item" href="../articles/crmPack-jss-paper.html">Model-based Dose Escalation Designs in R with crmPack (JSS manuscript)</a></li>
    <li><a class="dropdown-item" href="../articles/example.html">crmPack: Object-oriented implementation of CRM designs</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-reports" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Reports</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-reports">
<li><a class="dropdown-item" href="../coverage-report/">Coverage report</a></li>
    <li><a class="dropdown-item" href="../unit-test-report/">Unit test report</a></li>
  </ul>
</li>
      <div><li class="nav-item dropdown">
    <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-versions">Versions</a>
    <div class="dropdown-menu" aria-labelledby="dropdown-versions">
    <a class="dropdown-item" data-toggle="tooltip" title="" href="https://openpharma.github.io/crmPack/main">main</a>
</div>
</li></div>
</ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/openpharma/crmPack" aria-label="View on GitHub"><span class="fa fa-github"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">



<script src="tidy_method_files/kePrint-0.0.1/kePrint.js"></script><link href="tidy_method_files/lightable-0.0.1/lightable.css" rel="stylesheet">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Using tidy</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/openpharma/crmPack/blob/main/vignettes/tidy_method.Rmd" class="external-link"><code>vignettes/tidy_method.Rmd</code></a></small>
      <div class="d-none name"><code>tidy_method.Rmd</code></div>
    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/message.html" class="external-link">suppressPackageStartupMessages</a></span><span class="op">(</span><span class="op">{</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/openpharma/crmPack" class="external-link">crmPack</a></span><span class="op">)</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://yihui.org/knitr/" class="external-link">knitr</a></span><span class="op">)</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="http://haozhu233.github.io/kableExtra/" class="external-link">kableExtra</a></span><span class="op">)</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyr.tidyverse.org" class="external-link">tidyr</a></span><span class="op">)</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://magrittr.tidyverse.org" class="external-link">magrittr</a></span><span class="op">)</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span><span class="op">}</span><span class="op">)</span></span></code></pre></div>
<div class="section level2">
<h2 id="introducing-tidy-methods-to-crmpack">Introducing tidy methods to crmPack<a class="anchor" aria-label="anchor" href="#introducing-tidy-methods-to-crmpack"></a>
</h2>
<p>The latest release of <code>crmPack</code> introduces
<code>broom</code>-like tidy methods for all <code>crmPack</code>
classes. These methods convert the underlying S4 classes to (lists of)
<code>tibble</code>s. This should facilitate reporting of all aspects of
CRM trials as well as making it easier to integrate <code>crmPack</code>
with other packages such as <code>ggplot2</code>.</p>
<div class="section level3">
<h3 id="basic-approach">Basic approach<a class="anchor" aria-label="anchor" href="#basic-approach"></a>
</h3>
<p>The following is the general approach we take to tidying
<code>crmPack</code> classes:</p>
<ul>
<li>All slots that are not functions are converted to
<code>tibble</code>s or a list of <code>tibble</code>s.</li>
<li>If the slot’s value is a <code>list</code>, these rules are applied
to each element of the list in turn.</li>
<li>If the slot’s value is scalar, the slot is converted to a 1x1
<code>tibble</code>. This will ease downstream operations such as
<code>row_bind</code>ing.</li>
<li>If the object being tidied contains multiple slots of (potentially)
different lengths, the result is a list of <code>tibble</code>s. The
list may be nested to multiple levels. (See, for example,
<code>LogisticLogNormal</code>.)</li>
<li>The column names of the tidied <code>tibble</code> correspond to the
slot names of the parent object.
<ul>
<li>Exception: where the slot has name in the plural and contains a
<code>vector</code> or <code>list</code>, the column name will be
singular. See, for example, <code>CohortSizeParts</code> below.</li>
</ul>
</li>
<li>When the value of a slot has not been set, a zero-row
<code>tibble</code> is returned.</li>
<li>When the value of a slot has scalar attributes, these attributes are
added as columns of the <code>tibble</code>, whose name is the name of
the attribute and whose value is the value of the attribute for every
row of the tibble. Vector attributes can be added, by default, as a
nested tibble. The nested tibble is 1 row x n column, with column names
defined by the name of the attribute and values given by the value of
the corresponding attribute.</li>
<li>
<code>tbl_&lt;className&gt;</code> is prepended to the class of the
(list of) tidy <code>tibble</code>(s).</li>
</ul>
</div>
<div class="section level3">
<h3 id="exceptions">Exceptions<a class="anchor" aria-label="anchor" href="#exceptions"></a>
</h3>
<ul>
<li>Where a vector slot (or series of vector slots) define a range ()for
example, the <code>intervals</code> slot in various
<code>CohortSize</code> and <code>Increments</code> classes, then the
naming convention described above is not followed. Instead, columns
named <code>min</code> and <code>max</code> define the extent of the
range.</li>
</ul>
</div>
<div class="section level3">
<h3 id="examples">Examples<a class="anchor" aria-label="anchor" href="#examples"></a>
</h3>
<p><code>CohortSizeConst</code> is a trivial example and illustrates the
default approach for all classes.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/CohortSizeConst-class.html">CohortSizeConst</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">3</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="../reference/tidy.html">tidy</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 1 × 1</span></span></span>
<span><span class="co">#&gt;    size</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;int&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span>     3</span></span></code></pre></div>
<p><code>IncrementsRelative</code> illustrate how ranges are
handled.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/IncrementsRelative-class.html">IncrementsRelative</a></span><span class="op">(</span></span>
<span>  intervals <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">20</span><span class="op">)</span>,</span>
<span>  increments <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">0.33</span><span class="op">)</span></span>
<span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/tidy.html">tidy</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 2 × 3</span></span></span>
<span><span class="co">#&gt;     min   max increment</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span>     0    20      1   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span>    20   <span style="color: #BB0000;">Inf</span>      0.33</span></span></code></pre></div>
<p><code>CohortSizeMax</code> contains a slot whose value is a list.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cs_max</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/maxSize.html">maxSize</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="../reference/CohortSizeConst-class.html">CohortSizeConst</a></span><span class="op">(</span><span class="fl">3</span><span class="op">)</span>,</span>
<span>  <span class="fu"><a href="../reference/CohortSizeDLT-class.html">CohortSizeDLT</a></span><span class="op">(</span>intervals <span class="op">=</span> <span class="fl">0</span><span class="op">:</span><span class="fl">1</span>, cohort_size <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">3</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="va">cs_max</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="../reference/tidy.html">tidy</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; [[1]]</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 1 × 1</span></span></span>
<span><span class="co">#&gt;    size</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;int&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span>     3</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; [[2]]</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 2 × 3</span></span></span>
<span><span class="co">#&gt;     min   max cohort_size</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;int&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span>     0     1           1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span>     1   <span style="color: #BB0000;">Inf</span>           3</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; attr(,"class")</span></span>
<span><span class="co">#&gt; [1] "tbl_CohortSizeMax" "tbl_CohortSizeMax" "list"</span></span></code></pre></div>
<p>The <code>Samples</code> class likely to the most useful when making
presentations not yet supported by <code>crmPack</code> directly.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">options</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/McmcOptions-class.html">McmcOptions</a></span><span class="op">(</span></span>
<span>  burnin <span class="op">=</span> <span class="fl">100</span>,</span>
<span>  step <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  samples <span class="op">=</span> <span class="fl">2000</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">emptydata</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/Data-class.html">Data</a></span><span class="op">(</span>doseGrid <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">3</span>, <span class="fl">5</span>, <span class="fl">10</span>, <span class="fl">15</span>, <span class="fl">20</span>, <span class="fl">25</span>, <span class="fl">40</span>, <span class="fl">50</span>, <span class="fl">80</span>, <span class="fl">100</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">model</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/LogisticLogNormal-class.html">LogisticLogNormal</a></span><span class="op">(</span></span>
<span>  mean <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">0.85</span>, <span class="fl">1</span><span class="op">)</span>,</span>
<span>  cov <span class="op">=</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="op">-</span><span class="fl">0.5</span>, <span class="op">-</span><span class="fl">0.5</span>, <span class="fl">1</span><span class="op">)</span>,</span>
<span>      nrow <span class="op">=</span> <span class="fl">2</span></span>
<span>    <span class="op">)</span>,</span>
<span>  ref_dose <span class="op">=</span> <span class="fl">56</span></span>
<span><span class="op">)</span></span>
<span><span class="va">samples</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/mcmc.html">mcmc</a></span><span class="op">(</span><span class="va">emptydata</span>, <span class="va">model</span>, <span class="va">options</span><span class="op">)</span></span>
<span><span class="va">tidySamples</span> <span class="op">&lt;-</span> <span class="va">samples</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="../reference/tidy.html">tidy</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">tidySamples</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; $data</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 2,000 × 10</span></span></span>
<span><span class="co">#&gt;    Iteration Chain alpha0 alpha1 nChains nParameters nIterations nBurnin nThin</span></span>
<span><span class="co">#&gt;        <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span>         1     1 -<span style="color: #BB0000;">1.32</span>   1.74        1           1        <span style="text-decoration: underline;">2</span>100     100     1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span>         2     1 -<span style="color: #BB0000;">1.59</span>   7.83        1           1        <span style="text-decoration: underline;">2</span>100     100     1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span>         3     1 -<span style="color: #BB0000;">0.809</span>  2.83        1           1        <span style="text-decoration: underline;">2</span>100     100     1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span>         4     1  0.228  2.01        1           1        <span style="text-decoration: underline;">2</span>100     100     1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span>         5     1 -<span style="color: #BB0000;">2.29</span>   7.38        1           1        <span style="text-decoration: underline;">2</span>100     100     1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span>         6     1 -<span style="color: #BB0000;">0.463</span>  2.83        1           1        <span style="text-decoration: underline;">2</span>100     100     1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span>         7     1 -<span style="color: #BB0000;">1.59</span>  30.4         1           1        <span style="text-decoration: underline;">2</span>100     100     1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span>         8     1 -<span style="color: #BB0000;">0.584</span>  0.898       1           1        <span style="text-decoration: underline;">2</span>100     100     1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span>         9     1  0.680  0.820       1           1        <span style="text-decoration: underline;">2</span>100     100     1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span>        10     1 -<span style="color: #BB0000;">3.34</span>  36.3         1           1        <span style="text-decoration: underline;">2</span>100     100     1</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 1,990 more rows</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 1 more variable: parallel &lt;lgl&gt;</span></span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $options</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 1 × 5</span></span></span>
<span><span class="co">#&gt;   iterations burnin  step rng_kind rng_seed</span></span>
<span><span class="co">#&gt;        <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;int&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span>       <span style="text-decoration: underline;">2</span>100    100     1 <span style="color: #BB0000;">NA</span>             <span style="color: #BB0000;">NA</span></span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="using-tidy-crmpack-data">Using tidy <code>crmPack</code> data<a class="anchor" aria-label="anchor" href="#using-tidy-crmpack-data"></a>
</h3>
<p>Tidy <code>crmPack</code> data can be easily reported using
<code>knitr</code> or similar packages in the obvious way.</p>
<div class="section level4">
<h4 id="cohort-size">Cohort size<a class="anchor" aria-label="anchor" href="#cohort-size"></a>
</h4>
<p>The cohort size for this trial is determined by the dose to be used
in the current cohort according to the rules described in the table
below:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/CohortSizeRange-class.html">CohortSizeRange</a></span><span class="op">(</span></span>
<span>  intervals <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">50</span>, <span class="fl">300</span><span class="op">)</span>,</span>
<span>  cohort_size <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">3</span>, <span class="fl">5</span><span class="op">)</span></span>
<span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/tidy.html">tidy</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span></span>
<span>    col.names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Min"</span>, <span class="st">"Max"</span>, <span class="st">"Cohort size"</span><span class="op">)</span>,</span>
<span>    caption <span class="op">=</span> <span class="st">"Rules for selecting the cohort size"</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/kableExtra/man/add_header_above.html" class="external-link">add_header_above</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Dose"</span> <span class="op">=</span> <span class="fl">2</span>, <span class="st">" "</span> <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<caption>
Rules for selecting the cohort size
</caption>
<thead>
<tr>
<th style="border-bottom:hidden;padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; " colspan="2">
<div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
Dose
</div>
</th>
<th style="empty-cells: hide;border-bottom:hidden;" colspan="1">
</th>
</tr>
<tr>
<th style="text-align:right;">
Min
</th>
<th style="text-align:right;">
Max
</th>
<th style="text-align:right;">
Cohort size
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
50
</td>
<td style="text-align:right;">
1
</td>
</tr>
<tr>
<td style="text-align:right;">
50
</td>
<td style="text-align:right;">
300
</td>
<td style="text-align:right;">
3
</td>
</tr>
<tr>
<td style="text-align:right;">
300
</td>
<td style="text-align:right;">
Inf
</td>
<td style="text-align:right;">
5
</td>
</tr>
</tbody>
</table>
<p>Or presentations not directly supported by <code>crmPack</code> can
be easily produced. Here, we create plots of the dose-specific PDFs for
prior probabilities of toxicity after the first DLT is observed in a
fictional trial.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">options</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/McmcOptions-class.html">McmcOptions</a></span><span class="op">(</span></span>
<span>  burnin <span class="op">=</span> <span class="fl">5000</span>,</span>
<span>  step <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  samples <span class="op">=</span> <span class="fl">40000</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">data</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/Data-class.html">Data</a></span><span class="op">(</span></span>
<span>  doseGrid <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">3</span>, <span class="fl">5</span>, <span class="fl">10</span>, <span class="fl">15</span>, <span class="fl">20</span>, <span class="fl">25</span>, <span class="fl">40</span>, <span class="fl">50</span>, <span class="fl">80</span>, <span class="fl">100</span><span class="op">)</span>,</span>
<span>  x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">3</span>, <span class="fl">5</span>, <span class="fl">10</span>, <span class="fl">15</span>, <span class="fl">15</span>, <span class="fl">15</span><span class="op">)</span>,</span>
<span>  y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">0</span><span class="op">)</span>,</span>
<span>  ID <span class="op">=</span> <span class="fl">1L</span><span class="op">:</span><span class="fl">7L</span>,</span>
<span>  cohort <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/integer.html" class="external-link">as.integer</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">4</span>, <span class="fl">5</span>, <span class="fl">5</span>, <span class="fl">5</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">model</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/LogisticLogNormal-class.html">LogisticLogNormal</a></span><span class="op">(</span></span>
<span>  mean <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span>, <span class="fl">0</span><span class="op">)</span>,</span>
<span>  cov <span class="op">=</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span>, <span class="op">-</span><span class="fl">0.1</span>, <span class="op">-</span><span class="fl">0.1</span>, <span class="fl">4</span><span class="op">)</span>,</span>
<span>      nrow <span class="op">=</span> <span class="fl">2</span></span>
<span>    <span class="op">)</span>,</span>
<span>  ref_dose <span class="op">=</span> <span class="fl">56</span></span>
<span><span class="op">)</span></span>
<span><span class="va">samples</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/mcmc.html">mcmc</a></span><span class="op">(</span><span class="va">data</span>, <span class="va">model</span>, <span class="va">options</span><span class="op">)</span></span>
<span><span class="va">tidySamples</span> <span class="op">&lt;-</span> <span class="va">samples</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="../reference/tidy.html">tidy</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># The magrittr pipe is necessary here</span></span>
<span><span class="va">tidySamples</span><span class="op">$</span><span class="va">data</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/expand.html" class="external-link">expand</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://tidyr.tidyverse.org/reference/expand.html" class="external-link">nesting</a></span><span class="op">(</span><span class="op">!</span><span class="op">!</span><span class="op">!</span><span class="va">.</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span><span class="op">]</span><span class="op">)</span>,</span>
<span>    Dose <span class="op">=</span> <span class="va">data</span><span class="op">@</span><span class="va">doseGrid</span><span class="op">[</span><span class="fl">2</span><span class="op">:</span><span class="fl">11</span><span class="op">]</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>Prob <span class="op">=</span> <span class="fu"><a href="../reference/probFunction.html">probFunction</a></span><span class="op">(</span><span class="va">model</span>, alpha0 <span class="op">=</span> <span class="va">alpha0</span>, alpha1 <span class="op">=</span> <span class="va">alpha1</span><span class="op">)</span><span class="op">(</span><span class="va">Dose</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_density.html" class="external-link">geom_density</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Prob</span>, colour <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">as.factor</a></span><span class="op">(</span><span class="va">Dose</span><span class="op">)</span><span class="op">)</span>, adjust <span class="op">=</span> <span class="fl">1.5</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span></span>
<span>    title <span class="op">=</span> <span class="st">"Posterior dose-specific PDFs for p(Tox)"</span>,</span>
<span>    caption <span class="op">=</span> <span class="st">"Dose 1 omitted as p(Tox) is essentially 0"</span>,</span>
<span>    x <span class="op">=</span> <span class="st">"p(Tox)"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_colour_discrete.html" class="external-link">scale_colour_discrete</a></span><span class="op">(</span><span class="st">"Dose"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_light</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span></span>
<span>    axis.ticks.y <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>    axis.text.y <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>    axis.title.y <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<p><img src="tidy_method_files/figure-html/unnamed-chunk-7-1.png" class="r-plt" width="576"></p>
</div>
</div>
</div>
<div class="section level2">
<h2 id="environment">Environment<a class="anchor" aria-label="anchor" href="#environment"></a>
</h2>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/sessionInfo.html" class="external-link">sessionInfo</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; R version 4.5.0 (2025-04-11)</span></span>
<span><span class="co">#&gt; Platform: x86_64-pc-linux-gnu</span></span>
<span><span class="co">#&gt; Running under: Ubuntu 24.04.2 LTS</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Matrix products: default</span></span>
<span><span class="co">#&gt; BLAS:   /usr/lib/x86_64-linux-gnu/openblas-pthread/libblas.so.3 </span></span>
<span><span class="co">#&gt; LAPACK: /usr/lib/x86_64-linux-gnu/openblas-pthread/libopenblasp-r0.3.26.so;  LAPACK version 3.12.0</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; locale:</span></span>
<span><span class="co">#&gt;  [1] LC_CTYPE=en_US.UTF-8       LC_NUMERIC=C              </span></span>
<span><span class="co">#&gt;  [3] LC_TIME=en_US.UTF-8        LC_COLLATE=en_US.UTF-8    </span></span>
<span><span class="co">#&gt;  [5] LC_MONETARY=en_US.UTF-8    LC_MESSAGES=en_US.UTF-8   </span></span>
<span><span class="co">#&gt;  [7] LC_PAPER=en_US.UTF-8       LC_NAME=C                 </span></span>
<span><span class="co">#&gt;  [9] LC_ADDRESS=C               LC_TELEPHONE=C            </span></span>
<span><span class="co">#&gt; [11] LC_MEASUREMENT=en_US.UTF-8 LC_IDENTIFICATION=C       </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; time zone: Etc/UTC</span></span>
<span><span class="co">#&gt; tzcode source: system (glibc)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; attached base packages:</span></span>
<span><span class="co">#&gt; [1] stats     graphics  grDevices utils     datasets  methods   base     </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; other attached packages:</span></span>
<span><span class="co">#&gt; [1] dplyr_1.1.4        magrittr_2.0.4     tidyr_1.3.1        kableExtra_1.4.0  </span></span>
<span><span class="co">#&gt; [5] knitr_1.50         crmPack_2.0.0.9002 ggplot2_4.0.1     </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; loaded via a namespace (and not attached):</span></span>
<span><span class="co">#&gt;  [1] utf8_1.2.6           sass_0.4.10          generics_0.1.4      </span></span>
<span><span class="co">#&gt;  [4] xml2_1.5.0           futile.options_1.0.1 lattice_0.22-7      </span></span>
<span><span class="co">#&gt;  [7] stringi_1.8.7        digest_0.6.39        evaluate_1.0.5      </span></span>
<span><span class="co">#&gt; [10] grid_4.5.0           RColorBrewer_1.1-3   mvtnorm_1.3-3       </span></span>
<span><span class="co">#&gt; [13] fastmap_1.2.0        jsonlite_2.0.0       backports_1.5.0     </span></span>
<span><span class="co">#&gt; [16] formatR_1.14         gridExtra_2.3        purrr_1.2.0         </span></span>
<span><span class="co">#&gt; [19] viridisLite_0.4.2    scales_1.4.0         textshaping_1.0.4   </span></span>
<span><span class="co">#&gt; [22] jquerylib_0.1.4      Rdpack_2.6.4         cli_3.6.5           </span></span>
<span><span class="co">#&gt; [25] rlang_1.1.6          rbibutils_2.4        futile.logger_1.4.3 </span></span>
<span><span class="co">#&gt; [28] parallelly_1.45.1    withr_3.0.2          cachem_1.1.0        </span></span>
<span><span class="co">#&gt; [31] yaml_2.3.10          parallel_4.5.0       tools_4.5.0         </span></span>
<span><span class="co">#&gt; [34] coda_0.19-4.1        checkmate_2.3.3      lambda.r_1.2.4      </span></span>
<span><span class="co">#&gt; [37] vctrs_0.6.5          R6_2.6.1             lifecycle_1.0.4     </span></span>
<span><span class="co">#&gt; [40] stringr_1.6.0        GenSA_1.1.14.1       fs_1.6.6            </span></span>
<span><span class="co">#&gt; [43] htmlwidgets_1.6.4    ragg_1.5.0           rjags_4-17          </span></span>
<span><span class="co">#&gt; [46] pkgconfig_2.0.3      desc_1.4.3           pkgdown_2.2.0       </span></span>
<span><span class="co">#&gt; [49] pillar_1.11.1        bslib_0.9.0          gtable_0.3.6        </span></span>
<span><span class="co">#&gt; [52] glue_1.8.0           systemfonts_1.3.1    xfun_0.54           </span></span>
<span><span class="co">#&gt; [55] tibble_3.3.0         tidyselect_1.2.1     rstudioapi_0.17.1   </span></span>
<span><span class="co">#&gt; [58] dichromat_2.0-0.1    farver_2.1.2         htmltools_0.5.8.1   </span></span>
<span><span class="co">#&gt; [61] labeling_0.4.3       rmarkdown_2.30       svglite_2.2.2       </span></span>
<span><span class="co">#&gt; [64] compiler_4.5.0       S7_0.2.1</span></span></code></pre></div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Daniel Sabanes Bove, Wai Yin Yeung, Burak Kuersad Guenhan, Giuseppe Palermo, Thomas Jaki, Jiawen Zhu, Ziwei Liao, Dimitris Kontos, Marlene Schulte-Goebel, Doug Kelkhoff, Oliver Boix, Robert Adams, Clara Beck, John Kirkpatrick, F. Hoffmann-La Roche AG, Merck Healthcare KGaA, Bayer AG.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer>
</div>





  </body>
</html>
